<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=big5">
   <title>===:::::::::: SCM System ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript"
        src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript"
        src="./js/build/connection/connection-min.js"></script>

<script language="javascript" src="./js/col.js"></script>

<Script language="javascript">

function add_check(id,ap_num,back_str,old_des,sup_id)
{

	var des = window.document.forms['apply_add'].elements['PHP_des'].value;
	var currency = window.document.forms['apply_add'].elements['PHP_CURRENCY'].value;
	var fty = window.document.forms['apply_add'].elements['PHP_FACTORY'].value;
	var dmway = window.document.forms['apply_add'].elements['PHP_dm_way'].value;

	var name = window.document.forms['apply_add'].elements['PHP_ship_name'].value;
	var attn = window.document.forms['apply_add'].elements['PHP_ship_attn'].value;
	var fax  = window.document.forms['apply_add'].elements['PHP_ship_fax'].value;
	var tel  = window.document.forms['apply_add'].elements['PHP_ship_tel'].value;
	var addr = window.document.forms['apply_add'].elements['PHP_ship_addr'].value;

		if ( des == '' ) {
				alert("Please input description");				
				return;				
		} 
		if (currency == ''){
				alert("Please Select Currency");				
				return;				
		}
		if (name == ''){
				alert("Please Select Ship To");				
				return;				
		}

	window.location='index2.php?PHP_action=do_apply_spc_add2&PHP_id='+id+'&PHP_sattn='+attn+'&PHP_sname='+name+'&PHP_sfax='+fax+'&PHP_stel='+tel+'&PHP_saddr='+addr+
									'&PHP_ap_num='+ap_num+"&PHP_CURRENCY="+currency+"&PHP_FACTORY="+fty+"&PHP_des="+des+"&PHP_old_des="+old_des+"&PHP_back="+back_str+"&PHP_dmway="+dmway+"&PHP_sup_id="+sup_id+"&PHP_revise={/literal}{$revise}{literal}"; 	

}
function ship_show(r)
{
		var ship = r.value
		sUrl="index2.php?PHP_action=get_ship_ajax&PHP_ship="+ship;
		transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, shipback, null);
}
</script>
<script>
var shipback = {
	success: function(o) {
		var response = o.responseText.split("|");    	
		window.document.forms['apply_add'].elements['PHP_ship_name'].value = response[0];
		window.document.forms['apply_add'].elements['PHP_ship_attn'].value = response[4];
		window.document.forms['apply_add'].elements['PHP_ship_fax'].value  = response[3];
		window.document.forms['apply_add'].elements['PHP_ship_tel'].value  = response[2];
		window.document.forms['apply_add'].elements['PHP_ship_addr'].value = response[1];
				
	},
	failure: function(o) {
		alert("Error¡GCan't get data");
	}
};
</script>
{/literal}
</head>
<body >
<br>
<form METHOD="POST" name="apply_add" action="{$PHP_SELF}">
<table cellspacing=1 cellpadding=4 cols=1 width=700 bgcolor=#003300>
	<tr>
		<td class="ylw10" align=right width=200 height=28> <b>Extra Purchase </b></td>

		<td class="des" align=center width=500 height=28> P / O &nbsp; # &nbsp;<span class=ylw10><b>{$ap.ap_num}</b></span>  -- for {if $revise} REVISE {elseif $back_str} EDIT {else}Append{/if}</td>
	</tr>	
</table>
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=700 id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>
<hr SIZE=2 WIDTH=690>
<table border=1 cellspacing=0 cellpadding=0 width="700" bgcolor=#FFFFFF>
  <tr>
		<td>
			<table border=0 cellspacing=1 cellpadding=3 width="700" bgcolor=#FFFFFF>
				<tr>
					<td class=snvy width=130 align=right><b>Supplier :</b> </td>
					<td class=frnt width=130 align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.s_name}</b></td>
					<td class=snvy width=80 align=right ><b>Dept :</b> </td>			
					<td class=frnt width=70 align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.dept}</b></td>
					<td class=snvy width=80 align=right ><b>Currency: </b></td>
					<td class=frnt width=80 align=left bgcolor=#E7E6E6>&nbsp;{$CURRENCY_select}</td>
					<td class=snvy width=70 align=right><b>Payment : </b></td>
					<td class=frnt width=60 align=left bgcolor=#E7E6E6>&nbsp;{$dm_way_select}</td>

				</tr>
				<tr>
					<td class=snvy align=right><b>Source area : </b></td>			
					<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.country}</b></td>
					<td class=snvy align=right><b>Ship TO : </b></td>			
					<td class=frnt align=left bgcolor=#E7E6E6>&nbsp;{$FACTORY_select}</td>
					<td class=frnt align=left colspan=4 bgcolor=#E7E6E6>&nbsp;<b>OR</b>&nbsp;&nbsp;<input type=text name="PHP_ship_name" size=50 class=select value="{$ap.ship_name}"></td>
				</tr>
				<tr>
					<td class=snvy align=right><b>Attn. TO : </b></td>			
					<td class=frnt align=left  bgcolor=#E7E6E6><b>&nbsp;<input type=text name="PHP_ship_attn" size=15 class=select value="{$ap.ship_attn}"></b></td>
					<td class=snvy align=right nowrap><b>Rcver TEL: </b></td>
					<td class=frnt align=left  bgcolor=#E7E6E6 colspan=2><b>&nbsp;<input type=text name="PHP_ship_tel" size=24 class=select value="{$ap.ship_tel}"></b></td>
					<td class=snvy align=right ><b>Rcver FAX : </b></td>
					<td class=frnt align=left  bgcolor=#E7E6E6 colspan=2><b>&nbsp;<input type=text name="PHP_ship_fax" size=20 class=select value="{$ap.ship_fax}"></b></td>
				</tr>
				<tr>
					<td class=snvy align=right><b>Rcver Addr: </b></td>
					<td class=frnt align=left  bgcolor=#E7E6E6 colspan=7><b>&nbsp;<input type=text name="PHP_ship_addr" size=108 class=select value="{$ap.ship_addr}"></b></td>
				</tr>
			</table>			
		</td>
  </tr>
</table>
<hr SIZE=2 WIDTH=690>
<table border="1" cellspacing=0 cellpadding=2 width=700 id="table2">	
	<tr bgcolor="#003333" height=28>	
		<td width="100" align="center" class=back><strong>Order #</strong></td>	
		<td width="200" align="center" class=back><strong>Materiel #</strong></td>
		<td width="180" align="center"  class=back><strong>Color / Cat.</strong></td>
		<td width="120" align="center"  class=back><strong>Q'ty</strong></td>
		<td width="100" align="center"  class=back><strong>ETD</strong></td>
	</tr>
	{section name=SEC loop=$ap_det2} 
	<tr onMouseOver="bgColor='#FCF4A4'" onMouseOut="bgColor='#ffffff'">
		<td  align="left" nowrap>{$ap_det2[SEC].ord_num}&nbsp;</td>
		<td  align="left" nowrap>{$ap_det2[SEC].mat_code}&nbsp;</td>
		<td  align="left">{$ap_det2[SEC].color}&nbsp;</td>
		<td  align="right">{$ap_det2[SEC].ap_qty|number_format:"2f"}&nbsp;{$ap_det2[SEC].unit}</td>
		<td  align="center">{if $ap_det2[SEC].eta == '0000-00-00'}&nbsp;{else}{$ap_det2[SEC].eta}{/if} </td>		
	</tr>	
	{/section}
</table>
<hr SIZE=2 WIDTH=690>
<table border=1 cellspacing=0 cellpadding=0 width=690 align=center>
	<tr bgcolor=#bbbbbb height=25>
		<td align=center class=nvy9><b>Reason for Special Purchase</b></td>
	</tr>
	<tr bgcolor=#eeeeee >
		<td class=gry9 align=left><textarea name="PHP_des" rows=2 cols=120 class=select>{if $revise <> 1}{$apply_log.0.des}{/if}</textarea></td>	
	</tr>
</table>
<hr SIZE=2 WIDTH=690>
<table border=0 cellspacing=0 cellpadding=0 cols=2 width=700>
	<tr>
		<td>
		{if $edit_flag && ($apply.status < 1 || $apply.status == 5)}
			<input type="hidden" name="PHP_action" value="do_apply_spc_add2">
			<input type="hidden" name="PHP_id" value="{$ap.id}">
			<input type="hidden" name="PHP_ap_num" value="{$ap.ap_num}">
			<input type="hidden" name="PHP_back_str" value="{$back_str}">
			<input type=button value="[ CFM above Update ]" class=select_e style="cursor:pointer; width=90%" onClick="add_check('{$ap.id}','{$ap.ap_num}','{$back_str}','{$apply_log.0.des}',{$ap.supl_id})";>
		{/if}
		</td>
		<td  width="170" class=frnt align="right">by : {$ap.ap_user}&nbsp;/&nbsp;{$ap.ap_date}</td>

	</tr>			      			
</table> 
</form>
<!--------- footer ---------->
{include file="footer.html"}