<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM -B [ monthy SHIPPING summary ] ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<style type="text/css">
<!--
#Layer1 {
background: #333333;
opacity:0.45;
filter: alpha(opacity=26);
position:absolute;
top:0px;
left:0px; 
height:expression(window.document.body.clientHeight);
Width:expression(window.document.body.clientWidth);
}
-->
</style>
<script language="javascript">

self.onError=null;
currentX = 0;  
currentY = 0;
whichIt = null;           
lastScrollX = 0; lastScrollY = 0;
NS = (document.layers) ? 1 : 0;
IE = (document.all) ? 1: 0;

function heartBeat() {
	if(IE) {
		diffY = 0+document.body.scrollTop; 
		diffX = 0; 
	}
	
	if(NS) { diffY = self.pageYOffset; diffX = self.pageXOffset; }
	
	if(diffY != lastScrollY) {
		percent = (diffY - lastScrollY);
		if(percent > 0) percent = Math.ceil(percent);
		else percent = Math.floor(percent);
		if(IE) document.getElementById("layer1").style.pixelTop += percent;
		if(NS) document.Layer1.top += percent; 
		lastScrollY = lastScrollY + percent;
	}
	
	if(diffX != lastScrollX) {
		percent = (diffX - lastScrollX);
		
		if(percent > 0)
			percent = Math.ceil(percent);
		else
			percent = Math.floor(percent);
			
		if(IE) document.getElementById("layer1").style.pixelLeft += percent;
		if(NS) document.Layer1.top += percent;
		lastScrollY = lastScrollY + percent;
	}
}

if(NS || IE) action = window.setInterval("heartBeat()",1);


function ord_fcst(ord_num) {
	//	alert("order number = "+ord_num);
	var url ="index2.php?PHP_action=order_fcstput&PHP_ord_num="+ord_num;
	var nm = 'order';
	window.open(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=850,height=600 top=50, right=100');
}

function ord_fcst_del(obj) {
	document.getElementById("Layer1").style.display='block';
	window.document.getElementById(obj+'_t').value = 0; 
	window.document.getElementById(obj+'_b').value = 0; 
	//window.document.getElementById(obj+'_p').value = 0; 
	//window.document.getElementById(obj+'_c').value = 0;
}

function tblresize() {
	var dh = 110;
	var dw = 60;
	var hh = tblShow.offsetHeight + dh;
	if ( hh > screen.height - dh )
		hh = screen.height - dh ;
  if (tblShow.offsetWidth) window.resizeTo( tblShow.offsetWidth + dw , hh );
		self.focus();
}

function _display_obj(obj, status){
	if(window.document.getElementById(obj+'_t').readOnly!=status){
		window.document.getElementById(obj+'_t').readOnly=status;
		window.document.getElementById(obj+'_b').readOnly=status;
		window.document.getElementById(obj+'_t_su').readOnly=status;
		window.document.getElementById(obj+'_b_su').readOnly=status;
		//window.document.getElementById(obj+'_p').readOnly=status;
		//window.document.getElementById(obj+'_c').readOnly=status;
		borderB(obj+'_t',status);
		borderB(obj+'_b',status);
		borderB(obj+'_t_su',status);
		borderB(obj+'_b_su',status);
		//borderB(obj+'_p',status);
		//borderB(obj+'_c',status);
		if(status == true){
			document.getElementById(obj).innerHTML	= '';
		}else{
			document.getElementById(obj).innerHTML	= ' <input type="submit" value="[ OK ]" onClick="return disabled_append()"> <input onClick="ord_fcst_del(\''+obj+'\');submit()" type="button" value="[ DEL ]">';
		}
	}
}

function borderB(obj,status){
	if(status == true){
		window.document.getElementById(obj).style.borderTopWidth = 0;
		window.document.getElementById(obj).style.borderBottomWidth = 0;
		window.document.getElementById(obj).style.borderLeftWidth = 0;
		window.document.getElementById(obj).style.borderRightWidth = 0;
	}else{
		window.document.getElementById(obj).style.borderTopWidth = 1;
		window.document.getElementById(obj).style.borderBottomWidth = 2;
		window.document.getElementById(obj).style.borderLeftWidth = 1;
		window.document.getElementById(obj).style.borderRightWidth = 2;
	}
}

function Switch(obj){
	//alert(window.document.myform.elements(obj+'_t').readOnly);
	_display_obj(obj, window.document.getElementById(obj+'_t').readOnly == true ? false : true);
}

function disabled_append(){
	document.getElementById("Layer1").style.display='block';
}

</script>
{/literal}

<body topmargin="10" onLoad="tblresize();" />
<div id="Layer1" style="display : none;" ><table width="100%" height="100%"><tr><td align="center" valign="middle" ><img src="./images/ajpk.gif" border=0 width="66" height="66"></td></tr></table></div>
<table width="520" border="0" cellspacing="0" cellpadding="0" id="tblShow" >
  <tr>
    <td>
			<table width="520" border=1 cellspacing=0 cellpadding=2>
				<tr bbgcolor="#C2C2C1">
					<td colspan=11 align=center class=gry height=35><b>monthy {$sub_title_mk} Pre-Order summary list  {$title_mk} by sales / <font color="red">Unit¡GS.U.</font></b></td>
				</tr>
				<tr bgcolor="#C2C2C1" height=25>
					<td colspan=11 align=center class=gry><b>FACTORY : <span class=sign><b>{$fty}</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEAR : <span class=sign><b>{$year}</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTH : <span class=sign><b>{$mon}</b></span></b></td>
				</tr>
				<tr bgcolor="#0D4368" height=25>
					<td class=w9 align=center bgcolor=#122B3F>DEPT.</td>
					<td class=w9 align=center bgcolor=#122B3F>Customer</td>
					<td class=w9 align=center bgcolor=#122B3F nowrap>Top (pc)</td>
					<td class=w9 align=center bgcolor=#122B3F nowrap>Bottom (pc)</td>
					<td class=w9 align=center bgcolor=#122B3F nowrap>Top (ie)</td>
					<td class=w9 align=center bgcolor=#122B3F nowrap>Bottom (ie)</td>
					<td align=center bgcolor=#122B3F class=w9>Est. S.U.</td>
				</tr>
				{if $fcst.0.cust}
				{section name=SEC loop=$fcst}
				<form method="POST" name="myform" action='index2.php'>
				<input type="hidden" name="PHP_fty" class=select value="{$fty}">
				<input type="hidden" name="PHP_action" class=select value="fcst_mm_edit">
				<input type="hidden" name="PHP_month" class=select value="{$mon}">
				<input type="hidden" name="PHP_year" class=select value="{$year}">
                <input type="hidden" name="PHP_dept" class=select value="{$fcst[SEC].dept}">
				<tr bgcolor="#ffffff">
					<td class=snvy align=center><b>{$fcst[SEC].dept}&nbsp;</b></td>
					{if ( $user_dept == $fcst[SEC].dept || $user_dept == 'SA' ) && $add_flag}
					<td class=snvy align=left><span style="background-color: #FDF7A4; cursor: pointer;" onMouseOver="this.style.backgroundColor='#ff0';" onMouseOut="this.style.backgroundColor='#FDF7A4';" onClick="Switch('{$fcst[SEC].dept}{$fcst[SEC].cust}','{$fcst[SEC].dept}{$fcst[SEC].cust}');tblresize();" ><b>{$fcst[SEC].cust}</b></span></td>
					{else}
					<td class=snvy align=left><b>{$fcst[SEC].cust}</b></td>
					{/if}
					<input type="hidden" name="PHP_cust" class=select value="{$fcst[SEC].cust_id}">
					<td class=b9 align=right><input id="{$fcst[SEC].dept}{$fcst[SEC].cust}_t" name="PHP_top" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$fcst[SEC].t|number_format}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$fcst[SEC].dept}{$fcst[SEC].cust}_b"name="PHP_bot" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$fcst[SEC].b|number_format}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$fcst[SEC].dept}{$fcst[SEC].cust}_t_su" name="PHP_top_su" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$fcst[SEC].t_su}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$fcst[SEC].dept}{$fcst[SEC].cust}_b_su"name="PHP_bot_su" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$fcst[SEC].b_su}" readonly="false" ></td>
					<td class=b9 align=right>{$fcst[SEC].q|number_format}
						<span id="{$fcst[SEC].dept}{$fcst[SEC].cust}" ></span>
					</td>

				</tr>
				</form>
				{/section}
				<tr bgcolor="#eeeeee">
					<td class=snvy align=center colspan=2><b>SUB-Total</b></td>
					<td class=b9 align=right><b>{$t|number_format}</b></td>
					<td class=b9 align=right><b>{$b|number_format}</b></td>
					<td class=b9 align=right><b>{$t_su}</b></td>
					<td class=b9 align=right><b>{$b_su}</b></td>
					<td class=b9 align=right><b>{$q|number_format}</b></td>
				</tr>
				{/if}
				{if $ftyc.0.cust}
				{section name=SEC loop=$ftyc}
				<form method="POST" name="myform" action='index2.php'>
				<input type="hidden" name="PHP_fty" class=select value="{$fty}">
				<input type="hidden" name="PHP_action" class=select value="fcst_mm_edit">
				<input type="hidden" name="PHP_month" class=select value="{$mon}">
				<input type="hidden" name="PHP_year" class=select value="{$year}">
				<input type="hidden" name="PHP_cust" class=select value="{$ftyc[SEC].cust_id}">
				<input type="hidden" name="PHP_dept" class=select value="{$ftyc[SEC].dept}">
				<tr bgcolor="#ffffff">
					<td class=snvy align=center><b>{$ftyc[SEC].dept}&nbsp;</b></td>
					{if $user_dept == $ftyc[SEC].dept || $user_dept == 'SA' && $add_flag}
					<td class=snvy align=left><span style="background-color: #FDF7A4; cursor: pointer;" onMouseOver="this.style.backgroundColor='#ff0';" onMouseOut="this.style.backgroundColor='#FDF7A4';" onClick="Switch('{$ftyc[SEC].dept}{$ftyc[SEC].cust}','{$ftyc[SEC].dept}{$ftyc[SEC].cust}');tblresize();" ><b>{$ftyc[SEC].cust}</b></span></td>
					{else}
					<td class=snvy align=left><b>{$ftyc[SEC].cust}</b></td>
					{/if}
					<td class=b9 align=right><input id="{$ftyc[SEC].dept}{$ftyc[SEC].cust}_t" name="PHP_top" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$ftyc[SEC].t|number_format}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$ftyc[SEC].dept}{$ftyc[SEC].cust}_b"name="PHP_bot" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$ftyc[SEC].b|number_format}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$ftyc[SEC].dept}{$ftyc[SEC].cust}_t_su" name="PHP_top_su" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$ftyc[SEC].t_su|number_format}" readonly="false" ></td>
					<td class=b9 align=right><input id="{$ftyc[SEC].dept}{$ftyc[SEC].cust}_b_su"name="PHP_bot_su" style="width:56;border-top-width: 0pt;border-bottom-width: 0pt;border-left-width: 0pt;border-right-width: 0pt;text-align: right;" value="{$ftyc[SEC].b_su|number_format}" readonly="false" ></td>
					<td class=b9 align=right>{$ftyc[SEC].q|number_format}
						<span id="{$ftyc[SEC].dept}{$ftyc[SEC].cust}" ></span>
					</td>
				</tr>
				</form>
				{/section}
				<tr bgcolor="#eeeeee">
					<td class=snvy align=center colspan=2><b>SUB-Total</b></td>
					<td class=b9 align=right><b>{$ft|number_format}</b></td>
					<td class=b9 align=right><b>{$fb|number_format}</b></td>
					<td class=b9 align=right><b>{$ft_su|number_format}</b></td>
					<td class=b9 align=right><b>{$fb_su|number_format}</b></td>
					<td class=b9 align=right><b>{$fq|number_format}</b></td>
				</tr>
				{/if}  
				{if $tq}
				<tr bgcolor="#D1D1D0">
					<td class=snvy align=center colspan=2><b>Total</b></td>
					<td class=b9 align=right><b>{$tt|number_format}</b></td>
					<td class=b9 align=right><b>{$tb|number_format}</b></td>
					<td class=b9 align=right><b>{$tt_su|number_format}</b></td>
					<td class=b9 align=right><b>{$tb_su|number_format}</b></td>
					<td class=b9 align=right><b>{$tq|number_format}</b></td>
				</tr>
				{/if}
			</table>
			{if $add_flag}
      <table width="100%" border=0 cellspacing=0 cellpadding=0>
        <form method="post" >
				<tr>
					<td height="10">
						<table width="100%" border="0" align="center" cellpadding="3" cellspacing="3" id="log_table_add" style="display:block">
							<tr>
								<td ><input type="button" class="select_e" style="cursor:pointer; width:100%;" onClick="javascript:window.document.getElementById('log_table').style.display='block';tblresize();window.document.getElementById('log_table_add').style.display='none';" value="CREATE Pre-Order [ {$year} / {$mon} ]"></td>
							</tr>
            </table>
					</td>
				</tr>
				<tr>
					<td>
						<table border="1" cellspacing="0" cellpadding="2" id="log_table" style="display:none">
							<tr>
								<td class=w9 align=center bgcolor=#122B3F>DEPT.</td>
								<td class=w9 align=center bgcolor=#122B3F>Customer</td>
								<td class=w9 align=center bgcolor=#122B3F>Top(pc)</td>
								<td class=w9 align=center bgcolor=#122B3F>Bottom(pc)</td>
								<td class=w9 align=center bgcolor=#122B3F>Top(ie)</td>
								<td class=w9 align=center bgcolor=#122B3F>Bottom(ie)</td>
								<td class=w9 align=center bgcolor=#122B3F>&nbsp;</td>
							</tr>
							<tr>
								<td class=snvy align=center>{$dept_select}</td>
								<td class=snvy align=center>{$cust_select}</td>
								<td class=snvy align=center><input type="text" name="PHP_top" style="width:50"></td>
								<td class=snvy align=center><input type="text" name="PHP_bot" style="width:50"></td>
								<td class=snvy align=center><input type="text" name="PHP_top_su" style="width:50"></td>
								<td class=snvy align=center><input type="text" name="PHP_bot_su" style="width:50"></td>
								<td class=snvy align=center><input type="submit" name="Submit" value="Add" onClick="return disabled_append()"></td>
							</tr>
            </table>
					</td>
				</tr>
				<input type="hidden" name="PHP_fty" value="{$fty}">
				<input type="hidden" name="PHP_year" value="{$year}">
				<input type="hidden" name="PHP_month" value="{$mon}">
				<input type="hidden" name="PHP_action" value="mm_forcast_append">
				</form>
			</table>
			{/if}	
		</td>
  </tr>
</table>
<!--------- footer ---------->
{include file="footer.html"}