<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM System ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="./js/jquery.min.js"></script>
<script language="javascript" src="./js/col.js"></script>
<script type="text/javascript" src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript" src="./js/build/connection/connection-min.js"></script>
<script language="javascript" src="./js/date.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<script type="text/javascript" src="./js/jquery.blockUI.js"></script>
<Script language="javascript">

(function($){
	$(document).ready(function(){
	
		del_mat = function (ap_num,ap_id,mat_id,mat_cat,mat_code,r){
		
			if ( confirm("Are you sure to delete Material : [ "+mat_code+" ]??")) {
			
				$.blockUI({ message: '<div><br><h4>Waiting...</h4></div>'});

				$.ajax({
					url: 'index2.php?PHP_action=del_ap_det_ajax',
					type: 'GET',
					data: {
						PHP_id: ap_id ,
						PHP_ap_num: ap_num ,
						PHP_mat_id: mat_id ,
						PHP_mat_code: mat_code 
					},
					error: function(xhr) {
						alert('Ajax request µo¥Í¿ù»~'+xhr);
					},
					success: function(o) {
						var i=r.parentNode.parentNode.rowIndex;
						document.getElementById('mat_table').deleteRow(i);
						document.getElementById("tbl_msg").style.display='block';
						msg1.innerText  = o;
						setTimeout(function(){ $.unblockUI(); }, 600);
					}
				});
			} 
		};

	});
})(jQuery);

function writeToAPAdd(PHP_id,ap_num,bom_id,mat_cat,ap_qty,unit,order_num,mat_id,used_id,color,size){
    //alert(PHP_id+','+ap_num+','+bom_id+','+mat_cat+','+unit+','+order_num+','+used_id+','+color+','+size);
	$.blockUI({ message: '<div><br><h4>Waiting...</h4></div>'});
	window.location='po.php?PHP_action=apply_ex_add&PHP_id='+PHP_id+'&PHP_ap_num='+ap_num+'&PHP_bom_id='+bom_id+"&mat_cat="+mat_cat+"&PHP_qty="+ap_qty+"&PHP_unit="+unit+"&PHP_order_num="+order_num+"&PHP_mat_id="+mat_id+"&PHP_used_id="+used_id+"&PHP_color="+color+"&PHP_size="+size;
}

function search_ord(dept,cust,cat,pa_num,po_num) {
	var url ='po.php?PHP_action=po_ex_add_search&PHP_dept='+dept+'&PHP_cust='+cust+"&PHP_item="+cat+"&PHP_pa_num="+pa_num; 	
	var nm = 'ordsearch';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function list(item,cat){
	var gofile ='index2.php?PHP_action=show_supplier_search&PHP_item='+item+'&PHP_cat='+cat;	
	style=window.open2(gofile,'supplier','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width="800",height=500, top=100, left=150');
}

function add_sup(item,cat){
	var gofile ='index2.php?PHP_action=show_supplier_add&PHP_item='+item+'&PHP_cat='+cat;	
	style=window.open2(gofile,'supplier','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width="800",height=500, top=100, left=150');
}
 
function writeToSupItemlList(vndr_no,supl_s_name,supl_cat,item) {
	var i=0;
	window.document.forms['aply_wi'].elements[item].value = vndr_no;
}

function creat_ap(bom_id,price_name,ven_name,eta_name,qty_name,wi_id,item,back_str,unit,mat_code,color_name,pa_num,mat_id,used_id,size){

	$.blockUI({ message: '<div><br><h4>Waiting...</h4></div>'});

	var vendor = window.document.forms['aply_wi'].elements[ven_name].value;
	var today = GetTodayDate();
	var eta = window.document.forms['aply_wi'].elements[eta_name].value;
	var qty = window.document.forms['aply_wi'].elements[qty_name].value;
	var pa = window.document.forms['aply_wi'].elements['PHP_pa_num'].value;
	var price = window.document.forms['aply_wi'].elements[price_name].value;
	var sup = window.document.forms['aply_wi'].elements['ap_supl'].value;
	var color = window.document.forms['aply_wi'].elements[color_name].value;
	
	var order_num = window.document.forms['aply_wi'].elements['PHP_order_num'].value;

	if (sup != vendor && sup != '') {
		if ( !confirm("Are you sure to change supplier for this Material")) {
			$.unblockUI();
			return;
		} 
	}
 	
	if ( qty <= 0 ) {
		alert("Please Input Qty");
		$.unblockUI();
		return;
	} 	 	
	if (vendor =='' && sup == '') {
		alert("Please Fill Supplier");
		$.unblockUI();
		return;
	} 	
	
	lc='po.php?PHP_action=apply_ex_add&PHP_wi_id='+wi_id+'&PHP_bom_id='+bom_id+"&PHP_vendor="+vendor+"&PHP_eta="+eta+"&PHP_item="+item+"&PHP_unit="+unit+"&PHP_mat_code="+mat_code+'&PHP_qty='+qty+'&PHP_ap_num='+pa_num+"&PHP_price="+price+"&PHP_order_num="+order_num+"&PHP_mat_id="+mat_id+"&PHP_used_id="+used_id+"&PHP_color="+color+"&PHP_size="+size;
	//alert(lc);
	window.location= lc;
}

function creat_ap_ajx(wi_num,price_name,ven_name,eta_name,qty_name,item,back_str,unit,mat_code,color,pa_num,mat_id) {

	var today = GetTodayDate();
	var vendor = window.document.forms['aply_wi'].elements[ven_name].value;
	var eta = window.document.forms['aply_wi'].elements[eta_name].value;
	var qty = window.document.forms['aply_wi'].elements[qty_name].value;
	var pa = window.document.forms['aply_wi'].elements['PHP_pa_num'].value;
	var price = window.document.forms['aply_wi'].elements[price_name].value;
	var sup = window.document.forms['aply_wi'].elements['ap_supl'].value;

	if (sup != vendor && sup != '')
	{
		if ( !confirm("Are you sure to change supplier for this Material")) {
			return;
		}
	}

	if (eta < today)
	{
		alert("ETD must > Today");
		return;
	}

	sUrl='index2.php?PHP_action=apply_special_add_ajax&PHP_wi_num='+wi_num+'&PHP_qty='+qty+"&PHP_vendor="+vendor+"&PHP_eta="+eta+"&PHP_item="+item+"&PHP_unit="+unit+"&PHP_mat_code="+mat_code+"&PHP_color="+color+"&PHP_ap_num="+pa_num+"&PHP_mat_id="+mat_id+"&PHP_sup="+sup+"&PHP_price="+price+"&PHP_revise={/literal}{$revise}{literal}";	
	transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}



function fab_ex_add(wi_num,item){
		window.location='index2.php?PHP_action=apply_ext_add&PHP_wi_num='+wi_num+'&PHP_item='+item+"&PHP_revise={/literal}{$revise}{literal}"; 	
}
function check_add(ap_num,back_str,revise)
{
	var tab = document.getElementById("mat_table");
	var rows = tab.rows.length ;
	if(rows == 2)
	{
		if ( confirm("NO Purchase Item!! \r\r This Purchase will not be continue !\r\rBe sure this is OK for you!")) {
			window.location="po.php?PHP_action=do_apply_del&PHP_ap_num="+ap_num;
		} 	
	}else{
			window.location="index2.php?PHP_action=do_apply_spc_add1&PHP_ap_num="+ap_num+"&PHP_back_str="+back_str+"&PHP_revise="+revise;

	}
}
</script>
<script>
var transaction;
var sUrl;

var addback = {
	success: function(o) {
		document.getElementById("tbl_msg").style.display='block';    
		var response = o.responseText.split("|");   
//		window.document.forms['aply_wi'].elements['PHP_pa_num'].value = response[0];
//		window.document.forms['aply_wi'].elements['PHP_ap_num'].value = response[0];
		msg1.innerText  = response[1]; 
		r=mat_table.insertRow();
		r.insertCell().innerText	= response[2];
		r.insertCell().innerText	= response[3];
		r.insertCell().innerText	= response[4];
		r.insertCell().innerHTML	= "<P align=right>"+response[5]+" "+response[6]+"</P>";
		r.insertCell().innerHTML	= "<P align=right>"+response[7]+"</P>";
		r.insertCell().innerHTML	= "<center>"+response[8]+"</center>";
		r.insertCell().innerHTML	= response[9];
	},
	failure: function(o) {
		alert("Error¡GCan't get data");
	}
};

</script>
{/literal}
</head>

<body>
<form method=POST name=aply_wi>
<input type=hidden name="PHP_order_num"  value="{$wi.wi_num}">
<input type=hidden name='ap_supl'  value='{$ap.sup_code}'>
<br>
<table cellspacing=1 cellpadding=4 cols=2 width="800" bgcolor=#2E5E73>
	<tr>
		<td class="des" align=center height=28 ><b>[ STEP 2. --  NEW <span class=ylw10>Extra Purchase</span> ORDER : <span class=ylw10><b>{if $po_num}{$po_num}{else}POXX-XXXX{/if}</b></span> {if $ap.ap_num} &nbsp;&nbsp; Supplier : <span class=ylw10><b>{$ap.s_name}</b></span>{/if}  ]</b></td>
	</tr>
</table>
<table border=1 cellpadding=4 cellspacing=0 cols=1 width="800" id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>
<table border=0 cellspacing=0 cellpadding=1 width="800" bgcolor=#FFFFFF>
	<tr>
		<td colspan=9 class=frnt align=center><hr size=2 width=98%></td>
	</tr>
	<tr>
		<td class=snvy align=right nowrap width="20%"><b>Customer :</b></td>
		<td class=bgdy align=left nowrap width="13%"><b>&nbsp;{$smpl.cust_iname}</b></td>
		<td class=snvy align=right nowrap width="20%"><b>Department :</b></td>
		<td class=bgdy align=left nowrap width="13%"><b>&nbsp;{$wi.dept}</b></td>
		<td class=snvy align=right nowrap width="20%"><b>ETD :</b></td>
		<td class=bgdy align=left nowrap width="13%"><b>&nbsp;{$wi.etd}</b></td>
	</tr>
	<tr>
		<td colspan=9 class=frnt align=center><hr size=2 width=98%></td>
	</tr>
</table>
<table border cellspacing=0 cellpadding=3 width="800" bgcolor=#ffffff align=center>
	<tr bgcolor="#003333" height=28> 
		<td nowrap align=center class=back><b>Picture</b></td>
		<td nowrap align=center class=back><b>Order #</b></td>
		<td nowrap align=center class=back><b>Style</b></td>
		<td nowrap align=center class=back><b>SIZE RANGE</b></td>
		<td nowrap align=center class=back><b>Q'ty / Unit</b></td>
	</tr>
	<tr bgcolor=#DDDDDD height=28>
		<td class=g10 align=center rowspan=2>&nbsp;
			<img type="image" src="{$wi.pic_url}" name="pic" height=120 border="0" onclick='window.open2("{$wi.pic_url}","","height=640,width=480")' style='cursor:pointer'>
		</td>
		<td class=grn9 align=center>
		<a href="javascript:Show_ord('{$wi.smpl_id}','{$wi.style_code}')" value='ord_out' style='cursor:pointer'>
		<b>&nbsp;{$smpl.order_num}</b></a></td>
		<td class=grn9 align=center><b>&nbsp;{$smpl.style}</b></td>
		<td class=grn9 align=center><b>&nbsp;{$smpl.size_scale}</b></td>
		<td class=grn9 align=center><b><span class=bgdy9><b>{$total|number_format}</b></span>&nbsp;{if $wi.unit}{$wi.unit}{else}<span class=bgdy9><¥¼¿é¤J></span>{/if}</b></td>
	</tr>
	<tr>
		<td colspan=5 >
			<table border cellspacing=0 cellpadding=2 width=98% bgcolor=#ffffff align=center>
				{$show_breakdown}
			</table>
		</td>
	</tr>
</table>
<br>
<!-------------  ½ÐÁÊtable ------------->
<table border="1" cellspacing=0 cellpadding=2 width="800" id="mat_table">	
	<tr bgcolor="#003333" height=28>
		<td colspan=8 class=back align="center"><b>NEW Purchase Detial</b></td>
	</tr>
	<tr bgcolor="#003333" height=28>
		<td width="90" class=back align="center"><b>Order#</b></td>
		<td width="180" class=back align="center"><b>Materiel #</b></td>		
		<td width="170" class=back align="center"><b>Color/Cat.</b></td>
		<td width="120"  class=back align="center"><b>Q'ty</b></td>
		<td width="20"  class=back align="center">&nbsp;</td>
	</tr>

	{section name=SEC loop=$ap_det} 
	<tr onMouseOver="bgColor='#FCF4A4'" onMouseOut="bgColor='#ffffff'">
		<td align="left" nowrap>{$ap_det[SEC].ord_num}&nbsp;</td>
		<td align="left" nowrap>{$ap_det[SEC].mat_code}&nbsp;</td>
		<td align="left">{$ap_det[SEC].color}&nbsp;</td>
		<td align="right">{$ap_det[SEC].ap_qty|number_format:"2f"}&nbsp;{$ap_det[SEC].unit}</td>
		<td align="left">				
			<img src="images/del.png" onClick="del_mat('{$ap.ap_num}','{$ap_det[SEC].id}','{$ap_det[SEC].bom_id}','{$ap_det[SEC].mat_cat}','{$ap_det[SEC].mat_code}',this);" style="cursor:pointer">
		</td>
	</tr>	
	{/section}
</table>

<!-------------  BOM table ------------->
<!-------------  ¥D®Æ bom ------------->
<hr size=2 width="800" align=center>

<input type=hidden name="PHP_pa_num" value="{$pa_num}">
<table width="800" border=1 cellspacing=1 cellpadding=1>
	<tr>
		<td>
			<table width="800" border=1 cellspacing=0 cellpadding=1>
				<!------- ¥D®Æ bom  Title --------- -->
				{if $mat_cate == 'l'}
				<tr bgcolor=#D5D5BE>
					<td class=b9 align=center><b>Fabirc #</b></td>
					<td class=b9 align=center><b>Name</b></td>
					<td class=b9 align=center><b><small>BOM Q'TY</small></b></td>
					<td class=b9 align=center><b><small>Purchased</small></b></td>
					<td class=b9 align=center><b>Color/cat.</b></td>
					<td class=b9 align=center><b>Size</b></td>
					<td class=b9 align=center><b>Supplier</b></td>
					<td class=b9 align=center><b>Q'ty</b></td>
					<td class=b9 align=center><b>Select</b></td>
				</tr>
				<!-------  BOM ¥D®Æ°O¿ý --------- -->
				{section name=BOM loop=$bom_lots_list.bom} 
				{if $bom_lots_list.bom[BOM].ap_mark != ''}
				<tr onmouseover="bgColor='#F9E2BB'" onmouseout="bgColor='#ffffff'">
					<td class=b9 align=left nowrap>&nbsp;<a href="javascript:Show_fab('{$bom_lots_list.bom[BOM].lots_code}')" value='ord_out' style='cursor:pointer'><small>{$bom_lots_list.bom[BOM].lots_code}</small></a></td>
					<td class=b9 align=left nowrap>&nbsp;<small>{$bom_lots_list.bom[BOM].lots_name}</small></td>
					<td class=b7 align=right><small>{$bom_lots_list.bom[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_lots_list.bom[BOM].unit}</small></td>
					<td class=b9 align=right>{if $bom_lots_list.bom[BOM].po.po_fqty > 0}<small>{$bom_lots_list.bom[BOM].po.po_fqty|number_format:"2f"}&nbsp;{$bom_lots_list.bom[BOM].po.unit}</small>{else}&nbsp;{/if}</td>
					<td class=b9 align=left><small>&nbsp;{$bom_lots_list.bom[BOM].color}</small></td>
					<td class=b9 align=left><small>&nbsp;{$bom_lots_list.bom[BOM].size}</small></td>
					<td class=snvy align=right rowspan=2>&nbsp;
						<input type=text name="PHP_lots_v{$bom_lots_list.bom[BOM].id}" size=12 class=select value="{$bom_lots_list.bom[BOM].sup_code}" readonly>&nbsp;
						<img src="./images/icoSearch.gif" alt="Supplier" onClick="list('PHP_lots_v{$bom_lots_list.bom[BOM].id}','FABRIC');" style="cursor:pointer" >
						<img src="./images/add.gif" alt="Supplier ADD" onClick="add_sup('PHP_lots_v{$bom_lots_list.bom[BOM].id}','FABRIC');" style="cursor:pointer">
					</td>
					<input type=hidden name="PHP_lots_eta{$bom_lots_list.bom[BOM].id}"  value="{$bom_lots_list.bom[BOM].eta}">
					<input type=hidden name="PHP_lots_up{$bom_lots_list.bom[BOM].id}"   value="{$bom_lots_list.bom[BOM].price1}">
					<td class=snvy align=center rowspan=2 valign=top><input type=text name="PHP_lots_qty{$bom_lots_list.bom[BOM].id}" size=4 class=select value="" style=text-align:center>&nbsp;</td>
					<td class=snvy align=center rowspan=2 valign=top>
						<input type=button class=select value="ADD" onclick="creat_ap('{$bom_lots_list.bom[BOM].id}','PHP_lots_up{$bom_lots_list.bom[BOM].id}','PHP_lots_v{$bom_lots_list.bom[BOM].id}','PHP_lots_eta{$bom_lots_list.bom[BOM].id}','PHP_lots_qty{$bom_lots_list.bom[BOM].id}','{$wi.id}','lots','{$back_str}','{$bom_lots_list.bom[BOM].unit}','{$bom_lots_list.bom[BOM].lots_code}','PHP_lots_color{$bom_lots_list.bom[BOM].id}','{$pa_num}','{$bom_lots_list.bom[BOM].mat_id}','{$bom_lots_list.bom[BOM].used_id}','{$bom_lots_list.bom[BOM].size}')">&nbsp;				
						<input type=hidden name="PHP_lots_color{$bom_lots_list.bom[BOM].id}" value="{$bom_lots_list.bom[BOM].color}">
					</td>
				</tr>
				<tr onmouseover="bgColor='#F9E2BB'" onmouseout="bgColor='#ffffff'">
					<td colspan=6 class=b7 align=left>&nbsp;{$bom_lots_list.bom[BOM].use_for}</td>
				</tr>
				{/if}
				{/section}
				{/if}
				
				<!------- °Æ®Æ bom  Title --------- -->
				{if $mat_cate == 'a'}
				<tr bgcolor=#D5D5BE>
					<td class=b9 align=center><b>Accessory #</b></td>
					<td class=b9 align=center><b>Name</b></td>
					<td class=b9 align=center><b><small>BOM Q'TY</small></b></td>
					<td class=b9 align=center><b><small>Purchased</small></b></td>
					<td class=b9 align=center><b>Color/cat.</b></td>
					<td class=b9 align=center><b>Size</b></td>
					<td class=b9 align=center><b>Supplier</b></td>
					<td class=b9 align=center><b>Q'ty</b></td>
					<td class=b9 align=center><b>Select</b></td>
				</tr>
				<!-------  end  Title --------- -->

				<!-------  BOM °Æ®Æ°O¿ý --------- -->
				{section name=BOM loop=$bom_acc_list.bom} 
				{if $bom_acc_list.bom[BOM].ap_mark !='' }
				<tr onmouseover="bgColor='#D4E0F7'" onmouseout="bgColor='#ffffff'">
					<td class=b9 align=left nowrap>&nbsp;<a href="javascript:Show_acc('{$bom_acc_list.bom[BOM].acc_code}')" value='ord_out' style='cursor:pointer'><small>{$bom_acc_list.bom[BOM].acc_code}</small></a></td>
					<td class=b9 align=left nowrap>&nbsp;<small>{$bom_acc_list.bom[BOM].acc_name}</small></td>
					<td class=b7 align=right><small>{$bom_acc_list.bom[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_acc_list.bom[BOM].unit}</small></td>
					<td class=b9 align=right>{if $bom_acc_list.bom[BOM].po.po_qty > 0}<small>{$bom_acc_list.bom[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_acc_list.bom[BOM].po.unit}</small>{else}&nbsp;{/if}</td>
					<td class=b9 align=left><small>&nbsp;{$bom_acc_list.bom[BOM].color}</small></td>
					<td class=b9 align=left><small>&nbsp;{$bom_acc_list.bom[BOM].size}</small></td>
					<td class=snvy align=right rowspan=2>&nbsp;
						<input type=text name="PHP_acc_v{$bom_acc_list.bom[BOM].id}" size=12 class=select value="{$bom_acc_list.bom[BOM].sup_code}" readonly>&nbsp;
						<img src="./images/icoSearch.gif" alt="Supplier" onClick="list('PHP_acc_v{$bom_acc_list.bom[BOM].id}','ACCESSORY');" style="cursor:pointer">
						<img src="./images/add.gif" alt="Supplier ADD" onClick="add_sup('PHP_acc_v{$bom_acc_list.bom[BOM].id}','ACCESSORY');" style="cursor:pointer">
					</td>
					<input type=hidden name="PHP_acc_eta{$bom_acc_list.bom[BOM].id}" value="{$bom_acc_list.bom[BOM].eta}" >
					<input type=hidden name="PHP_acc_up{$bom_acc_list.bom[BOM].id}"  value="{$bom_acc_list.bom[BOM].price1}" >
					<td class=snvy align=center rowspan=2 valign=top>
						<input type=text name="PHP_acc_qty{$bom_acc_list.bom[BOM].id}" size=3 class=select value="">&nbsp;
					</td>
					<td class=snvy align=center rowspan=2 valign=top>
						<input type=button class=select value="ADD" onclick="creat_ap('{$bom_acc_list.bom[BOM].id}','PHP_acc_up{$bom_acc_list.bom[BOM].id}','PHP_acc_v{$bom_acc_list.bom[BOM].id}','PHP_acc_eta{$bom_acc_list.bom[BOM].id}','PHP_acc_qty{$bom_acc_list.bom[BOM].id}','{$wi.id}','acc','{$back_str}','{$bom_acc_list.bom[BOM].unit}','{$bom_acc_list.bom[BOM].acc_code}','PHP_acc_color{$bom_acc_list.bom[BOM].id}','{$pa_num}','{$bom_acc_list.bom[BOM].mat_id}','{$bom_acc_list.bom[BOM].used_id}','{$bom_acc_list.bom[BOM].size}')" >&nbsp;
						<input type=hidden name="PHP_acc_color{$bom_acc_list.bom[BOM].id}" value="{$bom_acc_list.bom[BOM].color}">
					</td>
				</tr>
				<tr onmouseover="bgColor='#D4E0F7'" onmouseout="bgColor='#ffffff'">
					<td class=b7 align=left colspan=6><small>&nbsp;{$bom_acc_list.bom[BOM].use_for}</small></td>
				</tr>
				{/if}
				{/section}
				{/if}
			</table>
		</td>
	</tr>
</table>

<table border=0 cellspacing=0 cellpadding=2 width="800" bgcolor=#ffffff align=center>
	<tr>
		<td colspan=3 class=frnt align=center><hr size=2 width=98%></td>
	</tr>
	<tr>
		{if $back_str && $edit_non <> 1}
		<td>
			<input type=button onClick="window.location.href='index2.php?PHP_action=apply_wi_view&PHP_bk={$back_str}&PHP_id={$wi.id}'" value=" << Go Back " class=select_e style="cursor:pointer; width=99%">
		</td>
		{else}
		<td>
			<input type ='button'  value ="ADD another Item (Same Supplier)" class=select_e2 onClick="search_ord('{$wi.dept}','{$wi.cust}','{$mat_cate}','{$pa_num}','{$po_num}');" style="cursor:pointer; width=99%">
		</td>
		
		<td>
		{if $add_flag || $add_flag}
		{if $apply.status < 1 || $apply.status == 5 }<!-- do_apply_spc_add1 -->
 		<input type="hidden" name="PHP_action" value="do_apply_ex_add">
		<input type="hidden" name="PHP_ap_num" value="{$pa_num}">
		<input type="hidden" name="PHP_back_str" value="{$back_str}">
		<input type="hidden" name="PHP_revise" value="{$revise}">
		<input type="button" value=" [ Update Above Records ] " class=select_e style="cursor:pointer; width=99%" onclick=check_add('{$ap.ap_num}','{$back_str}','{$revise}')>
		{/if}
		{/if}
		{/if}
		</td>	
	</tr>
</table>
</form>
{include file="footer.html"}