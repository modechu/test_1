<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=big5">
   <title>===:::::::::: SCM System [ Worksheet for Order ] ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">

</head>
{literal}
<script language="javascript" src="./js/jquery.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<script type="text/javascript" src="./js/pngfix.js"></script>
<script type="text/javascript" src="./js/ajaxfileupload.js"></script>
<script type="text/javascript" src="./js/jquery.blockUI.js"></script>
<script>
function cfm_revise(wi_num,id,status,back_str,back_str2) {
//	var T = '';
//		T = window.document.forms['add'].elements['qty_'+pd_id].value;
	if ( confirm("are you sure to REVISE WorkSheet :#[ "+wi_num+" ] ?\r\rEvery Revise event will cancel entire process had done !\rAnd restart the WorkSheet procedure from beginning Again !\r\rBe sure this is OK for you!")) {
		cgiget="{/literal} {$cgistr_get}{literal}&cgino={/literal}{$start_no}{literal}&cgi_1={/literal}{$cgi.dept}{literal}&cgi_2={/literal}{$cgi.order_num}{literal}&cgi_3={/literal}{$cgi.cust}{literal}&cgi_4={/literal}{$cgi.ref}{literal}&cgi_5={/literal}{$cgi.factory}{literal}";
		location.href="index2.php?PHP_action=revise_ti&PHP_wi="+wi_num+"&PHP_id="+id+"&PHP_rev="+status+"&PHP_back_str2="+back_str2+"&PHP_back_str2="+back_str2;
	} 
}

function Show_ord(id,ord_num) {
	 var url ='index2.php?PHP_action=order_fa_view&PHP_id='+id+'&cgiget=&cgino=&cgi_1=&cgi_2=&cgi_3=&cgi_4=&cgi_5=&cgi_6=&cgi_7=&PHP_ord_num='+ord_num; 	
	 var nm = 'Order';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function down_pttn(id, num) {

	if ( confirm("download this style pattern file?")) {
		cgiget="{/literal} {$cgistr_get}{literal}&cgino={/literal}{$start_no}{literal}&cgi_1={/literal}{$cgi.dept}{literal}&cgi_2={/literal}{$cgi.num}{literal}&cgi_3={/literal}{$cgi.cust}{literal}&cgi_4={/literal}{$cgi.ref}{literal}&cgi_5={/literal}{$cgi.factory}{literal}";
		location.href="./order_pttn/"+num+".mdl";
	} 
}

function file_del(table,id,wi_id,wi_num,file_name,back_str)
 {
	if ( confirm("Are you shure to delete [ "+wi_num+" ] file : [ "+file_name+" ] ??")) {
	location.href="index2.php?PHP_action=do_ws_file_del&PHP_id="+id+"&PHP_talbe="+table+"&PHP_wi_id="+wi_id+"&PHP_file_name="+file_name+"&PHP_wi_num="+wi_num+back_str;
	} 
 
 }
$(document).ready(function(){
	$("input[type='image']").hover(function() {
		$(this).attr('src','./picture/'+$(this).attr('order')+'.jpg?'+ Math.random());
	});
});
</script>
<script language="javascript">
window.open2=window.open; //在此把window.open()函數複製一份給window.open2，未來若要開新視窗則執行window.open2()即可
window.open=function(){return (new Object())}; //把window.open()函數變成空白函數，令提供者的跳窗無法顯示
</script> 
{/literal}
<body>
<br>
<table cellspacing=1 cellpadding=4 cols=2 width=700 bgcolor=#333333>
	<tr><td class="des" align=center height=28 width=320>[ <b><span class=ylw10> VIEW </span> WorkSheet for Order</b> : <b>{$wi.wi_num}</b>]</td>
	<td class="ylw10" align=center height=28 width=100>{if $wi.ti_cfm <> '0000-00-00'}<b>[ {literal}SUBMIT{/literal} ]{else}[{literal} UN SUBMIT{/literal} ]{/if}</span></b></td>
	<td class="des" align=center height=28 width=100>Version :<span class=ylw10><b>{$wi.ti_rev}</b></span></td>
	<td class="des" align=center width=140>{if $wi.ti_cfm <> '0000-00-00' && $edit_non <> 1 && $edit_flag}
			<a href="javascript:cfm_revise('{$wi.wi_num}','{$wi.id}','{$wi.ti_rev}','{$back_str}','{$back_str2}')" value='revise' style='cursor:pointer'>
			<img src='./images/revise21.jpg' border=0 ALT="REVISE ORDER"></a>
	   {else}
		&nbsp;
	   {/if}
	  </td>
	</tr>
</table>
{if $msg_YES}
     <table border=1 cellpadding=4 cellspacing=0 cols=1 width=700>
      <tr bgcolor=#ffffff> 
        <td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
        <td class=bgdy>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</td>
      </tr>
     </table>
{/if}
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
    <td class=snvy align=right nowrap>Customer :</td>
    <td class=bgdy align=left><b>&nbsp;{$smpl.cust_iname}</b></td>
    <td class=snvy align=right nowrap>Department :</td>
    <td class=bgdy align=left><b>&nbsp;{$wi.dept}</b></td>
    <td class=snvy align=right nowrap><b>ETD :</b></td>
    <td class=bgdy align=left><b>&nbsp;{$wi.etd}</b></td>
    <td nowrap width=10 align=center class=back>
    {if $wi.ti_cfm <> '0000-00-00'}
    <a href="index2.php?PHP_action=ti_print&PHP_id={$wi.wi_num}" >
			<img src="./images/print9.gif" border=0 alt="PDF: SAVE/PRINT"></a>
			{else}&nbsp;{/if}
	</td>
  </tr>
  </tr>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
</table>
<table border cellspacing=0 cellpadding=3 width=700 bgcolor=#ffffff align=center>
  <tr bgcolor="#003333" height=28> 
	<td nowrap width=100 align=center class=back><b>Picture</b></td>
	<td nowrap width=100 align=center class=back><b>Order #</b></td>
	<td nowrap width=100 align=center class=back><b>style</b></td>
	<td nowrap width=150 align=center class=back><b>SIZE RANGE</b></td>
	<td nowrap width=200 align=center class=back><b>Q'ty / Unit</b></td>
  </tr>
  <tr bgcolor=#DDDDDD height=28>
	<td class=g10 align=center rowspan=2>&nbsp;
		<input type="image" src="{$wi.pic_url}" order="{$wi.wi_num}" name="pic" width=100 border="0" onclick='window.open2("{$wi.pic_url}","","resizable=yes,height=480,width=640")'>
	</td>
	<td class=grn9 align=center>
	  <a href="javascript:Show_ord('{$wi.smpl_id}','{$wi.style_code}')" value='ord_out' style='cursor:pointer'>
	<b>&nbsp;{$smpl.order_num}</b></a></td>
    <td class=grn9 align=center><b>&nbsp;{$smpl.style}</b></td>
    <td class=grn9 align=center><b>&nbsp;{$smpl.size_scale}</b></td>
    <td class=grn9 align=center><b><span class=bgdy9><b>{$total}</b></span>&nbsp;{if $wi.unit}{$wi.unit}{else}<span class=bgdy9><UnInput></span>{/if}</b></td>
  </tr>
  <tr>
	<td colspan=5 >

		<table border cellspacing=0 cellpadding=2 width=470 bgcolor=#ffffff align=center>
			{section name=USE loop=$show_breakdown}
				{$show_breakdown[USE]}
			{/section}
			{if $size_ttl}
			<TR>
				<td class=grn9 align=center colspan=2 bgcolor=#DDDDDD><b>&nbsp;G-TTL</b></td>
			{section name=USE loop=$size_ttl}
				<td class=b9 align=center bgcolor=#DDDDDD>&nbsp;<b><i>{$size_ttl[USE]|NUMBER_FORMAT}</b></td>
			{/section}
			  <td class=b9 align=right bgcolor=#DDDDDD>&nbsp;<b><i>{$g_ttl|NUMBER_FORMAT}</b></td>
			<TR>
			{/if}
		</table>

	</td>
  </tr>
</table>

<br>
<!-------------  Tech Instruction range 生產說明 ------------->
    <table width=700 border=1 cellspacing=1 cellpadding=1>
     <tr bgcolor=#EACEBE height=25>
	  <td width=90 class=b9 align=center><b>Item</b></td>
	  <td width=400 class=b9 align=center><b>Production Description</b></td>
	  <td width=70 class=b9 align=center><b>Remark</b></td>
     </tr>

	{if $ti_NONE && !$sub_ti}  
	  <tr>
		<td colspan=4 align=center class=ssign><br>No Production Description!<br><br></td>
	  </tr>
	{/if}

	{section name=DES loop=$ti } 
     <tr bgcolor=#eeeeee height=22>
	  <td class=snvy>{$ti[DES].item}&nbsp;</td>
	  <td class=snvy >{$ti[DES].detail}&nbsp;</td>
	  <td class=gry7 align=center>{$ti[DES].date}&nbsp;</td>
	 </tr>
	{/section} 
	

	{section name=REC loop=$sub_ti }
  <tr height=25>
	  <td colspan=3 class=snvy align=center ><B>{$sub_ti[REC].name}&nbsp;</B></td>
	</tr>	
	{section name=DES loop=$sub_ti[REC].txt } 
	{if $sub_ti[REC].txt[DES].detail <> ''}
   <tr bgcolor=#eeeeee height=22>
	  <td class=snvy >{$sub_ti[REC].txt[DES].item}&nbsp;</td>
	  <td class=snvy >{$sub_ti[REC].txt[DES].detail}&nbsp;</td>
	  <td class=gry7 align=center>{$sub_ti[REC].txt[DES].date}&nbsp;</td>
	 </tr>
	 {/if}
	{/section} 
	{/section}		
	</table>
	
	 <br>

<table width=700 border=1 cellspacing=1 cellpadding=1>
	 <tr bgcolor=#EACEBE height=25>	 
	    <td width=70 align=center><b>Dowload</b></td>	
	 	<td width=300 align=center><b>File name</b></td>
	 	<td width=300 align=center><b>Descript</b></td>
		<td width=30 align=center><b>DEL</b></td>
	 	
	 	</td>
	 </tr>
	 {if $done[0].id}
		 {section name=SEC loop=$done}
	 <tr>	
		<td align=center valign=top>
		<a href="download.php?fname={$done[SEC].file_name}&fdir=wi_file" title="{$done[SEC].file_name}" target="_blank"><img src='./images/file2.gif' border=0 ALT="download pattern"></a>
		</td>  	
		<td class=snvy >{$done[SEC].file_name}</td>
		<td class=snvy>{$done[SEC].file_des}</td>
		<td class=snvy>&nbsp;
			{if $edit_flag}
			<a href="javascript:file_del('file_det','{$done[SEC].id}','{$wi.id}','{$wi.wi_num}','{$done[SEC].file_name}','{$back_str2}')" value="刪除" style="cursor:pointer"><img src="images/del.gif" alt="刪除" border=0 valign=bottom></a>
			{/if}
			</td>
     </tr>
       {/section}
     {/if}
     <tr>
     	<td colspan=4>
        <form method=POST name=pattn enctype="multipart/form-data">    
	  			<input type="hidden" name="PHP_action" value="upload_order_file">
					<input type="hidden" name="PHP_num" value="{$wi.wi_num}">
					<input type="hidden" name="PHP_back_str" value="{$back_str}">
					<input type="hidden" name="PHP_back_str2" value="{$back_str2}">
					<input type = "hidden" name = "max_size" value="300000">
					<input type="hidden" name="PHP_id" value="{$wi.id}">&nbsp;		
					<input type='file' name='PHP_pttn' size=20 class=select>&nbsp;&nbsp;
				Descript : &nbsp;
					<input type='text' name='PHP_desp' size=40 class=select >&nbsp;&nbsp;
					<input type='submit' value='upload'>
		</form>
		</td>
	 </tr>
 </table>
    
    <br>
    
<table width=700 border=1 cellspacing=1 cellpadding=1>
	<tr bgcolor=#EACEBE height=25>	
	    <td width=200 align=center><b>Pattern Dowload</b></td> 	
	 	<td width=400 align=center bgcolor=#FFFFFF>
	 		{if $smpl.ptn_upload == '0000-00-00'}<b>No Pattern Upload</b>
	 				{elseif $smpl.ptn_upload <> '0000-00-00' and $smpl.paper_ptn == 1}
				<b>Paper Pattern</b>
	 		{else}
	 	<a href="javascript:down_pttn({$smpl.id},'{$smpl.order_num}')" value='smpl' style='cursor:pointer'>
        <img src='./images/file2.gif' border=0 ALT="download pattern"></a> on :
		<b>{$smpl.ptn_upload}</b>{/if}</td>	 	
	 	</td>
	 </tr>	 
     </table>	 
<!------------------------------------------------>


<table border=0 cellspacing=0 cellpadding=2 width=690 bgcolor=#ffffff align=center>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
	<td colspan=2><form method=POST name=back>
{if $back_str && $edit_non <> 1}
		<input type=button onClick="window.location.href='{$PHP_SELF}?PHP_action=ti_search_wi{$back_str}'" value=" << go back " class=select_e style="cursor:pointer; width=99%">
{else}&nbsp;
{/if}</form>
	</td>

{if $edit_flag && $wi.ti_cfm == '0000-00-00' && $edit_non <> 1}	
	<td colspan=2><form method=POST name=cfm>
		<input type="hidden" name="PHP_action" value="do_ti_cfm">
		<input type="hidden" name="PHP_id" value="{$wi.id}">
		<input type="hidden" name="PHP_wi" value="{$wi.wi_num}">
		<input type="hidden" name="PHP_revise" value="{$wi.ti_rev}">
		<input type="hidden" name="PHP_back_str" value="{$back_str}">
		<input type="hidden" name="PHP_back_str2" value="{$back_str2}">
		<input type="hidden" name="PHP_fty" value="{$smpl.factory}">
		<input type=submit value="[ SUBMIT ]" class=select_e style="cursor:pointer; width=99%"></form>
	</td>
{/if}
	<td colspan=2><form method=POST name=edit>
{if $edit_flag && $wi.ti_cfm == '0000-00-00' && $edit_non <> 1} 
		<input type="hidden" name="PHP_action" value="ti_add">
		<input type="hidden" name="PHP_id" value="{$wi.id}">
		<input type="hidden" name="PHP_back_str" value="{$back_str}">
		<input type="hidden" name="PHP_back_str2" value="{$back_str2}">
		<input type="hidden" name="PHP_msg" value="">
		<input type=submit value="[ Edit worksheet ]" class=select_e style="cursor:pointer; width=99%"></form>
{else}&nbsp;
{/if}
</form></td>
  </tr>

</table>
{include file="footer.html"}
