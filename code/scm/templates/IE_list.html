<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>==== ::::::::::  I.E. LISTING :::::::::: ====</title>
<link rel=stylesheet type="text/css" href="./css/scm.css">
{literal}
<script type="text/javascript" src="./js/jquery.min.js"></script>
<script language="javascript" src="./js/scm.js"></script>
<script language="javascript">
(function($){
	$(document).ready(function(){
	
		upload = function(ord) {
			gg = '<input type="file" name="PHP_up_file" size="8" value="" class="select">'+
			'<input type="submit" value="UPLOAD " class="select_e" style="cursor:pointer;" >'+
			'<span onclick="cancal(\''+ord+'\');"><img src="./images/del.png" border="0" alt="CANCAL" style="cursor:pointer"></span>'
			$("#ie_file"+ord).append(gg);
			$("#upfile"+ord).attr({'style':'display:none;'});
		};
		
		cancal = function(ord) {
			$("#ie_file"+ord).html('');
			$("#upfile"+ord).attr({'style':'display:inline'});
		};
		
		cnl =  function() {
			if(!confirm('確定是否刪除!!!')){
				return false;
			}
		};
		
	});
})(jQuery);

<!-- start -->
function add_ie1(id, ord_num,pgs) {
	var T = '';
		T = $("#time1_"+id).val();
	if ( confirm("are you sure to add #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=add_ie1&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time1="+T+"&PHP_back="+cgiget+"&PHP_sr_startno="+pgs;
	} 
}

function cfm_ie1(id, ord_num, qty,pgs,status,fty,etd,etp,style) {
	var T = '';
		T = $("#time1_"+id).val();
	if ( confirm("are you sure to add #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=cfm_ie1&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time1="+T+"&PHP_qty="+qty+"&PHP_back="+cgiget+"&PHP_sr_startno="+pgs+"&PHP_status="+status+"&PHP_fty="+fty+"&PHP_etd="+etd+"&PHP_etp="+etp+"&PHP_style="+style;
	} 
}

function reset_ie(id,ord_num,page,time){
	if ( confirm("are you sure to reset #[ "+ord_num+" ] \rin IE working time ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=reset_ie&PHP_id="+id+"&PHP_sr_startno="+page+"&PHP_ord_num="+ord_num+"&PHP_time="+time;
	} 
}

function add_ie2(id, ord_num,pgs) {
	var T = '';
		T = $("#time2_"+id).val();
	if ( confirm("are you sure to add #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=add_ie2&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time2="+T+"&PHP_sr_startno="+pgs;
	} 
}

function add_ie2(id, ord_num,pgs) {
	var T = '';
		T = $("#time2_"+id).val();
	if ( confirm("are you sure to add #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=add_ie2&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time2="+T+"&PHP_sr_startno="+pgs;
	} 
}

function cfm_ie2(id, ord_num,qty,pgs,status,fty,etd,etp,ie1) {
	var T = '';
		T = $("#time2_"+id).val();
	if ( confirm("are you sure to add #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=cfm_ie2&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time2="+T+"&PHP_qty="+qty+"&PHP_sr_startno="+pgs+"&PHP_status="+status+"&PHP_fty="+fty+"&PHP_etd="+etd+"&PHP_etp="+etp+"&PHP_ie1="+ie1;
	} 
}

function reset_ie_final(id,ord_num,page,time){
	if ( confirm("are you sure to reset #[ "+ord_num+" ] \rin IE working time ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=reset_ie_final&PHP_id="+id+"&PHP_sr_startno="+page+"&PHP_ord_num="+ord_num+"&PHP_time="+time;
	} 
}

function mdf_ie(id, ord_num,pgs) {
	var T = '';
		T = $("#time3_"+id).val();
	if ( confirm("are you sure to Modified #[ "+ord_num+" ] \rin IE working time at ["+T+"] seconds ?? ")) {
		cgiget='';
		location.href="ie.php?PHP_action=mdf_ie&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_ie_time3="+T+"&PHP_back="+cgiget+"&PHP_sr_startno="+pgs;
	} 
}
<!-- end -->
</script>
{/literal}
</head>
<body>
<table cellpadding="0" cellspacing="0" cols="0" class="txt_item">
	<tr>
        <td colspan="17" class="subtitle">ORDER LIST - <span class=bgdy9>for IE records</span></td>
    </tr>
	{if $msg_YES}
	<TR>
		<TD colspan="17">
			<table border="0" cellpadding="3" cellspacing="0" cols="1">
				<tr bgcolor=#ffffff>
					<td width="90" class="gry10" align="center"><img src="images/alert.gif" border="0"></td>
					<td class="msg">{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</td>
				</tr>
			</table>
		</TD>
	</TR>
	{/if}
	<tr> 
		<td class="ListName" id="LHT-order">Order# <img id="LHT-order" src="./js/src/css/img/nav-right.gif"></td>
		<td class="ListName">Style#</td>
		<td class="ListName">Smpl-ord#</td>
		<td class="ListName" id="LH-order" style="display:none;">Smpl APV</td>
		<td class="ListName" id="LH-order" style="display:none;">Pttn UP-D</td>
		<td class="ListName">Style</td>
		<td class="ListName">Q'ty</td>
		<td class="ListName">Est. SPT</td>
		<td class="ListName">Calc. IE</td>
		{if $admin_flag}
		<td class="ListName">IE Reset</td>
		{/if}
		<td class="ListName">Final SPT</td>
		<td class="ListName">Final IE</td>
        {if $admin_flag}
        <td class="ListName">IE Reset</td>
		<td class="ListName">Modified</td>
		<td class="ListName">Update IE</td>
        {/if}
		<td class="ListName">FTY</td>
		<td class="ListName"></td>
	</tr>
	
	{section name=SEC loop=$sorder}
	{if $sorder[SEC].ie1 > 0}
	<tr id="List_TR" bgColor="#DDDDD0">
	{else}
	<tr id="List_TR">
	{/if}
		<td class="ListValueCenter"><a href="{$PHP_SELF}?PHP_action=ie_record_view&PHP_id={$sorder[SEC].id}&cgiget= {$cgistr_get}&cgino={$now_pp}&cgi_1={$cgi.dept}&cgi_2={$cgi.order_num}&cgi_3={$cgi.cust}&cgi_4={$cgi.ref}&cgi_5={$cgi.factory}&cgi_6={$cgi.style}&cgi_7={$cgi.sample}" title="{$sorder[SEC].statuss}">{$sorder[SEC].order_num}</a></td>
		<td class="ListValueCenter">{$sorder[SEC].style_num}</td>
		<td class="ListValueCenter">{$sorder[SEC].smpl_ord}</td>
		<td class="ListValueCenter" id="LH-order" style="display:none;">{if $sorder[SEC].smpl_apv =='0000-00-00'}{else}{$sorder[SEC].smpl_apv}{/if}</td>
		<td class="ListValueCenter" id="LH-order" style="display:none;">{if $sorder[SEC].ptn_upload =='0000-00-00'}{else}{$sorder[SEC].ptn_upload}{/if}</td>
		<td class="ListValueCenter">{$sorder[SEC].style}</td>
		<td class="ListValueRight">{$sorder[SEC].qty}{$sorder[SEC].unit}</td>
		<td class="ListValueCenter" style="color:#895117;" bgcolor="#f2f2f2">
            {if $sorder[SEC].ie_time1 == 0}
                {if $add_flag  && $sorder[SEC].dept_edit}
                    <input type="text" id="time1_{$sorder[SEC].id}" name="time1_{$sorder[SEC].id}" size=4 class=select value="" style='text-align:center'>
                {/if}
            {else}
                {if $edit_flag && ($sorder[SEC].ie1 == 0)}
                    <input type="text" id="time1_{$sorder[SEC].id}" name="time1_{$sorder[SEC].id}" size=4 class=select value="{$sorder[SEC].ie_time1}" style='text-align:center'>
                {else}
                    {$sorder[SEC].ie_time1}
                {/if}
            {/if}
		</td>
		<td class="ListValueCenter" style="color:#895117;" bgcolor="#f2f2f2">
            {if $sorder[SEC].ie1 > 0}
                {$sorder[SEC].ie1}
            {else}
                {if $sorder[SEC].ie_time1 == 0 }
                    {if $add_flag && $sorder[SEC].dept_edit}
                    <a href="javascript:add_ie1({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$now_pp}')" value='add1' style='cursor:pointer'>
                        <img src='./images/submit02.jpg' border="0" title="submit IE work time">
                    </a>
                    {/if}
                {elseif $edit_flag}
                    <a href="javascript:cfm_ie1({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$sorder[SEC].qty}','{$now_pp}','{$sorder[SEC].status}','{$sorder[SEC].factory}','{$sorder[SEC].etd}','{$sorder[SEC].etp}','{$sorder[SEC].style}')" value='cfm1' style='cursor:pointer'>
                        <img src='./images/confirm.jpg' border="0" title="confirm IE work time">
                    </a>
                {else}uncfm
                {/if}
            {/if}
        </td>
		{if $admin_flag}
        <td class="ListValueCenter">
			<!-- 未 submit 和 reject 時可修改 -->
			{if $sorder[SEC].ie1 > 0 && $sorder[SEC].final_check <> 1 }
				<img onclick="reset_ie({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$PHP_sr_startno}','{$sorder[SEC].ie_time1}')" style="cursor:pointer" src='./images/REOPEN.jpg' border="0" title="Reset IE Values">
			{/if}
        </td>
		{/if}

		<td class="ListValueCenter" style="color:#511789;" bgcolor="#dedede">
            {if $sorder[SEC].ie_time2 == 0 && $sorder[SEC].final_check <> 1}
                {if $add_flag  && $sorder[SEC].dept_edit}
                    <input type="text" id="time2_{$sorder[SEC].id}" name="time2_{$sorder[SEC].id}" size=4 class=select value="" style='text-align:center'>
                {/if}
            {else}
                {if ($edit_flag && $sorder[SEC].ie2 == 0 ) && $sorder[SEC].final_check <> 1 }
                    <input type="text" id="time2_{$sorder[SEC].id}" name="time2_{$sorder[SEC].id}" size=4 class=select value="{$sorder[SEC].ie_time2}" style='text-align:center'>
                {else}
                    {if $sorder[SEC].ie_time2 == 0}NONE{else}{$sorder[SEC].ie_time2}{/if}
                {/if}
            {/if}
        </td>
		<td class="ListValueCenter" style="color:#511789;" bgcolor="#dedede">
		{if $sorder[SEC].ie2 > 0 || $sorder[SEC].final_check == 1}   
			{if $sorder[SEC].ie2 == 0}NONE{else}{$sorder[SEC].ie2}{/if}
		{else}
            {if $sorder[SEC].ie_time2 == 0}
            {if $add_flag  && $sorder[SEC].dept_edit}
			<a href="javascript:add_ie2({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$now_pp}')" value='add' style='cursor:pointer'>
			<img src='./images/submit02.jpg' border="0" title="submit final IE work time"></a>
            {/if}
            {elseif $edit_flag}
			<a href="javascript:cfm_ie2({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$sorder[SEC].qty}','{$now_pp}','{$sorder[SEC].status}','{$sorder[SEC].factory}','{$sorder[SEC].etd}','{$sorder[SEC].etp}','{$sorder[SEC].ie1}')" value='cfm2' style='cursor:pointer'>
			<img src='./images/confirm.jpg' border="0" title="confirm IE work time">
            </a>
            {else}
            uncfm
            {/if}
		{/if}
		</td>
		{if $admin_flag}
        <td class="ListValueCenter">
			<!-- 未 submit 和 reject 時可修改 -->
			{if $sorder[SEC].ie2 > 0 && $sorder[SEC].final_check <> 1}
				<img onclick="reset_ie_final({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$PHP_sr_startno}','{$sorder[SEC].ie_time2}')" style="cursor:pointer" src='./images/REOPEN.jpg' border="0" title="Reset IE Values">
			{/if}
        </td>
        <td class="ListValueCenter">{if $sorder[SEC].ie2 > 0 && $sorder[SEC].final_check <> 1}<input type="text" id="time3_{$sorder[SEC].id}" name="time3_{$sorder[SEC].id}" size=4 class=select value="{if $sorder[SEC].ie_time2}{$sorder[SEC].ie_time2}{else}{$sorder[SEC].ie_time1}{/if}" style='text-align:center'>{/if}</td>
        <td class="ListValueCenter">
            {if $sorder[SEC].ie2 > 0 && $sorder[SEC].final_check <> 1}
            <input type="button" class="myButton" value="Update" onclick="mdf_ie({$sorder[SEC].id},'{$sorder[SEC].order_num}','{$sorder[SEC].qty}','{$now_pp}','{$sorder[SEC].status}','{$sorder[SEC].factory}','{$sorder[SEC].etd}','{$sorder[SEC].etp}','{$sorder[SEC].style}')">
            {/if}
        </td>
        {/if}
		<td class="ListValueCenter">{$sorder[SEC].factory}</td>
		<td class="ListValueLeft">
			{if $sorder[SEC].ie2_file}
			<a href="ie.php?PHP_action=download&fname={$sorder[SEC].ie2_file}&fdir=ord_ie" style="cursor:pointer"><img src="./images/IE_ANALYSIS.gif" border="0" alt="IE ANALYSIS"></a> 
			{/if}
			
			{if $sorder[SEC].ie_file}
			<form method="POST" name="up_load" enctype="multipart/form-data" action="ie.php">
			<a href="ie.php?PHP_action=download&fname={$sorder[SEC].order_num}.{$sorder[SEC].ie_file}&fdir=ie_analysis" style="cursor:pointer"><img src="./images/IE_ANALYSIS.gif" border="0" alt="IE ANALYSIS"></a> 
			<a href="ie.php?PHP_action=ie_cancel&PHP_ord_num={$sorder[SEC].order_num}&ie_file={$sorder[SEC].ie_file}&PHP_sr_startno={$PHP_sr_startno}" style="cursor:pointer" onclick="return cnl('');"><img src="./images/DELETE.gif" border="0" alt="CANCEL IE"></a>

			<span id="upfile{$sorder[SEC].order_num}" onclick="upload('{$sorder[SEC].order_num}');"><img src="./images/upload.gif" border="0" alt="UPLOAD" style="cursor:pointer"></span>
			<span id="ie_file{$sorder[SEC].order_num}"></span>
			<input type="hidden" name="PHP_action" value="ie_upload">
			<input type="hidden" name="PHP_ord_num" value="{$sorder[SEC].order_num}">	
			<input type="hidden" name="PHP_sr_startno" value="{$PHP_sr_startno}">	
			</form>
			{/if}
		</td>
	</tr>
	{/section}
	<tr>   
		<td colspan="17" align="center"><span class="search_txt">※ above listing {if $msg_YES}{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]} {/section}{/if}order records! </span><span class="search_total">[ total : {$max_no} entries ]</span></td>
	</tr>
	<tr>   
		<td colspan="17" align="center">
            <table cellpadding="0" cellspacing="6" cols="0" >
                <tr>
                    <td align="center">
                        {if $pages[0] > 1}
                        <input type="button" value=" < prev 10 page " class="search_button" onClick="window.location='ie.php?PHP_action=ie_search&PHP_sr_startno=p{$pages[0]}'">
                        {/if}
                    </td>
                    <td></td>
                    <td align="center" class="search_a"> 
                        {section name=PGE loop=$pages}
                        {if $pages[PGE] <= $maxpage }
                        {if $pages[PGE] == $now_pp}
                        <span class="search_page"><i>{$pages[PGE]}</i></span>
                        {else}
                        <a href="ie.php?PHP_action=ie_search&PHP_sr_startno={$pages[PGE]}">{$pages[PGE]}</a>
                        {/if}
                        {/if}   
                        {/section}
                    </td>
                    <td></td>
                    <td align="center">  
                        {if $lastpage < $maxpage}
                        <input type="button" value=" next 10 page >" class="search_button" onClick="window.location='ie.php?PHP_action=ie_search&PHP_sr_startno=n{$lastpage}'">         
                        {/if}
                    </td>
                    <td></td>
                    <td align="center">
                        <a href="{$PHP_SELF}?PHP_action=ie_excel">
                        <img src="./images/excel_icon.gif" border="0" title=" * windows [Excel] IR "></a>
                    </td>
                </tr>            
            </table>
        </td>
	</tr>
</table>
<!--------- footer ---------->
{include file="footer.html"}