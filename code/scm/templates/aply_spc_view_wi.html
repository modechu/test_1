<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM System  ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
</head>
{literal}
<script language="javascript" src="./js/col.js"></script>
<script>

function Show_ord(id,ord_num) {
	var url ='index2.php?PHP_action=order_fa_view&PHP_id='+id+'&cgiget=&cgino=&cgi_1=&cgi_2=&cgi_3=&cgi_4=&cgi_5=&cgi_6=&cgi_7=&PHP_ord_num='+ord_num; 	
	var nm = 'Order';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function Show_fab(code) {
	var url ="index2.php?PHP_action=lots_view&PHP_code="+code+"&PHP_lots_code=&PHP_lots_name=&PHP_comp=";
	var nm = 'Fabric';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function Show_acc(code) {
	var url ="index2.php?PHP_action=acc_view&PHP_code="+code+"&PHP_acc_code=&PHP_acc_name=&PHP_des=";
	var nm = 'Accessory';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function list(item,cat){
	var gofile ='index2.php?PHP_action=show_supplier_search&PHP_item='+item+'&PHP_cat='+cat;	
	style=window.open2(gofile,'supplier','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500, top=100, left=150');
}

function add_sup(item,cat){
	var gofile ='index2.php?PHP_action=show_supplier_add&PHP_item='+item+'&PHP_cat='+cat;	
	style=window.open2(gofile,'supplier','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500, top=100, left=150');
}
 
function writeToSupItemlList(vndr_no,supl_s_name,supl_cat,item) {
	var i=0;
	window.document.forms['aply_wi'].elements[item].value = vndr_no;
}

function creat_ap(wi_num,ven_name,eta_name,qty_name,item,back_str,unit,mat_code,color_name){
	var vendor = window.document.forms['aply_wi'].elements[ven_name].value;
	var eta = window.document.forms['aply_wi'].elements[eta_name].value;
	var qty = window.document.forms['aply_wi'].elements[qty_name].value;
	var color = window.document.forms['aply_wi'].elements[color_name].value;
	//	var loca='index2.php?PHP_action=apply_special_add&PHP_wi_num='+wi_num+'&PHP_qty='+qty+"&PHP_vendor="+vendor+"&PHP_eta="+eta+"&PHP_item="+item+"&PHP_unit="+unit+"&PHP_mat_code="+mat_code+"&PHP_color="+color; 	
	//	alert (loca);
	window.location='index2.php?PHP_action=apply_special_add&PHP_wi_num='+wi_num+'&PHP_qty='+qty+"&PHP_vendor="+vendor+"&PHP_eta="+eta+"&PHP_item="+item+"&PHP_unit="+unit+"&PHP_mat_code="+mat_code+"&PHP_color="+color; 	
}
</script>
<script language="javascript">
window.open2=window.open; //在此把window.open()函數複製一份給window.open2，未來若要開新視窗則執行window.open2()即可
window.open=function(){return (new Object())}; //把window.open()函數變成空白函數，令提供者的跳窗無法顯示
</script> 
{/literal}
<body>
<br>
<table cellspacing=1 cellpadding=4 cols=2 width=700 bgcolor=#333333>
	<tr><td class="des" align=center height=28>[ <b><span class=ylw10>PA </span> for Order </b> : <b>{$wi.wi_num}</b>]</td></tr>
</table>
{if $msg_YES}
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=700>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</td>
	</tr>
</table>
{/if}

<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
    <td class=snvy align=right nowrap>Customer :</td>
    <td class=bgdy align=left><b>&nbsp;{$smpl.cust_iname}</b></td>
    <td class=snvy align=right nowrap>Department :</td>
    <td class=bgdy align=left><b>&nbsp;{$wi.dept}</b></td>
    <td class=snvy align=right nowrap><b>ETD :</b></td>
    <td class=bgdy align=left><b>&nbsp;{$wi.etd}</b></td>
  </tr>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
</table>
<table border cellspacing=0 cellpadding=3 width=700 bgcolor=#ffffff align=center>
  <tr bgcolor="#003333" height=28> 
		<td nowrap width=100 align=center class=back><b>Picture</b></td>
		<td nowrap width=100 align=center class=back><b>Order #</b></td>
		<td nowrap width=100 align=center class=back><b>style</b></td>
		<td nowrap width=150 align=center class=back><b>SIZE RANGE</b></td>
		<td nowrap width=200 align=center class=back><b>Q'ty / Unit</b></td>
  </tr>
  <tr bgcolor=#DDDDDD height=28>
		<td class=g10 align=center rowspan=2>&nbsp;
		<input type="image" src="{$wi.pic_url}" name="pic" width=100 border="0" onclick='window.open2("{$wi.pic_url}","","height=640,width=480")'>
		</td>
		<td class=grn9 align=center>
		<a href="javascript:Show_ord('{$wi.smpl_id}','{$wi.style_code}')" value='ord_out' style='cursor:pointer'>
		<b>&nbsp;{$smpl.order_num}</b></a></td>
		<td class=grn9 align=center><b>&nbsp;{$smpl.style}</b></td>
		<td class=grn9 align=center><b>&nbsp;{$smpl.size_scale}</b></td>
		<td class=grn9 align=center><b><span class=bgdy9><b>{$total}</b></span>&nbsp;{if $wi.unit}{$wi.unit}{else}<span class=bgdy9><UnInput></span>{/if} (Order : {$smpl.qty}{$wi.unit})</b></td>
  </tr>
  <tr>
		<td colspan=5 >
			<table border cellspacing=0 cellpadding=2 width=470 bgcolor=#ffffff align=center>
				{$show_breakdown}
			</table>
		</td>
  </tr>
</table>
<!-------------  material range ------------->
<br>
<form method=POST name=aply_wi>
<table width=700 border=0 cellspacing=1 cellpadding=2>
	<tr bgcolor=#333333 height=28>
		<td width=100 class=ylw9 align=center><b>Fabirc #</b></td>
		<td width=150 class=ylw9 align=center><b>Placement</b></td>
		<td width=40 class=ylw9 align=center><b>Unit</b></td>
		<td width=60 class=ylw9 align=center><b>color/cat.</b></td>
		<td width=150 class=ylw9 align=center><b>Supplier</b></td>
		<td width=100 class=ylw9 align=center><b>ETD</b></td>
		<td width=60 class=ylw9 align=center><b>Q'ty</b></td>
		<td width=40 class=ylw9 align=center><b>Select</b></td>
	</tr>
	{if $lots_NONE}  
	<tr>
		<td colspan=6 align=center class=ssign><br>NO Fabric data!<br><br>
	</tr>
	{/if}

	{section name=USE loop=$lots_use} 
	<tr bgcolor=#eeeeee height=28>
	  <td class=snvy align=center><a href="javascript:Show_fab('{$lots_use[USE].lots_code}')" value='ord_out' style='cursor:pointer'>{$lots_use[USE].lots_code}&nbsp;</a></td>
	  <td class=snvy >{$lots_use[USE].use_for}&nbsp;</td>
	  <td class=snvy align=center>{$lots_use[USE].unit}&nbsp;</td>
 	  <td class=snvy align=center><input type=text name="PHP_lots_color{$lots_use[USE].id}" size=8 class=select value="{$lots_use[USE].color}">&nbsp;</td>
	  <td class=snvy align=center>&nbsp;
	  	<input type=text name="PHP_lots_v{$lots_use[USE].id}" size=10 class=select value="{$lots_use[USE].vendor1}" readonly>&nbsp;
    	<img src="./images/icoSearch.gif" alt="Supplier" onClick="list('PHP_lots_v{$lots_use[USE].id}','FABRIC');" style="cursor:pointer" >
    	<img src="./images/add.gif" alt="Supplier ADD" onClick="add_sup('PHP_lots_v{$lots_use[USE].id}','FABRIC');" style="cursor:pointer">

	  </td>
	  <td class=snvy align=center>
 		    <img align='top' onmousedown="javascript:Cal(document.aply_wi.PHP_lots_eta{$lots_use[USE].id},1,100,50,999,0,'')" src='images/cal.gif' width="16" height="16" style='cursor:hand'>    
  	  	<input type=text name="PHP_lots_eta{$lots_use[USE].id}" size=8 class=select value="{$lots_use[USE].eta}" readonly>&nbsp;
	  </td>
 	  <td class=snvy align=center><input type=text name="PHP_lots_qty{$lots_use[USE].id}" size=5 class=select value="{$lots_use[USE].qty}">&nbsp;</td>

	  <td class=snvy align=center>
  	  	<input type=button class=select value="ADD" onclick=creat_ap('{$wi.wi_num}','PHP_lots_v{$lots_use[USE].id}','PHP_lots_eta{$lots_use[USE].id}','PHP_lots_qty{$lots_use[USE].id}','lots','{$back_str}','{$lots_use[USE].unit}','{$lots_use[USE].lots_code}','PHP_lots_color{$lots_use[USE].id}')>&nbsp;
		</td>
	</tr>
	{/section} 
</table>
<!------------------------------------------------>
<!-------------  accessories range ------------->
<table width=700 border=0 cellspacing=1 cellpadding=2>
	<tr bgcolor=#333333 height=28>
		<td width=100 class=ylw9 align=center><b>Acc. #</b></td>
		<td width=150 class=ylw9 align=center><b>Placement</b></td>
		<td width=40 class=ylw9 align=center><b>Unit</b></td>
		<td width=60 class=ylw9 align=center><b>color/cat.</b></td>
		<td width=150 class=ylw9 align=center><b>Supplier</b></td>
		<td width=100 class=ylw9 align=center><b>ETD</b></td>
		<td width=60 class=ylw9 align=center><b>Q'ty</b></td>
		<td width=40 class=ylw9 align=center><b>Select</b></td>
	</tr>
	{if $acc_NONE}  
	<tr>
		<td colspan=6 align=center class=ssign>NO Accessory data!<input type="hidden" name="PHP_acc_est" value=""></td>
	</tr>
	{/if}
	{section name=USE loop=$acc_use} 
	<tr bgcolor=#eeeeee height=28>
	  <td class=snvy align=center><a href="javascript:Show_acc('{$acc_use[USE].acc_code}')" value='ord_out' style='cursor:pointer'>{$acc_use[USE].acc_code}&nbsp;</a></td>
	  <td class=snvy >{$acc_use[USE].use_for}&nbsp;</td>
		<td class=snvy align=center>{$acc_use[USE].unit}&nbsp;</td>
 	  <td class=snvy align=center >
  	  	<input type=text name="PHP_acc_color{$acc_use[USE].id}" size=8 class=select value="{$acc_use[USE].color}">&nbsp;
		</td>
	  <td class=snvy align=center>
	  	<input type=text name="PHP_acc_v{$acc_use[USE].id}" size=10 class=select value="{$acc_use[USE].vendor1}" readonly>&nbsp;
    	<img src="./images/icoSearch.gif" alt="Supplier" onClick="list('PHP_acc_v{$acc_use[USE].id}','ACCESSORY');" style="cursor:pointer">
    	<img src="./images/add.gif" alt="Supplier ADD" onClick="add_sup('PHP_acc_v{$acc_use[USE].id}','ACCESSORY');" style="cursor:pointer">
	  </td>
	  <td class=snvy align=center>
 		    <img align='top' onmousedown="javascript:Cal(document.aply_wi.PHP_acc_eta{$acc_use[USE].id},1,100,50,999,0,'')" src='images/cal.gif' width="16" height="16" style='cursor:hand'>    
  	  	<input type=text name="PHP_acc_eta{$acc_use[USE].id}" size=8 class=select value="{$acc_use[USE].eta}" readonly>&nbsp;
	  </td>
 	  <td class=snvy align=center >
  	  	<input type=text name="PHP_acc_qty{$acc_use[USE].id}" size=5 class=select value="{$acc_use[USE].qty}">&nbsp;
		</td>

	  <td class=snvy align=center>
  	  	<input type=button class=select value="ADD" onclick=creat_ap('{$wi.wi_num}','PHP_acc_v{$acc_use[USE].id}','PHP_acc_eta{$acc_use[USE].id}','PHP_acc_qty{$acc_use[USE].id}','acc','{$back_str}','{$acc_use[USE].unit}','{$acc_use[USE].acc_code}','PHP_acc_color{$acc_use[USE].id}')>&nbsp;
	  </td>
	</tr>
	{/section}	
 
  <tr>
    <td colspan=6 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
</table>
</form>
<table width=700 border=0 cellspacing=1 cellpadding=2>
	<tr bgcolor=#ffffff height=28>
		<td class=gry9 align=center>
		<font color=black>Open: </font><u>{$wi.creator}</u>&nbsp;&nbsp;<u>{$wi.open_date}</u>&nbsp;&nbsp;&nbsp;&nbsp;
		<font color=black>Last Update : </font><u>{if $wi.updator}{$wi.updator}{else}[ None ]{/if}</u>&nbsp;&nbsp;<u>{$wi.last_update}</u>&nbsp;&nbsp;&nbsp;&nbsp;
		<font color=black>{literal}CFM: {/literal}</font><u>{if $wi.confirmer}{$wi.confirmer}{else}[ None ]{/if}</u>&nbsp;&nbsp;<u>{$wi.cfm_date}</u>
		</td>
	</tr>
</table>
<!--------- wi data end ---------->
<table border=0 cellspacing=0 cellpadding=2 width=690 bgcolor=#ffffff align=center>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
		<td colspan=2>
			{if $back_str  && $edit_non <> 1}
			<input type=button onClick="window.location.href='{$PHP_SELF}{$back_str}'" value=" << go back " class=select_e style="cursor:pointer; width=99%">
			{/if}
		</td>
	</tr>
</table>
{include file="footer.html"}