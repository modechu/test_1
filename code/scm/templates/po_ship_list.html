<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>==== ::::::::::  SCM SYSTEM :::::::::: ====</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="./js/jquery.min.js"></script>
<script type="text/javascript" src="./js/jquery.blockUI.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<script language="javascript">
function tp(url) { parent.top.location.href=url }
function cfm(doit) {
	if ( confirm("確定要刪除 ??")) {
		location.href=doit;
	}
}

function ship_set(id, mode){
	$.blockUI({ message: ' Loding ...'});
    
	$.ajax({
			url: 'po_ship.php?PHP_action=ship_set',
			type: 'GET',
			data: {
				PHP_id: id,
				PHP_mode: mode
			},
			error: function(xhr) {
				alert('Ajax request 發生錯誤'+xhr);
			},
			success: function(response) {
				if(mode == 1){
					$("#span_cancel_ship_set_"+id).css("display", "");
					$("#span_set_ship_set_"+id).css("display", "none");
				}else{
					$("#span_cancel_ship_set_"+id).css("display", "none");
					$("#span_set_ship_set_"+id).css("display", "");
				}
				$.unblockUI();
			}
		});
}

function ship_finish(id, mode){
	$.blockUI({ message: ' Loding ...'});
    
	$.ajax({
			url: 'po_ship.php?PHP_action=ship_finish',
			type: 'GET',
			data: {
				PHP_id: id,
				PHP_mode: mode
			},
			error: function(xhr) {
				alert('Ajax request 發生錯誤'+xhr);
			},
			success: function(response) {
				if(mode == 1){
					$("#span_cancel_ship_finish_"+id).css("display", "");
					$("#span_set_ship_finish_"+id).css("display", "none");
				}else{
					$("#span_cancel_ship_finish_"+id).css("display", "none");
					$("#span_set_ship_finish_"+id).css("display", "");
				}
				$.unblockUI();
			}
		});
}
</script>
{/literal}
</head>
<body bgcolor="#003C77" topmargin=10>
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=800 id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>	
<table width=800 border=1 cellspacing=0 cellpadding=2>
	<tr><td colspan=11 align=center class=gry><b>SHIP LIST</b></td></tr>
    <tr bgcolor="#003333"> 
		<td class=w9 width=100 align=center rowspan=2><b>SHIP #</b></td>
		<td class=w9 width=100 align=center rowspan=2><b>TW<br>RCV</b></td>
		<td class=w9 width=160 align=center rowspan=2><b>B.L / Carrier</b></td>
		<td class=w9 width=120 align=center rowspan=2><b>Date</b></td>
		<td class=w9 align=center colspan=2><b>SHIP</b></td>
		<td class=w9 width=100 align=center rowspan=2><b>SHIP BY</b></td>
		<td class=w9 width=120 align=center rowspan=2><b>ETA</b></td>
		<td class=w9 width=160 align=center rowspan=2><b>status</b></td>
		{if $add_flag && $admin_flag}
		<td class=w9 width=60 align=center rowspan=2><b>Set</b></td>
		{/if}
		{if $admin_flag}
		<td class=w9 width=60 align=center rowspan=2><b>Finish</b></td>
		{/if}
	</tr>
	<tr bgcolor="#003333"> 
		<td class=w9 width=80 align=center ><b>FROM</b></td>
		<td class=w9 width=50 align=center ><b>TO</b></td>
	</tr>	
	{section name=SEC loop=$ship}
	{if $ship[SEC].status == 2}
	<tr bgColor='#dddddd' onMouseOver="bgColor='#FCF4A4'" onMouseOut="bgColor='#dddddd'">
	{else}
	<tr onMouseOver="bgColor='#FCF4A4'" onMouseOut="bgColor='#ffffff'">
	{/if}
		<td class=gry9 align=center nowrap><a href="po_ship.php?PHP_action=ship_view&PHP_id={$ship[SEC].id}{$back_str}&PHP_sr_startno={$now_pp}">{$ship[SEC].num}</a></td>
		<td class=gry9 align=center>{if $ship[SEC].tw_rcv > 0}Y{else}N{/if}</td>
		<td class=gry9 align=left>{$ship[SEC].carrier}&nbsp;</td>
		<td class=gry9 align=center nowrap>{$ship[SEC].ship_date}&nbsp;</td>
		<td class=gry9 align=left>{$ship[SEC].org}&nbsp;</td>
		<td class=gry9 align=center>{$ship[SEC].dist}&nbsp;</td>
		<td class=gry9 align=left>&nbsp;{$ship[SEC].ship_way}&nbsp;</td>
		<td class=gry9 align=center nowrap>{$ship[SEC].ship_eta}&nbsp;</td>
		<td class=gry9 align=left>&nbsp;
			{if $ship[SEC].status == 0}Wait for submit{/if}
			{if $ship[SEC].status == 2}Submitted{/if}&nbsp;
		</td>
		{if $add_flag && $admin_flag}
		<td class=gry9 align=center nowrap>
			<span id = "span_set_ship_set_{$ship[SEC].id}" style="display:{if $ship[SEC].ship_set_user == ''}''{else}'none'{/if};">
				<input type="button" id="btn_set_ship_set_{$ship[SEC].id}" class="select_e" value="SET" onclick="ship_set('{$ship[SEC].id}', 1);">&nbsp;
			</span>
			<span id = "span_cancel_ship_set_{$ship[SEC].id}" {if $ship[SEC].ship_set_user <> ''} style="display:''" {else} style="display:'none'" {/if}>
				<input type="button" id="btn_cancel_ship_set_{$ship[SEC].id}" class="" value="Cancel" onclick="ship_set('{$ship[SEC].id}', 0);">&nbsp;
			</span>
		</td>
		{/if}
		{if $admin_flag}
		<td class=gry9 align=center nowrap>
			<span id = "span_set_ship_finish_{$ship[SEC].id}" style="display:{if $ship[SEC].ship_finish_user == '' && $ship[SEC].ship_set_user <> ''}''{else}'none'{/if};">
				<input type="button" id="btn_set_ship_finish_{$ship[SEC].id}" class="select_e" value="Finish" onclick="ship_finish('{$ship[SEC].id}', 1);">&nbsp;
			</span>
			<span id = "span_cancel_ship_finish_{$ship[SEC].id}" style="display:{if $ship[SEC].ship_finish_user <> ''}''{else}'none'{/if};">
				<input type="button" id="btn_cancel_ship_finish_{$ship[SEC].id}" class="" value="Cancel" onclick="ship_finish('{$ship[SEC].id}', 0);">&nbsp;
			</span>
		</td>
		{/if}
	</tr>
	{/section}
</table>
<br>
<table width=630 border=0 cellspacing=0 cellpadding=1>
	<tr>
		<td class=w9 colspan=4 align=center><span class=bgdy>※ message </font>:above list {section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]} &nbsp;{/section}&nbsp;Purchase Order record!&nbsp;&nbsp;<span class=bgdy>[ total {$max_no} entries ]</font>
	</tr>
  <tr>
    <td align=center width=180>&nbsp;
		{if $pages[0] > 1}
			<input type="button" name="Submit5" value=" < prev 10-page" class=select_e style="cursor:pointer; width:90%" onClick="window.location='po_ship.php?PHP_action=po_ship_search{$back_str}&PHP_sr_startno=p{$pages[0]}'">
		{/if}
		</td>
		<td align=center width=260>
    {section name=PGE loop=$pages}
    {if $pages[PGE] <= $maxpage }
			{if $pages[PGE] == $now_pp}
				<font color="#FF0000"><i><b>&nbsp;{$pages[PGE]}</b></i></font>
			{else}
				<a href="po_ship.php?PHP_action=po_ship_search{$back_str}&PHP_sr_startno={$pages[PGE]}" style="cursor:pointer">&nbsp;{$pages[PGE]}</a>
			{/if}
		{/if}   
    {/section}
    </td>
    <td  align=center width=180>
		{if $lastpage < $maxpage}
			<input type="button" name="Submit6" value="next 10 -page >" class=select_e style="cursor:pointer; width:90%" onClick="window.location='po_ship.php?PHP_action=po_ship_search{$back_str}&PHP_sr_startno=n{$lastpage}'">
		{/if}
		</td>
	</tr>
</table>
<!--------- footer ---------->
{include file="footer.html"}
