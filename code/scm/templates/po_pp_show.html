<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM System ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="./js/jquery.min.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<script type="text/javascript" src="./js/jquery.blockUI.js"></script>

<style type="text/css">@import url(js/calendar/skins/aqua/theme.css);.outline {
	border :1px solid #CCCCCC;
	padding:3px 7px 3px 7px;
	background-color:#FFFFFF;
	color:#000000;
	margin:3px  !important;
	cursor:pointer;
}</style>

<script type="text/javascript" src="./js/calendar/calendar.js"></script>
<script type="text/javascript" src="./js/calendar/lang/calendar-en.js"></script>
<script type="text/javascript" src="./js/calendar/calendar-setup.js"></script>

<script type="text/javascript" src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript" src="./js/build/connection/connection-min.js"></script>

<Script language="javascript">

(function($){
	$(document).ready(function(){

		$("#pi_b_edit").click(function(){
			$("#pi_edit").css('display','inline');
			$("#pi_view").css('display','none');
		});
		
		$("#pi_b_update").click(function(){
			$("#pi_edit").css('display','none');
			$("#pi_view").css('display','inline');
			pi_update();
		});
		
		pi_update = function(po_num){

			$.blockUI({ message: '<div><br><h4>Waiting...</h4></div>'});
			
			var pi = $("#PHP_pi").val();
			
			$.ajax({
				url: "po.php?PHP_action=pi_add",
				type: 'POST',
				data: {
					po_num: $("#po_num").val(),
					pi: $("#PHP_pi").val()
				},
				success: function(msg){
					if ( msg == 'ok' ) {
						$("#pi_v_font").html($("#PHP_pi").val());
						$.blockUI({ message: '<div><br><h4>Successfully update PI# '+$("#PHP_pi").val()+' ...</h4></div>'});
						setTimeout(function(){ $.unblockUI(); }, 1200);
					} else {
						alert('error!!');
					}
				},
				error:function(xhr, ajaxOptions, thrownError){ 
					alert(xhr.status); 
					alert(thrownError); 
					$.unblockUI();
					$.blockUI({ message: '<div><br><h4>'+xhr.status+thrownError+'</h4></div>'});
				}
			});
		}
	
	});
})(jQuery);

var transaction;
var sUrl;	

function aply_revise(aply_num,bakc_str,special,id,rev,po_num) {
	var loc;
	loc='apply_pp_revise';
	//alert(aply_num+' ~ '+bakc_str+' ~ '+special+' ~ '+id+' ~ '+rev+' ~ '+po_num+' ~ '+loc);
	if ( confirm("are you sure to REVISE P/O :#[ "+po_num+" ] ?\r\rEvery Revise event will cancel entire process had done !\rAnd restart the apply procedure from beginning Again !\r\rBe sure this is OK for you!")) {
		$.blockUI({ message: '<div><br><h4>Waiting...</h4></div>'});
		// cgiget="{/literal} {$cgistr_get}{literal}&cgino={/literal}{$start_no}{literal}&cgi_1={/literal}{$cgi.dept}{literal}&cgi_2={/literal}{$cgi.order_num}{literal}&cgi_3={/literal}{$cgi.cust}{literal}&cgi_4={/literal}{$cgi.ref}{literal}&cgi_5={/literal}{$cgi.factory}{literal}";
		location.href="po.php?PHP_action="+loc+"&PHP_aply_num="+aply_num+"&PHP_back="+bakc_str+"&PHP_revise=1&PHP_id="+id+"&PHP_rev_time="+rev+"&PHP_special="+special;
	} 
}

function del_po(ap_num,back_str,po_num) {
	var loc;

	loc='apply_revise';
	if ( confirm("are you sure to DELETE P/O :#[ "+po_num+" ] ?")) {
		window.location="po.php?PHP_action=do_apply_del&PHP_ap_num="+ap_num+"&PHP_back="+back_str;
	} 
}


function del_po_apv(ap_num,back_str,po_num) {
	var loc;

	loc='apply_revise';
	if ( confirm("Deleting "+po_num+"  must write Exceptional report. \r\r Are you sure to DELETE P/O :#[ "+po_num+" ] ?")) {
		window.location="po.php?PHP_action=do_po_apv_del&PHP_status=12&PHP_ap_num="+ap_num+"&PHP_back="+back_str;
	} 
}

function cfm_ajx(id,r){
	var i=r.parentNode.parentNode.rowIndex;
	document.getElementById('mater_table').deleteRow(i);	  

	sUrl = "po.php?PHP_action=log_del_ajx&PHP_id="+id;
	transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, delback, null);
}

var delback = {
    success: function(o) {
        document.getElementById("tbl_msg").style.display='block';    
        var response = o.responseText.split("|");
        var divrep=response[0];
        msg1.innerText  = divrep;
    },failure: function(o) {
        alert("Error：Can't get data");
    }
};

function check(obj){
    var obj;
    var max=127;
    obj.value=obj.value.substring(0,max);
}  

function special_chk(spec)
{
	if(spec == 1) alert('採購單將併異常報告一起列印');
}

function rechk(num){
    if ( !confirm("are you sure to REOPEN P/O :#[ "+num+" ] ?")) {
		return false;
	} 
}

function etd_edit(id,ap_num,po_spare,special)
{

	$.ajax({
		url: 'po.php?PHP_action=po_etd_edit',
		type: 'GET',
		data: {
			PHP_ap_num: ap_num,
			PHP_po_spare: po_spare,
			PHP_rev_etd: $("#PHP_rev_etd"+id).val(),
			PHP_special : special
		},
		error: function(xhr) {
			alert('Ajax request 發生錯誤'+xhr);
		},
		success: function(response) {
			
			$('#etd_text'+id).text($('#PHP_po_eta').val());
			$('#rev_etd_text'+id).text($('#PHP_rev_etd'+id).val());
			$('#rev_etd_text'+id).css('display','inline');;
			$('#add_img'+id).css('display','inline');
			$('#rev_etd_div'+id).css('display','none');
		}
	});
}

function tblresize() {
	var dh = 110;
	var dw = 60;
	var hh = tblShow.offsetHeight + dh;
	if ( hh > screen.height - dh )
	hh = screen.height - dh ;
	if (tblShow.offsetWidth) window.resizeTo( tblShow.offsetWidth + dw , hh );
	self.focus();
}

</script>
{/literal}
</head>
{$goback}
{if $goback || $resize}
<body topmargin="10" onLoad="tblresize();"/>
{else}
<body>
{/if}
<table cellspacing=1 cellpadding=4 id="tblShow">
	<tr>
		<td>
			<table cellspacing=1 cellpadding=4 cols=1 width=100% bgcolor=#003300>
				<tr>
					{if $ap.status == 6 && $back_str && $add_flag}
					<td class=gry9 align=center><small><input type='image' src="images/cancel.gif"   onclick=del_po('{$ap.ap_num}','{$back_str}','{$ap.po_num}')></small></td>{/if}
					<td class="ylw10" align=center>{$ap.statuss}</td>
					<td class="des" align=center width=180 height=28> <span class=ssign>{if $ap.special >= 2}<b>Pre-Purchase</b>{else}{if $ap.special == 0}<b>Purchase Order </b>{else}<b>Extra Purchase</b>{/if}{/if} </td>
					<td class="des" align=center width=180 height=28> P / O  # <span class=ylw10><b> {$ap.po_num}</b></span> </td>
					<td class="des" align=center>
					{if ($ap.status == 8 || $ap.status ==10) && $edit_flag && $rcv_mk <> 1}
						<a href="javascript:aply_revise('{$ap.ap_num}','{$back_str}','3','{$ap.id}','{$ap.revise}','{$ap.po_num}')" value='revise' style='cursor:pointer'>
						<img src='./images/revise21.jpg' border=0 ALT="REVISE"></a>
					{/if} 
					{if $ap.status == 12 && $edit_flag && $rcv_mk <> 1}
						<a href="javascript:del_po_apv('{$ap.ap_num}','{$back_str}','{$ap.po_num}')" value='revise' style='cursor:pointer'>
						<img src="images/cancel.gif" border=0 ALT="DELETE"></a>
					{/if}
					{if $ap.status == 12 && $admin_flag}
					<span class=ssign><b> [ <a style="color:yellow" href="po.php?PHP_action=reopen&PHP_aply_num={$ap.ap_num}&PHP_po_id={$ap.id}" title="REOPEN" onclick="return rechk('{$ap.ap_num}');">REOPEN</a> ] </b></span>
					{/if}
					</td>
					<td class="ylw10" align=center height=28> {if $ap.revise}<span class=sign_b>Version : </span> <b>{$ap.revise}</b>{else}&nbsp;{/if} </td>
				</tr>
			</table>

			<table border=1 cellpadding=4 cellspacing=0 cols=1 width=900 id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
				<tr bgcolor=#ffffff> 
					<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
					<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
				</tr>
			</table>

			<table border=0 cellspacing=0 cellpadding=0 width="900" bgcolor=#FFFFFF>
				<tr height=40>
					<td class="frnt" align=left width=280 height=28>
						<b> PI : 
							<span id="pi_view">
								<font color="#666666" id="pi_v_font">{$ap.pi_num}</font> 
								<img id="pi_b_edit" src="images/button_edit.png" alt="Edit PI#" border=0 valign="bottom" style="cursor:pointer">
							</span>
							<span id="pi_edit" style="display:none;">
								<input type="text" size="14" id="PHP_pi" name="PHP_pi" class="select" value="{$ap.pi_num}">
								<input type="hidden" size="14" id="po_num" name="po_num" class="select" value="{$ap.po_num}">
								<input id="pi_b_update" type=button value="[ UPDATE ]" title="UPDATE" class="select_e" width="50"  style="cursor:pointer">
							</span>
						</b>
					</td>
					<td class="frnt" align=center width=180 height=28>  <b> NOTE : <font color=blue>{$ap.ann_num}</font></b> </td>
					<td class="frnt" align=left height=28>  <b> SHIP BY : {$ap.ship_way} ON : {$ap.ship_date}</b> </td>

					{if $ap.status == 12}
					<td class="frnt" align=right width=100><b> Inside : </b>
						<a href="po.php?PHP_action=pa_print&PHP_aply_num={$ap.ap_num}">
						<img src="./images/print9.gif" border=0 alt="PDF: SAVE/PRINT"> <!--onclick=special_chk({$ap.special})--></a>
					</td>
					<td class="frnt" align=right width=100> <b> Outside : </b>
					<a href="po.php?PHP_action=po_print_doc&PHP_aply_num={$ap.ap_num}" >
						<img src="./images/print9.gif" border=0 alt="PDF: SAVE/PRINT"></a>			
					</td>
					{/if}			
				</tr>
			</table>

			<hr SIZE=2 WIDTH=900>
			<table border=1 cellspacing=0 cellpadding=0 width="900" bgcolor=#FFFFFF>
				<tr>
					<td>
						<table border=0 cellspacing=1 cellpadding=3 width="100%" bgcolor=#FFFFFF>
							<tr>
								<td class=snvy width=100 align=right ><b>Supplier : </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.s_name}</b></td>
								<td class=snvy width=100 align=right><b>Dept : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{if $ap.dept <> $ap.open_dept && $ap.open_dept <> ''}{$ap.open_dept}{else}{$ap.dept}{/if}</b></td>
								<td class=snvy width=100 align=right ><b>Currency: </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.currency}</b></td>
							</tr>
							<tr>
								<td class=snvy align=right><b>Payment : </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=3><b>&nbsp;{$ap.dm_way}</b></td>
								<td class=snvy align=right><b>Source area : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.country}</b></td>
							<tr>
								
							<tr>
								<td class=snvy align=right><b>Send TO : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=3><b>&nbsp;{$ap.ship_name}</b></td>
								<td class=snvy align=right><b>Attn. TO : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.ship_attn}</b></td>
							</tr>
							<tr>
								<td class=snvy align=right><b>TEL: </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=2><b>&nbsp;{$ap.ship_tel}</b></td>
								<td class=snvy align=right ><b>FAX : </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=2><b>&nbsp;{$ap.ship_fax}</b></td>
							</tr>
							<tr>
								<td class=snvy align=right><b>Addr: </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=6><b>&nbsp;{$ap.ship_addr}</b></td>
							</tr>
							
							{if $ap.finl_dist}
							<tr><td colspan=8><hr SIZE=1 WIDTH=99%></td></tr>				
							<tr>
								<td class=snvy align=right><b>Final Dist. : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=3><b>&nbsp;{$ap.finl_name}</b></td>
								<td class=snvy align=right><b>Attn. TO : </b></td>			
								<td class=frnt align=left bgcolor=#E7E6E6><b>&nbsp;{$ap.finl_attn}</b></td>

							</tr>
							<tr>
								<td class=snvy align=right><b>Rcver TEL: </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=2><b>&nbsp;{$ap.finl_tel}</b></td>
								<td class=snvy align=right><b>Rcver FAX : </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=2><b>&nbsp;{$ap.finl_fax}</b></td>
							</tr>
							<tr>
								<td class=snvy align=right><b>Rcver Addr: </b></td>
								<td class=frnt align=left bgcolor=#E7E6E6 colspan=6><b>&nbsp;{$ap.finl_addr}</b></td>
							</tr>	
							{/if}	
						</table>
					</td>
				</tr>
			</table>
			
			<hr SIZE=2 WIDTH=900>

			<table border="1" cellspacing=0 cellpadding=2 width=900 id="table2">	
				<tr bgcolor="#003333" height=28>
					<td class=back align="center"><b>Order #</b></td>		
					<td width="90" class=back align="center"><b>Name</b></td>
					<td width="160" class=back align="center"><b>Color / Cat.</b></td>
					<td width="70"  class=back align="center"><b>Loss(%)</b></td>
					<td width="100" class=back align="center"><b>Q'ty</b></td>		
					<td width="150"  class=back align="center"><b>Price</b></td>
					<td width="80" class=back align="center"><b>Amount</b></td>
					<td width="100" class=back align="center"><b>Orig-ETD</b></td>
					<td width="100" class=back align="center"><b>Revise-ETD</b></td>
				</tr>
				{section name=SEC loop=$ap_det2} 
				<tr onMouseOver="bgColor='#FCF4A4'" onMouseOut="bgColor='#ffffff'">
					<td align="left" nowrap>
					{section name=AP loop=$ap_det2[SEC].orders}
					<a href="javascript:po_bom_view('{$ap_det2[SEC].orders[AP]}','{$ap.po_num}')" value='ord_out' style='cursor:pointer'>{$ap_det2[SEC].orders[AP]}</a><br>
					{/section}
					</td>
					<td align="left" nowrap>
						<a href="javascript:{if $ap_det2[SEC].mat_cat == 'l'}Show_fab{else}Show_acc{/if}('{$ap_det2[SEC].mat_code}')" value='ord_out' style='cursor:pointer' title='{$ap_det2[SEC].mat_code}'>{$ap_det2[SEC].mat_name}</a>
					</td>
					<td align="left">{$ap_det2[SEC].color}&nbsp;</td>
					<td align="right">{$ap_det2[SEC].range} %</td>
					<td align="right">{$ap_det2[SEC].po_qty|number_format:"2f"}&nbsp;{$ap_det2[SEC].po_unit}</td>		
					<td align="right">{$ap.fob}&nbsp;{$ap.fob_area}<br>{$ap_det2[SEC].prics|number_format:"5f"}&nbsp;/&nbsp;{$ap_det2[SEC].prc_unit}</td>
					<td align="right">{$ap_det2[SEC].amount|number_format:"2f"}</td>
					<input type="hidden" name="PHP_po_eta" id="PHP_po_eta" value="{if $ap_det2[SEC].po_eta == '0000-00-00'}{$ap_det2[SEC].eta}{else}{$ap_det2[SEC].po_eta}{/if}">
					<!--<input type="hidden" name="PHP_rev_eta" id="PHP_rev_eta" value="{if $ap_det2[SEC].rev_eta == '0000-00-00'}{$ap_det2[SEC].po_eta}{else}{$ap_det2[SEC].rev_eta}{/if}">-->
					<td align="center" nowrap>
						<span id="etd_text{$ap_det2[SEC].id}">{if $ap_det2[SEC].po_eta == '0000-00-00'}{$ap_det2[SEC].eta}{else}{$ap_det2[SEC].po_eta}{/if}</span>
						{if $add_flag}
						<!--<span id="add_img{$ap_det2[SEC].id}" style="cursor:hand" onClick="document.getElementById('etd_text{$ap_det2[SEC].id}').style.display='none';this.style.display='none';document.getElementById('etd_div{$ap_det2[SEC].id}').style.display='inline'">
							&nbsp;&nbsp;<img src="images/Add.gif" alt="Edit" border=0 valign="bottom" style="display:none">
						</span>-->
						<div id="etd_div{$ap_det2[SEC].id}" style="display:none;">
							<input type="text" size="8" id="PHP_etd{$ap_det2[SEC].id}" class="select" value="{if $ap_det2[SEC].po_eta == '0000-00-00'}{$ap_det2[SEC].eta}{else}{$ap_det2[SEC].po_eta}{/if}">
							<!--<input type=button onClick="etd_edit('{$ap_det2[SEC].id}','{$ap.ap_num}','{$ap_det2[SEC].po_spare}',0)" value="update" class=select_e style="cursor:pointer">&nbsp;-->
						</div>
						{literal}
						<script type="text/javascript">Calendar.setup({inputField:"PHP_etd{/literal}{$ap_det2[SEC].id}{literal}",button:"f_trigger_c",ifFormat:"%Y-%m-%d"});</script>
						{/literal}
						{/if}
					</td>
					
					<td align="center" nowrap>
						<span id="rev_etd_text{$ap_det2[SEC].id}">{if $ap_det2[SEC].rev_eta == '0000-00-00'}{$ap_det2[SEC].po_eta}{else}{$ap_det2[SEC].rev_eta}{/if}</span>
						{if $add_flag}
						<span id="add_img{$ap_det2[SEC].id}" style="cursor:hand" onClick="document.getElementById('rev_etd_text{$ap_det2[SEC].id}').style.display='none';this.style.display='none';document.getElementById('rev_etd_div{$ap_det2[SEC].id}').style.display='inline'">
							&nbsp;&nbsp;<img src="images/Add.gif" alt="Edit" border=0 valign="bottom" style="display:">
						</span>
						<div id="rev_etd_div{$ap_det2[SEC].id}" style="display:none;">
							<input type="text" size="8" id="PHP_rev_etd{$ap_det2[SEC].id}" class="select" value="{if $ap_det2[SEC].rev_eta == '0000-00-00'}{$ap_det2[SEC].po_eta}{else}{$ap_det2[SEC].rev_eta}{/if}">
							<input type=button onClick="etd_edit('{$ap_det2[SEC].id}','{$ap.ap_num}','{$ap_det2[SEC].po_spare}',0)" value="update" class=select_e style="cursor:pointer">&nbsp;
						</div>
						{literal}
						<script type="text/javascript">Calendar.setup({inputField:"PHP_rev_etd{/literal}{$ap_det2[SEC].id}{literal}",button:"f_trigger_c",ifFormat:"%Y-%m-%d"});</script>
						{/literal}
						{/if}
					</td>
				</tr>	
				{if $ap_det2[SEC].ship_rmk}
				<tr>
					<td colspan=9 align="left"> <B>Remark : </B>{$ap_det2[SEC].ship_rmk} &nbsp;</td>
				</tr>
				{/if}
				{/section}


				{section name=SEC loop=$ap_oth_cost}	
				<tr bgColor='#ffffff'>	
					<td align="left" colspan=4>
							&nbsp;&nbsp; {$ap_oth_cost[SEC].item}			
					</td>	
					<td align="right" colspan=4>{$ap.currency}${$ap_oth_cost[SEC].cost|number_format:"2f"}</td>		
					<td align="center">&nbsp;</td>
				</tr>	
				{/section}
				<tr bgColor='#ffffff'>	
					<td align="left" colspan=4><b>&nbsp;&nbsp;Total</b></td>
					<td align="right"><b>{$ap.ttl_qty|number_format:"2f"}</b></td>
					<td align="right" colspan=2><b>{$ap.currency}${$ap.po_total|number_format:"2f"}</b></td>		
					<td align="center" colspan=2>&nbsp;</td>
				</tr>
				<tr bgColor='#ffffff'>	
					<td align="left" colspan=4><b>&nbsp;&nbsp;Deal Amount</b></td>	
					<td align="right" colspan=3><b>{$ap.currency}${$ap.dear|number_format:"2f"}</b></td>		
					<td align="center" colspan=2>&nbsp;</td>
				</tr>	
			</table>

			<table border="0" cellspacing=0 cellpadding=2 width=900>	
				<tr height=28>
					<td align="Left"><b>&nbsp;Acceptable Tolerance : {if $ap.toler == '0|0'}0{else} + {$ap.toleri} % {if $ap.tolern != '0'}~ - {$ap.tolern} % {/if}{/if}</b></td>
				</tr>
			</table>

			<hr SIZE=2 WIDTH=900>
				
			{if $apply_log}  
			<table border=1 cellspacing=0 cellpadding=0 width=900 align=center id='mater_table'>
				<tr bgcolor=#bbbbbb height=25>
					<td colspan=5 align=center class=nvy9><b>Remark Records</b></td>
				</tr>
				<tr bgcolor=#666666 height=25>
					<td width=80 class=w10 align=center>Date</td>
					<td width=80 class=w10 align=center>Item</td>
					<td width=300 class=w10 align=center>History records</td>
					<td width=80 class=w10 align=center>by</td>
					{if $add_flag && $ap.status != 12 && $ap.status >= 0 }
					<td width=20 class=w10 align=center>&nbsp;</td>
					{/if}
				</tr>
				{section name=SEC loop=$apply_log}
				<tr bgcolor=#eeeeee >
					<td class=gry9 align=center><small>{$apply_log[SEC].k_date}</small></td>
					<td class=gry9 align=left>{$apply_log[SEC].item}</td>
					<td class=gry9 align=left>{$apply_log[SEC].des}</td>
					<td class=gry9 align=center>{$apply_log[SEC].user}</td>
					{if $add_flag && $ap.status != 12 && $ap.status >= 0 }
					<td align=center>
						<input type='image' src="images/del.png"   onclick=cfm_ajx('{$apply_log[SEC].id}',this)>	
					</td>
					{/if}
				</tr>
				{/section}
			</table>
			{/if}   	
			
			<table width=900 border=1 cellspacing=1 cellpadding=1>
				<tr bgcolor=#EACEBE height=25>	 
					<td width=70 align=center><b>Download</b></td>	
					<td width=250 align=center><b>File name</b></td>
					<td width=300 align=center><b>Descript</b></td>
					<td width=20 align=center><b>Del</b></td>
				</tr>
				 {if $po_file[0].id}
					 {section name=SEC loop=$po_file}
				<tr>	
					<td align=center valign=top>
					<a href="download.php?fname={$po_file[SEC].file_name}&fdir=pi_file" title="{$po_file[SEC].file_name}" target="_blank"><img src='./images/file2.gif' border=0 ALT="download pattern"></a>
					</td>  	
					<td class=snvy>{$po_file[SEC].file_name}</td>
					<td class=snvy>{$po_file[SEC].file_des}</td>
					<td class=snvy align="center">&nbsp;{if $add_flag}<input type='image' src="images/del.png" onClick="del_file('{$po_ship.id}',{$po_file[SEC].id},'{$po_file[SEC].file_name}');">{/if}</td>
				</tr>
				   {/section}
				 {/if}
			   
				<tr>
					<td colspan=4>
					<form method=POST name=pattn enctype="multipart/form-data">
					<input type="hidden" name="PHP_action" value="upload_file">
						<input type="hidden" name="PHP_ap_num" value="{$ap.ap_num}">
						<input type="hidden" name="max_size" value="100000">
						<input type='file' name='PHP_pi_file' size=20 class=select>&nbsp;&nbsp;
						Descript : &nbsp;
						<input type='text' name='PHP_desp' size=40 class=select>&nbsp;&nbsp;
						<input type='submit' value='upload'>
					</form>
					</td>
				</tr>
			</table>
			<br>
			<table border="0" cellspacing=0 cellpadding=2 width=900 id="table2">	
				<tr>
					<td width="100"  class=snvy align="Right">Approval : </td>
					<td width="170"  class=frnt align="left"><small>&nbsp;{if $ap.po_apv_user}<a href="javascript:message_out('{$ap.po_apv_user_id}')" style="cursor:pointer">{$ap.po_apv_user}</a>&nbsp;/&nbsp;{$ap.po_apv_date}{else}NO{/if}</small></td>
					<td width="100"  class=snvy align="Right">Confirm : </td>
					<td width="170"  class=frnt align="left"><small>&nbsp;{if $ap.po_cfm_user}<a href="javascript:message_out('{$ap.po_cfm_user_id}')" style="cursor:pointer">{$ap.po_cfm_user}</a>&nbsp;/&nbsp;{$ap.po_cfm_date}{else}NO{/if}</small></td>

					<td width="140" class=snvy align="Right">Submit : </td>
					<td width="120"  class=frnt align="left"><small>&nbsp;{if $ap.po_sub_date > '0000-00-00'}{$ap.po_sub_date}{else}NO{/if}</small></td>
					<td width="100"  class=snvy align="left">Apply by : </td>
					<td width="170"  class=frnt align="left"><small><a href="javascript:message_out('{$ap.po_user_id}')" style="cursor:pointer">{$ap.po_sub_user}</a>&nbsp;/&nbsp;{$ap.po_sub_date}</small></td>

				</tr>
			</table> 
			{if $add_flag && $ap.status != 12 && $ap.status >= 0}
			<!---------- sample logs form   -->
			<table border=1 cellspacing=0 cellpadding=0 width=900 align=center>
			<form method=POST name=smpl_logs>
				<tr bgcolor=#bbbbbb height=25>
					<td colspan=3 align=center class=nvy9><b>Adding  Remark</b></td>
				</tr>
				<tr bgcolor=#666666 height=25>
					<td width=70 class=w10 align=center>Item</td>
					<td width=450 class=w10 align=center>Remark</td>
					<td width=70 class=w10 align=center>&nbsp;</td>
				</tr>
				<tr bgcolor=#eeeeee >
					<td class=gry9 align=center>{$rmk_item}</td>
					<td class=gry9 align=left>
						<textarea name="PHP_des" rows=2 cols=100 class=select onBlur=check(this)>{$smpl_log.des}</textarea>
						<BR><SMALL>DOCUMENT : INSIDE ; Remark,Packing : OUTSIDE</SMALL>
					</td>
					<td class=ylw9 align=center valign=center>
					<input type=submit value="save" class=select_e style="cursor:pointer; width=55; height=35" onClick=this.width=0;></td>
					<input type="hidden" name="PHP_action" value="do_apply_logs_add">
					<input type="hidden" name="PHP_po_type" value="pp">
					<input type="hidden" name="PHP_back_str" value="{$back_str}">
					<input type="hidden" name="PHP_aply_num" value="{$ap.ap_num}">
					<input type="hidden" name="PHP_id" value="{$ap.id}">
				</tr>
			</form>
			</table>
			<br>
			{/if}

			<hr SIZE=2 WIDTH=900>
			<table border=0 cellspacing=0 cellpadding=0 cols=2 width=900>
				{if $goback}
				<tr>
					<td class="back" align=center> 
					<input type="button" value=" <<  back "  onClick="window.history.go(-1);" class=select_e style="width:100%; cursor:pointer" >
					</td>
				</tr>
				{/if}
				<tr>
					{if $back_str}
					<td valign=top width=100>
						<input type=button onClick="window.location.href='{$PHP_SELF}{$back_str}'" value=" << back " class=select_e style="cursor:pointer; width=99"></form>
					</td>
					{/if} 

					{if $edit_flag && ($ap.status < 8 || $ap.status == 13) && $ap.status >= 0 && $ap.exc_check == 0}
					<td>
					<form METHOD="POST" name="apply_add" action="{$PHP_SELF}">
						<input type="hidden" name="PHP_action" value="apply_pp_edit">
						<input type="hidden" name="PHP_id" value="{$ap.id}">
						<input type="hidden" name="PHP_aply_num" value="{$ap.ap_num}">
						<input type="hidden" name="PHP_po_num" value="{$ap.po_num}">
						<input type="hidden" name="PHP_back_str" value="{$back_str}">
						<input type=submit value="[ EDIT ]" class=select_e style="cursor:pointer; width=90%"></form>		
					</form>
					</td>
					{/if}
					{if $edit_flag && ($ap.status < 8 || $ap.status == 13) && $ap.status >= 0 && $ap.exc_check == 1 && $ap.exc_status == 4}
					<td>
					<form METHOD="POST" name="apply_add" action="{$PHP_SELF}">
						<input type="hidden" name="PHP_action" value="do_po_submit">
						<input type="hidden" name="PHP_id" value="{$ap.id}">
						<input type="hidden" name="PHP_aply_num" value="{$ap.ap_num}">
							<input type="hidden" name="PHP_po_num" value="{$ap.po_num}">
						<input type="hidden" name="PHP_back_str" value="{$back_str}">
						<input type=submit value="[ SUBMIT ]" class=select_e style="cursor:pointer; width=90%"></form>		
					</form>
					</td>
					{/if}
					{if $edit_flag && $ap.status == 12}
					<td align=right>
					<form METHOD="POST" name="apply_add" action="{$PHP_SELF}">
						<input type="hidden" name="PHP_action" value="po_ship_rmk">
						<input type="hidden" name="PHP_id" value="{$ap.id}">
						<input type="hidden" name="PHP_aply_num" value="{$ap.ap_num}">
							<input type="hidden" name="PHP_po_num" value="{$ap.po_num}">
						<input type="hidden" name="PHP_back_str" value="{$back_str}">
						<input type=submit value="[ SHIP REMARK ]" class=select_e style="cursor:pointer; width=40%"></form>		
					</form>
					</td>
					{/if}		
				</tr>
			</table>
		</td>
	</tr>
</table> 
<!--------- footer ---------->
{include file="footer.html"}