<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM System [ BOM for Purchase Order ] ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script language="javascript" src="./js/open_detial.js"></script>
<script language="javascript">

function show_tw_rcvd_det(bom_id,ord_num)
{
	var url ="tw_receive.php?PHP_action=get_rcv_det&PHP_bom_id="+bom_id+"&PHP_ord_num="+ord_num;
	var nm = 'rcvdpo';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500,top=50, left=100');
}

function show_rcvd_det(bom_id,ord_num)
{
	var url ="receive.php?PHP_action=rev_po_det&PHP_bom_id="+bom_id+"&PHP_ord_num="+ord_num;
	var nm = 'rcvdpo';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500,top=50, left=100');
}

function show_pre_apb_det(bom_id,ord_num)
{
	var url ="apb.php?PHP_action=rev_bom_pre_apb_det&PHP_bom_id="+bom_id+"&PHP_ord_num="+ord_num;
	var nm = 'rcvdpo';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500,top=50, left=100');
}

function show_apb_det(bom_id,ord_num)
{
	var url ="apb.php?PHP_action=rcv_bom_apb_det&PHP_bom_id="+bom_id+"&PHP_ord_num="+ord_num;
	var nm = 'rcvdpo';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500,top=50, left=100');
}

function ship_show(id,special,mat,po_num,unit)
{
	var url ="po_ship.php?PHP_action=get_ship_det&PHP_po_id="+id+"&PHP_special="+special+"&PHP_mat="+mat+"&PHP_po_num="+po_num+"&PHP_unit="+unit; 
	var nm = 'shippo';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=500,top=50, left=100');
}

function show_rcv(rcv_num) {
	var url ="receive.php?PHP_action=rcvd_view&PHP_rcv_num="+rcv_num+"&PHP_resize=1";
	var nm = 'order';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=850,height=600 top=30, left=100');
}
</script>
</head>
<body>
{/literal}

<table cellspacing=1 cellpadding=4 cols=2 width="100%" bgcolor=#2E5E73>
	<tr>
		<td class="des" align=center height=28 width=170 nowrap> <b>Order / BOM : </b> <span class=ylw10 nowrap><b><a href="javascript:show_order_rec('','{$wi.wi_num}')" style="color:#ffff66;">{$wi.wi_num}</a></b></span></td>
		<td class="des" align=center height=28 >[ <span class=ylw10><b>Purchase Status</span> </b> ]</td>
		<td class="des" align=center height=28 width=170 nowrap> </td>
	</tr>
</table>

<table border=1 cellpadding=4 cellspacing=0 cols=1 width="100%" id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>

<table border=0 cellspacing=1 cellpadding=1 width="100%" bgcolor=#FFFFFF>
	<tr>
		<td colspan=6 class=grn10 align=left><b>&nbsp;&nbsp;&nbsp;{if $order.last_updator}Last update : {$order.last_updator}<small> [ {$order.last_update} ]</small>{/if}</b></td>
		<td colspan=5 class=frnt align=right><b>currency : US$&nbsp;&nbsp;&nbsp;</b></td>
	</tr>
	<tr>
		<td colspan=11 class=frnt align=center><hr size=2 width=98%></td>
	</tr>
	<tr>
		<td></td>
		<td rowspan="5" align=right width=130 ><img src="{$wi.pic_url}" height="110" ></td>
		<td class=snvy align=right width=70 nowrap><b>style No. :</b></td>
		<td class=bgdy align=left width=120 bgcolor=#dddddd><b>&nbsp;{$order.style_num}</b></td>
		<td class=snvy align=right width=80 nowrap><b>Customer :</b></td>
		<td class=bgdy align=left width=120 bgcolor=#dddddd><b>&nbsp;{$order.cust}</b></td>
		<td class=snvy align=right width=100 nowrap><b>customer ref. :</b></td>
		<td class=bgdy align=left width=120 bgcolor=#dddddd><b>&nbsp;<small>{$order.ref}</small></b></td>
		<td class=snvy align=right width=60 nowrap><b>Team :</b></td>
		<td class=bgdy align=left width=80 bgcolor=#dddddd><b>&nbsp;{$order.dept}</b></td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td class=snvy align=right nowrap><b>factory :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.factory}</b></td>
		<td class=snvy align=right nowrap><b>style type :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.style}</b></td>
		<td class=snvy align=right nowrap><b>Q'ty :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.qty|number_format}&nbsp;{$order.unit}</b></td>
		<td class=snvy align=right nowrap><b>SU :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.f_su}</b></td>
		<td></td>
	</tr>
	<tr>
		<td></td>
		<td class=snvy align=right nowrap><b>FOB @ :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;$ {$order.uprice}</b></td>
		<td class=snvy align=right nowrap><b>Quota Cat. :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.quota}</b></td>
		<td class=snvy align=right nowrap><b>smpl ord No. :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><a href="javascript:smpl_out('{$order.smpl_ord}')" value='ord_out' style='cursor:pointer'><b>&nbsp;{$order.smpl_ord}</b></a></td>
		<td class=snvy align=right nowrap><b>Size :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.size}</b></td>
		<td></td>
	</tr> 
	<tr>
		<td align=center class=frnt>&nbsp;</td>
		<td colspan=11 align=center class=frnt><hr size=2 width=98%></td>
		<td class=frnt align=center>&nbsp;</td>
	</tr>
	<tr>
		<td></td>
		<td class=snvy align=right nowrap><b>ETD :</b></td>
		<td class=b10 align=left nowrap bgcolor=#dddddd><b>&nbsp;{$order.etd}</b></td>
		<td class=snvy align=right nowrap><b>ETP. :</b></td>
		<td class=b10 align=left nowrap bgcolor=#dddddd><b>&nbsp;{$order.etp}</b></td>
		<td class=snvy align=right nowrap><b>est. Lead Time :</b></td>
		<td class=grn10 align=left nowrap bgcolor=#dddddd><b>&nbsp;{$lead_time} days</b></td>
		<td class=snvy align=right nowrap><b>calc. IE :</b></td>
		<td class=bgdy align=left bgcolor=#dddddd><b>&nbsp;{$order.ie1}</b></td> 
		<td></td>
	</tr>
	<tr>
		<td colspan=11 class=frnt align=center><hr size=2 width=98%></td>
	</tr>
</table>

{if $dis_lots}
<br>
<table width="100%" border=1 cellspacing=0 cellpadding=1>
	<!------- 物料預先採購 Title --------- -->
	<tr bgcolor=#D5D5BE height="30">
		<td colspan=11 class=b9 align=center><b>前版本己採購主料記錄</b></td>
	</tr>	
	<tr bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Fabric #</b></td>	
		<td class=b9 align=center><b>Placement</b></td> 
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>PO #</b></td>
		<td class=b9 align=center><b>Purchas Q'TY</b></td>
	</tr>
	{section name=BOM loop=$dis_lots} 
	{if $dis_lots[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}
		<td class=b9 align=left>&nbsp;<a href="javascript:Show_fab('{$dis_lots[BOM].lots_code}')" value='ord_out' style='cursor:pointer'>{$dis_lots[BOM].lots_code}</a></td>
		<td class=b9 align=left>&nbsp;{$dis_lots[BOM].use_for}</td>
		<td class=b9 align=left>&nbsp;{$dis_lots[BOM].color}</td>
		<td class=b9 align=right>&nbsp;{$dis_lots[BOM].est_1}{$dis_lots[BOM].unit}</td>
		<td class=b9 align=right>&nbsp;{$dis_lots[BOM].bom_qty}{$dis_lots[BOM].unit}</td>
		<td class=snvy align=center>&nbsp;<a href="javascript:po_show('{$dis_lots[BOM].ap_num}')">{$dis_lots[BOM].po_num}</a></td>
		<td class=snvy align=right>&nbsp;{$dis_lots[BOM].po_qty}{$dis_lots[BOM].po_unit}</td>
	</tr>
	{/section}
</table>
{/if}

{if $dis_acc}
<br>
<table width="100%" border=1 cellspacing=0 cellpadding=1>
	<!------- 物料預先採購 Title ----------->
	<tr bgcolor=#D5D5BE height="30">
		<td colspan=11 class=b9 align=center><b>前版本己採購副料記錄</b></td>
	</tr>	
	<tr bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Accessory #</b></td>	
		<td class=b9 align=center><b>Placement</b></td> 
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>PO #</b></td>
		<td class=b9 align=center><b>Purchas Q'TY</b></td>
	</tr>
	{section name=BOM loop=$dis_acc} 
	{if $dis_acc[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b9 align=left>&nbsp;<a href="javascript:Show_acc('{$dis_acc[BOM].acc_code}')" value='ord_out' style='cursor:pointer'>{$dis_acc[BOM].acc_code}</a></td>
		<td class=b9 align=left>&nbsp;{$dis_acc[BOM].use_for}</td>
		<td class=b9 align=left>&nbsp;{$dis_acc[BOM].color}</td>
		<td class=b9 align=right>&nbsp;{$dis_acc[BOM].est_1}{$dis_acc[BOM].unit}</td>
		<td class=b9 align=right>&nbsp;{$dis_acc[BOM].bom_qty}{$dis_acc[BOM].unit}</td>
		<td class=snvy align=center>&nbsp;<a href="javascript:po_show('{$dis_acc[BOM].ap_num}')">{$dis_acc[BOM].po_num}</a></td>
		<td class=snvy align=right>&nbsp;{$dis_acc[BOM].po_qty}{$dis_acc[BOM].po_unit}</td>
	</tr>
	{/section}
</table>
{/if}

{if $pp_mat}
<br>
<table width="100%" border=1 cellspacing=0 cellpadding=1>
	<!------- 物料預先採購 Title --------- -->
	<tr bgcolor=#FFB4D6 height="30">
		<td colspan=11 class=b9 align=center><b>Pre-Purchase Matrial</b></td>
	</tr>	
	<tr bgcolor=#FFB4D6>
		<td class=b9 align=center><b>Matriel #</b></td>
		<td class=b9 align=center><b>Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Q'TY</b></td>
		<td class=b9 align=center><b>P.O.#</b></td>
	</tr>
	{section name=BOM loop=$pp_mat} 
	<tr onmouseover="bgColor='#D4E0F7'" onmouseout="bgColor='#ffffff'">
		<td class=b9 align=left>&nbsp;<a href="javascript:{if $pp_mat[BOM].mat_cat == 'a'}Show_acc{else}Show_fab{/if}('{$pp_mat[BOM].mat_code}')" value='ord_out' style='cursor:pointer'>{$pp_mat[BOM].mat_code}</a></td>
		<td class=b9 align=left>&nbsp;{$pp_mat[BOM].mat_name}</td>
		<td class=b7 align=left>&nbsp;{$pp_mat[BOM].use_for}</td>
		<td class=b9 align=left>&nbsp;{$pp_mat[BOM].color}</td>
		<td class=snvy align=center>&nbsp;{$pp_mat[BOM].ap_qty}</td>
		<td class=snvy align=center>&nbsp;<a href="javascript:po_show('{$pp_mat[BOM].ap_num}')">{$pp_mat[BOM].po_num}</a></td>
	</tr>
{/section}
</table>
{/if}

<br>
<table width="100%" border=1 cellspacing=0 cellpadding=1>
	<!------- BOM 主料記錄 --------- -->
	{section name=BOM loop=$bom_lots.bom} 
	{if $smarty.section.BOM.index % 16 == 0}
	<tr height="30" bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Fab. Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>Purchased</b></td>
 		<td class=b9 align=center><b>Ship</b></td>
		<td class=b9 align=center><b>Received</b></td>
		<td class=b9 align=center><b>Apb</b></td>
		<td class=b9 align=center><b>Purchased Detail</b></td>
	</tr>
	{/if}				
	{if $bom_lots.bom[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}
		<td class=b7 align=left><small>&nbsp;<a href="javascript:Show_fab('{$bom_lots.bom[BOM].lots_code}')" value='ord_out' style='cursor:pointer' title='{$bom_lots.bom[BOM].lots_code}'>{$bom_lots.bom[BOM].lots_name}</a></small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_lots.bom[BOM].use_for}</small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_lots.bom[BOM].color}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.bom[BOM].est_1|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.bom[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].unit}</small></td>
		{if $bom_lots.bom[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_lots.bom[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_lots.bom[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</span><br>{/if}
				{if $bom_lots.bom[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_lots.bom[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</span>{/if}
			</small>
		</td>
		<td class=snvy align=right><small>{if $bom_lots.bom[BOM].po.ship_qty > 0}&nbsp;{$bom_lots.bom[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}{else}&nbsp;{/if}</small></td>
		
		<!-- 驗收 -->
		<td class=snvy align=right>
			{if $bom_lots.bom[BOM].po.tw_rcv_qty > 0}<small>&nbsp;<a href="javascript:show_tw_rcvd_det('{$bom_lots.bom[BOM].bom_id}','{$wi.wi_num}')" value='order' style='cursor:pointer' title="Taiwan Recevied" class="underline_gray">{$bom_lots.bom[BOM].po.tw_rcv_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $bom_lots.bom[BOM].po.rcv_qty > 0}<small>&nbsp;<a href="javascript:show_rcvd_det('{$bom_lots.bom[BOM].bom_id}','{$wi.wi_num}')" value='order' style='cursor:pointer' title="Factory Recevied" class="underline_black">{$bom_lots.bom[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<!-- 驗收付款 -->
		<td class=snvy align=right>
			{if $bom_lots.bom[BOM].po.pre_apb_qty > 0}<small>&nbsp;<a href="javascript:show_pre_apb_det('{$bom_lots.bom[BOM].bom_id}','{$wi.wi_num}')" value='order' style='cursor:pointer' title="Pre-Account Payable" class="underline_gray">{$bom_lots.bom[BOM].po.pre_apb_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $bom_lots.bom[BOM].po.apb_qty > 0}<small>&nbsp;<a href="javascript:show_apb_det('{$bom_lots.bom[BOM].bom_id}','{$wi.wi_num}')" value='order' style='cursor:pointer' title="Account Payable" class="underline_black">{$bom_lots.bom[BOM].po.apb_qty|number_format:"2f"}&nbsp;{$bom_lots.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<td class=snvy align=left nowrap>
			<small>
			<b>
			&nbsp;
			{section name=SHIP loop=$bom_lots.bom[BOM].po.ship}
			{if $smarty.section.SHIP.index > 0}<br><span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>&nbsp;{/if}
				<a href="javascript:po_show('{$bom_lots.bom[BOM].po.ship[SHIP].ap_num}')">{$bom_lots.bom[BOM].po.ship[SHIP].po_num}</a>
				{if $bom_lots.bom[BOM].po.ship[SHIP].po_num}( {$bom_lots.bom[BOM].po.ship[SHIP].statuss} ) {/if}
				{if $bom_lots.bom[BOM].po.ship[SHIP].special == 1} , <font color="green">Extra</font> {/if}
				{if $bom_lots.bom[BOM].po.ship[SHIP].special >= 2 } , <font color="green">P.P.</font> {/if}				

				{if $bom_lots.bom[BOM].po.ship[SHIP].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$bom_lots.bom[BOM].po.ship[SHIP].ann_num}</font>{/if}					
				{if $bom_lots.bom[BOM].po.ship[SHIP].ship_way}<br>&nbsp;
				<a href="javascript:ship_show('{$bom_lots.bom[BOM].po.ship[SHIP].po_spare}','{$bom_lots.bom[BOM].po.det_special}','{$bom_lots.bom[BOM].lots_code}','{$bom_lots.bom[BOM].po.ship[SHIP].po_num}','{$bom_lots.bom[BOM].po.unit}')">
					<font color=#222>Ship:{$bom_lots.bom[BOM].po.ship[SHIP].ship_date}</font> <img src="images/{$bom_lots.bom[BOM].po.ship[SHIP].ship_way}.png" border=0> {$bom_lots.bom[BOM].po.ship[SHIP].ship_eta}
				</a>
				{/if}			
			{/section}
			</b>
			</small>
		</td>
		{/if}
	</tr>
	{if $bom_lots.bom[BOM].po.ship_rmk}
	<tr>	
		<td class=b9 align=left nowrap>&nbsp;</td>
		<td class=b7 align=left colspan=11><small>&nbsp;{$bom_lots.bom[BOM].po.ship_rmk}</small></td>
	</tr>
	{/if}
	{section name=AP loop=$bom_lots.bom[BOM].spec_ap}
	{if $bom_lots.bom[BOM].spec_ap[AP].ship_rmk}
	<tr>	
		<td class=b9 align=left nowrap>&nbsp;</td>
		<td class=b7 align=left colspan=11><small>&nbsp;{$bom_lots.bom[BOM].spec_ap[AP].ship_rmk}</small></td>
	</tr>
	{/if}
	{/section}
	{/section}


	<!------- BOM 副料記錄 --------- -->
	{section name=BOM loop=$bom_acc.bom} 
	{if $smarty.section.BOM.index % 16 == 0}
	<tr height="30" bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Acc. Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>Purchased</b></td>
		<td class=b9 align=center><b>Ship</b></td>
		<td class=b9 align=center><b>Received</b></td>
		<td class=b9 align=center><b>Apb</b></td>
		<td class=b9 align=center><b>Purchased Detail</b></td>
	</tr>
	{/if}	
	{if $bom_acc.bom[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b7 align=left><small>&nbsp;<a href="javascript:Show_acc('{$bom_acc.bom[BOM].acc_code}')" value='ord_out' style='cursor:pointer' title='{$bom_acc.bom[BOM].acc_code}'>{$bom_acc.bom[BOM].acc_name}</a></small></td>	
		<td class=b7 align=left><small>&nbsp;{$bom_acc.bom[BOM].use_for}</small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_acc.bom[BOM].color}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.bom[BOM].est_1|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.bom[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].unit}</small></td>
		{if $bom_acc.bom[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_acc.bom[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_acc.bom[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</span><br>{/if}
				{if $bom_acc.bom[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_acc.bom[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</span>{/if}
			</small>
		</td>		
		<td class=snvy align=right><small>{if $bom_acc.bom[BOM].po.ship_qty > 0}&nbsp;{$bom_acc.bom[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}{else}&nbsp;{/if}</small></td>

		<!-- 驗收 -->
		<td class=snvy align=right {if $bom_acc.bom[BOM].acc_cat == 1} title="主要副料" bgcolor="FFEBFF"{/if}>
			{if $bom_acc.bom[BOM].po.tw_rcv_qty > 0}<small>&nbsp;<a href="javascript:show_tw_rcvd_det('{$bom_acc.bom[BOM].bom_id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer' title="Taiwan Recevied" class="underline_gray">{$bom_acc.bom[BOM].po.tw_rcv_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $bom_acc.bom[BOM].po.rcv_qty > 0}<small>&nbsp;<a href="javascript:show_rcvd_det('{$bom_acc.bom[BOM].bom_id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer' title="Factory Recevied" class="underline_black">{$bom_acc.bom[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<!-- 驗收付款 -->
		<td class=snvy align=right>
			{if $bom_acc.bom[BOM].po.pre_apb_qty > 0}<small>&nbsp;<a href="javascript:show_pre_apb_det('{$bom_acc.bom[BOM].bom_id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer' title="Pre-Account Payable" class="underline_gray">{$bom_acc.bom[BOM].po.pre_apb_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $bom_acc.bom[BOM].po.apb_qty > 0}<small>&nbsp;<a href="javascript:show_apb_det('{$bom_acc.bom[BOM].bom_id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer' title="Account Payable" class="underline_black">{$bom_acc.bom[BOM].po.apb_qty|number_format:"2f"}&nbsp;{$bom_acc.bom[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<td class=snvy align=left nowrap>
			<small>
			<b>
			&nbsp;
			{section name=SHIP loop=$bom_acc.bom[BOM].po.ship}
			{if $smarty.section.SHIP.index > 0}<br><span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>&nbsp;{/if}
				<a href="javascript:po_show('{$bom_acc.bom[BOM].po.ship[SHIP].ap_num}')">{$bom_acc.bom[BOM].po.ship[SHIP].po_num}</a>
				{if $bom_acc.bom[BOM].po.ship[SHIP].po_num}( {$bom_acc.bom[BOM].po.ship[SHIP].statuss} ) {/if}
				{if $bom_acc.bom[BOM].po.ship[SHIP].special == 1} , <font color="green">Extra</font> {/if}
				{if $bom_acc.bom[BOM].po.ship[SHIP].special >= 2 } , <font color="green">P.P.</font> {/if}				
				{if $bom_acc.bom[BOM].po.ship[SHIP].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$bom_acc.bom[BOM].po.ship[SHIP].ann_num}</font>{/if}					
				{if $bom_acc.bom[BOM].po.ship[SHIP].ship_way}<br>&nbsp;
				<a href="javascript:ship_show('{$bom_acc.bom[BOM].po.ship[SHIP].po_spare}','{$bom_acc.bom[BOM].po.det_special}','{$bom_acc.bom[BOM].acc_code}','{$bom_acc.bom[BOM].po.ship[SHIP].po_num}','{$bom_acc.bom[BOM].po.unit}')">
					<font color=#222>Ship:{$bom_acc.bom[BOM].po.ship[SHIP].ship_date}</font> <img src="images/{$bom_acc.bom[BOM].po.ship[SHIP].ship_way}.png" border=0> {$bom_acc.bom[BOM].po.ship[SHIP].ship_eta}
				</a>
				{/if}			
			{/section}
			</b>
			</small>
		</td>
		{/if}
	</tr>
	{if $bom_acc.bom[BOM].po.ship_rmk}
	<tr>	
		<td class=b9 align=left nowrap>&nbsp;</td>
		<td class=b7 align=left colspan=11><small>&nbsp;{$bom_acc.bom[BOM].po.ship_rmk}</small></td>
	</tr>
	{/if}
	{section name=AP loop=$bom_acc.bom[BOM].spec_ap}
	{if $bom_acc.bom[BOM].spec_ap[AP].ship_rmk}
	<tr>	
		<td class=b9 align=left nowrap>&nbsp;</td>
		<td class=b7 align=left colspan=11><small>&nbsp;{$bom_acc.bom[BOM].spec_ap[AP].ship_rmk}</small></td>
	</tr>
	{/if}
	{/section}
	{/section}	

	{if $ext_mat}

	<!------- 物料補 Title --------- -->
	<tr><td colspan="11" height="9"></td></tr>
	<tr height="30" bgcolor=#D5D5BE>
		<td colspan=11 class=b9 align=center><b>Extra Material</b></td>
	</tr>	
	<tr bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>Purchased</b></td>
		<td class=b9 align=center><b>Ship</b></td>
		<td class=b9 align=center><b>Received</b></td>
		<td class=b9 align=center><b>Apb</b></td>
		<td class=b9 align=center><b>Purchased Detail</b></td>
	</tr>
	{section name=BOM loop=$ext_mat} 
	{if $ext_mat[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}
		<td class=b7 align=left>&nbsp;<small><a href="javascript:{if $ext_mat[BOM].mat_cat == 'a'}Show_acc{else}Show_fab{/if}('{$ext_mat[BOM].mat_code}')" value='ord_out' style='cursor:pointer' title='{$ext_mat[BOM].mat_code}'>{$ext_mat[BOM].mat_name}</a></small></td>
		<td class=b7 align=left>&nbsp;<small>{$ext_mat[BOM].use_for}</small></td>
		<td class=b9 align=left>&nbsp;<small>{$ext_mat[BOM].color}</small></td>
		<td class=snvy align=center>&nbsp;</td>
		<td class=snvy align=right>&nbsp;
			<small>
				{if $ext_mat[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$ext_mat[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$ext_mat[BOM].po.unit}</span><br>{/if}
				{if $ext_mat[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$ext_mat[BOM].po.po_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].po.unit}</span>{/if}
			</small>
		</td>		
		<td class=snvy align=right>&nbsp;<small>{if $ext_mat[BOM].ship_qty}{$ext_mat[BOM].ship_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].unit}{/if}</small></td>
		<td class=snvy align=right>
			<small>
			{if $ext_mat[BOM].tw_rcv_qty > 0}<small>&nbsp;<a href="javascript:show_rcv('{$ext_mat[BOM].tw_rcv}')" value='order' style='cursor:pointer' title="Taiwan Recevied" class="underline_gray">{$ext_mat[BOM].tw_rcv_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $ext_mat[BOM].rcv_qty > 0}<small>&nbsp;<a href="javascript:show_rcv('{$ext_mat[BOM].rcv}')" value='order' style='cursor:pointer' title="Factory Recevied" class="underline_black">{$ext_mat[BOM].rcv_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].unit}</a></small>{else}&nbsp;{/if}
			</small>
		</td>
		<td class=snvy align=right>&nbsp;
			{if $ext_mat[BOM].pre_apb_qty > 0}<small>&nbsp;<a href="javascript:show_apb('{$ext_mat[BOM].pre_apb_rcv_num}','{$ext_mat[BOM].pre_apb_payment}','{$ext_mat[BOM].pre_apb_status}')" value='purchase' style='cursor:pointer' title="Pre-Account Payable" class="underline_gray">{$ext_mat[BOM].pre_apb_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].unit}</a></small>{else}&nbsp;{/if}<br>
			<span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>
			{if $ext_mat[BOM].apb_qty > 0}<small>&nbsp;<a href="javascript:show_apb('{$ext_mat[BOM].apb_rcv_num}','{$ext_mat[BOM].apb_payment}','{$ext_mat[BOM].apb_status}')" value='purchase' style='cursor:pointer' title="Account Payable" class="underline_black">{$ext_mat[BOM].apb_qty|number_format:"2f"}&nbsp;{$ext_mat[BOM].unit}</a></small>{else}&nbsp;{/if}
		</td>
		<td class=b9 align=left>&nbsp;
			<small>
			<b>
			&nbsp;
			{section name=SHIP loop=$ext_mat.bom[BOM].po.ship}
			{if $smarty.section.SHIP.index > 0}<br><span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>&nbsp;{/if}
				<a href="javascript:po_show('{$ext_mat.bom[BOM].po.ship[SHIP].ap_num}')">{$ext_mat.bom[BOM].po.ship[SHIP].po_num}</a>
				{if $ext_mat.bom[BOM].po.ship[SHIP].po_num}( {$ext_mat.bom[BOM].po.ship[SHIP].statuss} ) {/if}
				{if $ext_mat.bom[BOM].po.ship[SHIP].special == 1} , <font color="green">Extra</font> {/if}
				{if $ext_mat.bom[BOM].po.ship[SHIP].special >= 2 } , <font color="green">P.P.</font> {/if}				
				{if $ext_mat.bom[BOM].po.ship[SHIP].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$ext_mat.bom[BOM].po.ship[SHIP].ann_num}</font>{/if}					
				{if $ext_mat.bom[BOM].po.ship[SHIP].ship_way}<br>&nbsp;
				<a href="javascript:ship_show('{$ext_mat.bom[BOM].po.ship[SHIP].po_spare}','{$ext_mat.bom[BOM].po.det_special}','{$ext_mat.bom[BOM].mat_code}','{$ext_mat.bom[BOM].po.ship[SHIP].po_num}','{$ext_mat.bom[BOM].po.unit}')">
					<font color=#222>Ship:{$ext_mat.bom[BOM].po.ship[SHIP].ship_date}</font> <img src="images/{$ext_mat.bom[BOM].po.ship[SHIP].ship_way}.png" border=0> {$ext_mat.bom[BOM].po.ship[SHIP].ship_eta}
				</a>
				{/if}			
			{/section}
			</b>
			</small>		
			<small>
			<b>
			<a href="javascript:po_show('{$ext_mat[BOM].ap_num}')">{$ext_mat[BOM].po_num}</a>
			{if $ext_mat[BOM].po_num}( {$ext_mat[BOM].statuss} ){/if}
			{if $ext_mat[BOM].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$ext_mat[BOM].ann_num}</font>{/if}
			{if $ext_mat[BOM].special >= 2 } , <font color="green">P.P.</font> {/if}
			{if $ext_mat[BOM].ship_way}<br>&nbsp;
						
			<a href="javascript:ship_show('{$ext_mat[BOM].po_spare}','{$ext_mat[BOM].det_special}','{$ext_mat[BOM].mat_code}','{$ext_mat[BOM].po_num}','{$ext_mat[BOM].unit}')">
				<font color=#222>Ship:{$ext_mat[BOM].ship_date}</font> <img src="images/{$ext_mat[BOM].ship_way}.png" border=0> {$ext_mat[BOM].ship_eta}
			</a>
			{/if}			
			</b>
			</small>
		</td>
	</tr>
	{/section}
	{/if}


	{if $bom_lots.fty || $bom_acc.fty}	
	<!------- 主料 bom Title --------- -->
	<tr><td colspan="11" height="9"></td></tr>		
	<tr bgcolor=#D5D5BE height=30>
		<td class=b9 align=center colspan=11><b>Factory Sourcing</b></td>
	</tr>
	<tr bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>Purchased</b></td>
		<td class=b9 align=center><b>Ship</b></td>
		<td class=b9 align=center><b>Received</b></td>
		<td class=b9 align=center><b>Apb</b></td>
		<td class=b9 align=center><b>Purchased Detail</b></td>
	</tr>
	<!------- BOM 主料記錄 --------- -->
	{section name=BOM loop=$bom_lots.fty} 
	{if $bom_lots.fty[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b7 align=left><small>&nbsp;<a href="javascript:Show_fab('{$bom_lots.fty[BOM].lots_code}')" value='ord_out' style='cursor:pointer' title='{$bom_lots.fty[BOM].lots_code}'>{$bom_lots.fty[BOM].lots_name}</a></small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_lots.fty[BOM].use_for}</small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_lots.fty[BOM].color}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.fty[BOM].est_1|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.fty[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].unit}</small></td>
		{if $bom_lots.fty[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_lots.fty[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_lots.fty[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].po.unit}</span><br>{/if}
				{if $bom_lots.fty[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_lots.fty[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].po.unit}</span>{/if}
			</small>
		</td>	
		<td class=snvy align=right>{if $bom_lots.fty[BOM].po.ship_qty > 0}<small>&nbsp;{$bom_lots.fty[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=right>
			{if $bom_lots.fty[BOM].po.tw_rcv_qty > 0}<small><a href="javascript:show_tw_rcvd_det('{$bom_lots.fty[BOM].po.id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer'>&nbsp;{$bom_lots.fty[BOM].po.tw_rcv_qty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			{if $bom_lots.fty[BOM].po.rcv_qty > 0}<small><a href="javascript:show_rcvd_det('{$bom_lots.fty[BOM].po.id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer'>&nbsp;{$bom_lots.fty[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_lots.fty[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<td class=snvy align=left>&nbsp;</td>

		<td class=snvy align=left>
			<small>
			<b>
			&nbsp;
			{section name=SHIP loop=$bom_lots.fty[BOM].po.ship}
			{if $smarty.section.SHIP.index > 0}<br><span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>&nbsp;{/if}
				<a href="javascript:po_show('{$bom_lots.fty[BOM].po.ship[SHIP].ap_num}')">{$bom_lots.fty[BOM].po.ship[SHIP].po_num}</a>
				{if $bom_lots.fty[BOM].po.ship[SHIP].po_num}( {$bom_lots.fty[BOM].po.ship[SHIP].statuss} ) {/if}
				{if $bom_lots.fty[BOM].po.ship[SHIP].special == 1} , <font color="green">Extra</font> {/if}
				{if $bom_lots.fty[BOM].po.ship[SHIP].special >= 2 } , <font color="green">P.P.</font> {/if}				
				{if $bom_lots.fty[BOM].po.ship[SHIP].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$bom_lots.fty[BOM].po.ship[SHIP].ann_num}</font>{/if}					
				{if $bom_lots.fty[BOM].po.ship[SHIP].ship_way}<br>&nbsp;
				<a href="javascript:ship_show('{$bom_lots.fty[BOM].po.ship[SHIP].po_spare}','{$bom_lots.fty[BOM].po.det_special}','{$bom_lots.fty[BOM].lots_code}','{$bom_lots.fty[BOM].po.ship[SHIP].po_num}','{$bom_lots.fty[BOM].po.unit}')">
					<font color=#222>Ship:{$bom_lots.fty[BOM].po.ship[SHIP].ship_date}</font> <img src="images/{$bom_lots.fty[BOM].po.ship[SHIP].ship_way}.png" border=0> {$bom_lots.fty[BOM].po.ship[SHIP].ship_eta}
				</a>
				{/if}			
			{/section}
			</b>
			</small>
		</td>
		{/if}
	</tr>
	{/section}

	{section name=BOM loop=$bom_acc.fty} 
	{if $bom_acc.fty[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b9 align=left nowrap>&nbsp;<a href="javascript:Show_acc('{$bom_acc.fty[BOM].acc_code}')" value='ord_out' style='cursor:pointer'>{$bom_acc.fty[BOM].acc_code}</a></td>
		<td class=b7 align=left><small>&nbsp;{$bom_acc.fty[BOM].acc_name}</small></td>	
		<td class=b7 align=left><small>&nbsp;{$bom_acc.fty[BOM].use_for}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.fty[BOM].est_1|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.fty[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].unit}</small></td>
		{if $bom_acc.fty[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_acc.fty[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_acc.fty[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].po.unit}</span><br>{/if}
				{if $bom_acc.fty[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_acc.fty[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].po.unit}</span>{/if}
			</small>
		</td>
		<td class=snvy align=right>{if $bom_acc.fty[BOM].po.ship_qty > 0}<small>&nbsp;{$bom_acc.fty[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=right>
			{if $bom_acc.fty[BOM].po.tw_rcv_qty > 0}<small><a href="javascript:show_tw_rcvd_det('{$bom_acc.fty[BOM].po.id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer'>&nbsp;{$bom_acc.fty[BOM].po.tw_rcv_qty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].po.unit}</a></small>{else}&nbsp;{/if}<br>
			{if $bom_acc.fty[BOM].po.rcv_qty > 0}<small><a href="javascript:show_rcvd_det('{$bom_acc.fty[BOM].po.id}','{$wi.wi_num}')" value='purchase' style='cursor:pointer'>&nbsp;{$bom_acc.fty[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_acc.fty[BOM].po.unit}</a></small>{else}&nbsp;{/if}
		</td>
		<td class=snvy align=left>&nbsp;</td>

		<td class=snvy align=left>
			<small>
			<b>
			&nbsp;
			{section name=SHIP loop=$bom_acc.fty[BOM].po.ship}
			{if $smarty.section.SHIP.index > 0}<br><span style="BORDER-BOTTOM: #999 1px dashed;line-height:2pt;width:100%;"></span><br>&nbsp;{/if}
				<a href="javascript:po_show('{$bom_acc.fty[BOM].po.ship[SHIP].ap_num}')">{$bom_acc.fty[BOM].po.ship[SHIP].po_num}</a>
				{if $bom_acc.fty[BOM].po.ship[SHIP].po_num}( {$bom_acc.fty[BOM].po.ship[SHIP].statuss} ) {/if}
				{if $bom_acc.fty[BOM].po.ship[SHIP].special == 1} , <font color="green">Extra</font> {/if}
				{if $bom_acc.fty[BOM].po.ship[SHIP].special >= 2 } , <font color="green">P.P.</font> {/if}				
				{if $bom_acc.fty[BOM].po.ship[SHIP].ann_num}&nbsp;&nbsp;&nbsp;<font color=red>{$bom_acc.fty[BOM].po.ship[SHIP].ann_num}</font>{/if}					
				{if $bom_acc.fty[BOM].po.ship[SHIP].ship_way}<br>&nbsp;
				<a href="javascript:ship_show('{$bom_acc.fty[BOM].po.ship[SHIP].po_spare}','{$bom_acc.fty[BOM].po.det_special}','{$bom_acc.fty[BOM].acc_code}','{$bom_acc.fty[BOM].po.ship[SHIP].po_num}','{$bom_acc.fty[BOM].po.unit}')">
					<font color=#222>Ship:{$bom_acc.fty[BOM].po.ship[SHIP].ship_date}</font> <img src="images/{$bom_acc.fty[BOM].po.ship[SHIP].ship_way}.png" border=0> {$bom_acc.fty[BOM].po.ship[SHIP].ship_eta}
				</a>
				{/if}			
			{/section}
			</b>
			</small>
		</td>
	{/if}
	</tr>
	{/section}
	{/if}

	{if $bom_lots.cust || $bom_acc.acc}
	<!------- 主料 bom Title --------- -->
	<tr><td colspan="11" height="9"></td></tr>
	<tr bgcolor=#D5D5BE height=30>
		<td class=b9 align=center colspan=11><b>Customer Support</b></td>
	</tr>
	<tr bgcolor=#D5D5BE>
		<td class=b9 align=center><b>Name</b></td>
		<td class=b9 align=center><b>Placement</b></td>
		<td class=b9 align=center><b>Color/cat.</b></td>
		<td class=b9 align=center><b>Consump.</b></td>
		<td class=b9 align=center><b>BOM Q'TY</b></td>
		<td class=b9 align=center><b>Purchased</b></td>
		<td class=b9 align=center><b>Ship</b></td>
		<td class=b9 align=center><b>Received</b></td>
		<td class=b9 align=center><b>Apb</b></td>
		<td class=b9 align=center><b>Purchased Detail</b></td>
	</tr>
	<!------- BOM 主料記錄 --------- -->
	{section name=BOM loop=$bom_lots.cust} 
	{if $bom_lots.cust[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b7 align=left><small>&nbsp;<a href="javascript:Show_fab('{$bom_lots.cust[BOM].lots_code}')" value='ord_out' style='cursor:pointer' title='{$bom_lots.cust[BOM].lots_code}'>{$bom_lots.cust[BOM].lots_name}</a></small></td>
		<td class=b7 align=left><small>&nbsp;{$bom_lots.cust[BOM].use_for}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.cust[BOM].est_1|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_lots.cust[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].unit}</small></td>
		{if $bom_lots.cust[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_lots.cust[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_lots.cust[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].po.unit}</span><br>{/if}
				{if $bom_lots.cust[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_lots.cust[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].po.unit}</span>{/if}
			</small>
		</td>
		<td class=snvy align=right>{if $bom_lots.cust[BOM].po.ship_qty > 0}<small>&nbsp;{$bom_lots.cust[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=right>{if $bom_lots.cust[BOM].po.rcv_qty > 0}<small>&nbsp;{$bom_lots.cust[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].po.unit}</small>{else}&nbsp;{/if}</td>
		<td class=snvy align=right>{if $bom_lots.cust[BOM].po.apb_qty > 0}<small>&nbsp;{$bom_lots.cust[BOM].po.apb_qty|number_format:"2f"}&nbsp;{$bom_lots.cust[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=left><small>
		<a href="javascript:po_show('{$bom_lots.cust[BOM].ap_mark}')">{$bom_lots.cust[BOM].po_num}</a>
		<!-- STATUS -->
		{if $bom_lots.cust[BOM].po_num}( {$bom_lots.cust[BOM].statuss} ){/if}
		<!-- NOTE -->
		{if $bom_lots.cust[BOM].ann_num}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red><b>{$bom_lots.cust[BOM].ann_num}</b></font><br>{/if}
		<!-- SHIP -->
		{section name=AP loop=$bom_lots.cust[BOM].spec_ap}<br>
		<a href="javascript:po_show('{$bom_lots.cust[BOM].spec_ap[AP].ap_num}')">{$bom_lots.cust[BOM].spec_ap[AP].po_num}</a>
		<!-- STATUS -->
		{if $bom_lots.cust[BOM].spec_ap[AP].po_num}( {$bom_lots.cust[BOM].spec_ap[AP].statuss} ){/if}
		<!-- NOTE -->
		{if $bom_lots.cust[BOM].spec_ap[AP].ann_num}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red><b>{$bom_lots.cust[BOM].spec_ap[AP].ann_num}</font><br><br>{/if}
		{/section}</small>&nbsp;
		</td>
		{/if}
	</tr>
	{/section}
	{section name=BOM loop=$bom_acc.acc} 
	{if $bom_acc.acc[BOM].ln_mk}
	<tr bgColor='#FFD5A8'>
	{else}
	<tr onmouseover="bgColor='#FEFFA8'" onmouseout="bgColor='#ffffff'">
	{/if}	
		<td class=b9 align=left nowrap>&nbsp;<a href="javascript:Show_acc('{$bom_acc.acc[BOM].acc_code}')" value='ord_out' style='cursor:pointer'>{$bom_acc.acc[BOM].acc_code}</a></td>
		<td class=b7 align=left><small>&nbsp;{$bom_acc.acc[BOM].acc_name}</small></td>	
		<td class=b7 align=left><small>&nbsp;{$bom_acc.acc[BOM].use_for}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.acc[BOM].est_1|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].unit}</small></td>
		<td class=snvy align=right><small>&nbsp;{$bom_acc.acc[BOM].bom_qty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].unit}</small></td>
		{if $bom_acc.acc[BOM].ap_mark == 'stock'}
		<td class=snvy colspan=5 align=center><b> = = = STOCK = = = </b></td>
		{else}
		<td class=snvy align=right>&nbsp;
			<small>
				{if $bom_acc.acc[BOM].po.po_uqty > 0}<span style="color:#999;cursor:default;" title="Un APV">{$bom_acc.acc[BOM].po.po_uqty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].po.unit}</span><br>{/if}
				{if $bom_acc.acc[BOM].po.po_qty > 0}<span style="cursor:default;" title="APV">{$bom_acc.acc[BOM].po.po_qty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].po.unit}</span>{/if}
			</small>
		</td>
		<td class=snvy align=right>{if $bom_acc.acc[BOM].po.ship_qty > 0}<small>&nbsp;{$bom_acc.acc[BOM].po.ship_qty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=right>{if $bom_acc.acc[BOM].po.rcv_qty > 0}<small>&nbsp;{$bom_acc.acc[BOM].po.rcv_qty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].po.unit}</small>{else}&nbsp;{/if}</td>
		<td class=snvy align=right>{if $bom_acc.acc[BOM].po.apb_qty > 0}<small>&nbsp;{$bom_acc.acc[BOM].po.apb_qty|number_format:"2f"}&nbsp;{$bom_acc.acc[BOM].po.unit}</small>{else}&nbsp;{/if}</td>

		<td class=snvy align=left><small>
		<a href="javascript:po_show('{$bom_acc.acc[BOM].ap_mark}')">{$bom_acc.acc[BOM].po_num}</a>
		<!-- STATUS -->
		{if $bom_acc.acc[BOM].po_num}( {$bom_acc.acc[BOM].statuss} ){/if}
		<!-- NOTE -->
		{if $bom_acc.acc[BOM].ann_num}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red><b>{$bom_acc.acc[BOM].ann_num}</b></font><br>{/if}
		<!-- SHIP -->
		{section name=AP loop=$bom_acc.acc[BOM].spec_ap}<br>
		<a href="javascript:po_show('{$bom_acc.acc[BOM].spec_ap[AP].ap_num}')">{$bom_acc.acc[BOM].spec_ap[AP].po_num}</a>
		<!-- STATUS -->
		{if $bom_acc.acc[BOM].spec_ap[AP].po_num}( {$bom_acc.acc[BOM].spec_ap[AP].statuss} ){/if}
		<!-- NOTE -->
		{if $bom_acc.acc[BOM].spec_ap[AP].ann_num}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=red><b>{$bom_acc.acc[BOM].spec_ap[AP].ann_num}</b></font><br>{/if}
		{/section}</small>&nbsp;	
		</td>
		{/if}
	</tr>
	{/section}
	{/if}
</table>

<BR>
{if $exc_rec.0.exc_id}
<table width="100%" border=1 cellspacing=1 cellpadding=2> 
	<tr height="30" bgcolor=#D5D5BE>
		<td width=90 class=b9 align=center><b>EXCEPTION #</b></td>
		<td width=90 class=b9 align=center><b>PO #</b></td>
		<td width=200 class=b9 align=center><b>異常狀態</b></td>
		<td class=b9 align=center><b>Material</b></td>
	</tr>
	{section name=SEC loop=$exc_rec}
	<tr>
		<td class=b9 align=center><a href="javascript:open_exc({$exc_rec[SEC].exc_id})">{$exc_rec[SEC].ex_num} </a></td>
		<td class=b9 align=center><a href="javascript:po_show('{$exc_rec[SEC].ap_num}')">{$exc_rec[SEC].po_num}</a></td>
		<td class=b9 align=left>{$exc_rec[SEC].exc_name}</td>
		<td class=b9 align=left>{$exc_rec[SEC].mat_code}</td>
	</tr>	 
	{/section}
</table>
{/if}

<table width="100%" border=0 cellspacing=1 cellpadding=2> 
	<tr>
		<td class=gry9 align=right>
			{literal}&nbsp;&nbsp;&nbsp;Confirm: {/literal}&nbsp;{if $wi.bcfm_user}<a href="javascript:message_out('{$wi.bcfm_user_id}')" style="cursor:pointer"><u>{$wi.bcfm_user}</u></a>&nbsp;&nbsp; <U>[ {$wi.bcfm_date} ] </U>{else}[ None ]{/if}
			{literal}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Submit: {/literal}&nbsp;{if $wi.bupdator}<u>{$wi.bupdator}</u>&nbsp;&nbsp;&nbsp;{/if}
		</b></td>
	</tr>
</table>

<table border=0 cellspacing=0 cellpadding=2 width="100%" bgcolor=#ffffff align=center>
	<tr>
		<td colspan=2>
		{if $back_str && $edit_non <> 1}
		<input type=button onClick="window.location.href='{$PHP_SELF}{$back_str}'" value=" << go back " class=select_e style="cursor:pointer; width=99%">
		{else}&nbsp;
		{/if}
		</td>
	</tr>
</table>
</form>
<!--------- footer ---------->
{include file="footer.html"}