<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5" />
<title>Marker append</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="./js/pngfix.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<script language="JavaScript">
<!--

function chg_unit() { 
	var units = document.getElementById('select_unit').value;
	if(units==1){
		unit1.innerText  = '(inch)';
	}else if (units==2){
		unit1.innerText  = '(cm)';
	}else{
		unit1.innerText  = '';
	}	
}

function order_out(order_num) {
	 var url ="index2.php?PHP_action=show_order_det&PHP_order_num="+order_num;
	 var nm = 'sample';
	 window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600 top=50, left=100');
}

function remark() {
	mark = document.getElementById('txt_remark').value;
	txt  = document.getElementById('select_remark').value;
	if(txt != 'select'){
		if(mark != '') mark = mark + '¡F';
		document.getElementById('txt_remark').value = mark + txt + '' ;
		document.getElementById('txt_remark').focus();
	}
}

function marker_submit(type) {

	var fab = document.getElementById('select_fab').value;
	var units = document.getElementById('select_unit').value;
	var width = document.getElementById('width').value;

	if(fab == ""){      
		alert("pls select Fab Type!");
		document.getElementById('select_fab').focus(); 
	}else if(units == ""){
		alert("pls select Unit Type!");
		document.getElementById('select_unit').focus(); 
	}else if(width == ""){
		alert("pls input width!");
		document.getElementById('width').focus(); 
	}else{
		if(type == 'append'){
			document.getElementById('PHP_append').value = 'yes';
		}
		marker_add.submit();
	}      
}



function down_marker(num) {
	if ( confirm("download this style MARKER file?")) {
		location.href="marker.php?PHP_action=marker_download&PHP_num="+num;
	} 
}

function del_marker(ord_id,fab,combo,order_num) {

	if ( confirm("Delete this MARKER record?")) {
		location.href="marker.php?PHP_action=marker_ord_del&PHP_order_num="+order_num+"&PHP_id="+ord_id+"&PHP_fab_type="+fab+"&PHP_combo="+combo;
	} 
}

function marker_file_del(id,order_num,marker) {
	if ( confirm("Delete this MARKER files?")) {
		location.href="marker.php?PHP_action=marker_file_del&action=add&PHP_id="+id+"&PHP_order_num="+order_num+"&PHP_marker="+marker+"&PHP_add=ok";
	} 
}

function marker_report_add(order_num,id) {
	location.href="marker.php?PHP_action=marker_ord_report_add&PHP_id="+id+"&PHP_order_num="+order_num;
}

function marker_report_view(order_num,id) {
	location.href="marker.php?PHP_action=marker_ord_report_view&PHP_id="+id+"&PHP_order_num="+order_num;
}

function Show_ord_wi(id) {
	 var url ='index2.php?PHP_action=wi_view&PHP_ex_order=1&PHP_id='+id+'&PHP_sr=&PHP_dept_code=&PHP_num=&PHP_cust=&PHP_etdstr=&PHP_etdfsh=&PHP_sch_fty=&PHP_un_fhs='; 	
	 var nm = 'Sworking';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600 top=50, left=100');
}

function list(id){
	var gofile ='marker.php?PHP_action=show_fabric_search&PHP_id='+id;	
	style=window.open2(gofile,'style','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=805,height=500, top=100, left=150');
 	style.focus();
 }
 
function writeToParentList(lots_code,id,use_for) {
	window.document.forms['marker_add'].elements['PHP_lots_code'].value = lots_code;
	window.document.forms['marker_add'].elements['PHP_lots_id'].value = id;
} 
-->
</script>
{/literal}
</head>
<body topmargin="12" >
{if $edit_flag}
<table border="border" cellspacing="0" cellpadding="4" cols="1" width="690" bgcolor="#cccccc"  align="center">
    <tr>
      <td bgcolor="#CCCCCC"><table width="100%" border="1" align="center" cellpadding="4" cellspacing="0" cols="1" bgcolor="#003300">
        <tr>
          <td height="28" align="center" class="des">[ <span class="ylw9">APPEND</span> NEW ORDER &nbsp;MARKER ]</td>
        </tr>
      </table>
        {if $msg_YES}
				<table border="1" cellpadding="4" cellspacing="0" cols="1" width="100%">
          <tr bgcolor="#ffffff">
            <td width="90" class="gry10" align="center"><img src="images/alert.gif" border="0" /></td>
            <td class="bgdy">{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br />
              {/section}</td>
          </tr>
        </table>

        {/if}
				<hr size="2" width="100%" />
				<fieldset style=" border:1px outset #cccccc;">
				<legend><a href="javascript:Show_ord_wi('{$wi_id}')" value='ord_out' style='cursor:pointer'>{$order_num}</a></legend>
				<table width="665" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#999999">
          <tr>
            <td width="120" align="center" bgcolor="#0D4368" class="des">Picture</td>
            <td colspan="5" align="center" bgcolor="#0D4368" class="des">Marker</td>
            <td align="center" bgcolor="#0D4368" class="des">&nbsp;</td>
          </tr>
					
          <tr bgcolor="#FFFFFF">
            <td rowspan="4" align="center" valign="top">{$main_pic}</td>
						<form name="marker_add_up" method="post" enctype="multipart/form-data">
            <td colspan="5" align="center" valign="top">
						{if $marker}
						<a href="javascript:down_marker('{$marker}')" value='smpl' style='cursor:pointer'><img src='./images/zip.png' border="0" alt="download MARKER" /></a> {if $edit_flag and $order.status < 7} <a href="javascript:marker_file_del('{$id}','{$order_num}','{$marker}')" value='smpl' style='cursor:pointer'><img src='./images/del.gif' border="0" alt="Delete MARKER" /></a>
						{/if}
						{else} <img src='./images/zip.png' border="0" alt="NO MARKER" />
            <input type="file" name="PHP_marker" id="marker" style="width:320px" />
						<input type="submit" name="submit" value="upload" style="width:80px" />
            {/if}
						<input type="hidden" name="PHP_action" value="marker_ord_up" />
						<input type="hidden" name="PHP_ord_id" value="{$id}" />
						<input type="hidden" name="PHP_order_num" value="{$order_num}" />
						<input type="hidden" name="PHP_append" id="PHP_append" value="yes" /></td>
						</form>
            <td align="center" valign="middle">												</td>
          </tr>
          <tr bgcolor="#FFFFFF">
            <td width="120" align="center" bgcolor="#0D4368" class="des">FABRIC#</td>
            <td width="120" align="center" bgcolor="#0D4368" class="des">Fab Type </td>
            <td width="120" align="center" bgcolor="#0D4368" class="des">unit</td>
            <td colspan="2" width="220" align="center" bgcolor="#0D4368" class="des">Width</td>
            <td width="60" align="center" bgcolor="#0D4368" class="des">&nbsp;</td>
          </tr>
					<form name="marker_add" >
          <tr bgcolor="#FFFFFF">
            <td align="center" valign="top">
            	<input type="text" name="PHP_lots_code" id="lots_code" style="width:70px" /> 
            	<input type="hidden" name="PHP_lots_id" id="lots_id" style="width:70px" /> 
            	<img src="./images/icoSearch.gif" onClick="list({$wi_id});" style="cursor:pointer" width=15>
            </td>
            <td align="center" valign="top">{$select_fab}</td>
            <td align="center" valign="top">{$select_unit}</td>
            <td colspan="2" align="center" valign="top"><input type="text" name="PHP_width" id="width" style="width:20px" /> <span id="unit1"></span></td>
            <td rowspan="2" align="center" valign="middle"><input type="button" value="[ Add ]" class="select_e" style="cursor:pointer; width:60px" onclick="marker_submit('append')" /></td>
          </tr>
          <tr bgcolor="#FFFFFF">
            <td colspan="5" align="left" valign="top">{$choic_rmk}</td>
            </tr>
					<input type="hidden" name="PHP_action" value="marker_ord_do_add" />
					<input type="hidden" name="PHP_ord_id" value="{$id}" />
					<input type="hidden" name="PHP_order_num" value="{$order_num}" />
					<input type="hidden" name="PHP_append" id="PHP_append" value="ok" />					
					</form>
				</table>

				<table height="6" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td></td>
          </tr>
        </table>
				</fieldset>
			<hr size="2" width="100%" /></td>
	</tr>
</table>
{else}
<table border="border" cellspacing="0" cellpadding="4" cols="1" width="690" bgcolor="#cccccc"  align="center">
    <tr>
      <td bgcolor="#CCCCCC"><table width="100%" border="1" align="center" cellpadding="4" cellspacing="0" cols="1" bgcolor="#003300">
        <tr>
          <td height="28" align="center" class="des">[ ORDER &nbsp;MARKER ]</td>
        </tr>
      </table>
        {if $msg_YES}
				<table border="1" cellpadding="4" cellspacing="0" cols="1" width="100%">
          <tr bgcolor="#ffffff">
            <td width="90" class="gry10" align="center"><img src="images/alert.gif" border="0" /></td>
            <td class="bgdy">{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br />
              {/section}</td>
          </tr>
        </table>

        {/if}
				<hr size="2" width="100%" />
				<fieldset style=" border:1px outset #cccccc;">
				<legend><a href="javascript:Show_ord_wi('{$wi_id}')" value='ord_out' style='cursor:pointer'>{$order_num}</a></legend>
				<table width="665" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#999999">
          <tr>
            <td width="120" align="center" bgcolor="#0D4368" class="des">Picture</td>
            <td align="center" bgcolor="#0D4368" class="des">Marker</td>
          </tr>
					
          <tr bgcolor="#FFFFFF">
            <td align="center" valign="top">{$main_pic}</td>
            <td align="center" valign="top">
						<table width="100%" border="0" cellspacing="1" cellpadding="3" bgcolor="#999999" >
						{$list.title}
						</table>
						</td>
          </tr>
				</table>
				<table height="6" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td></td>
          </tr>
        </table>
				</fieldset>
			<hr size="2" width="100%" /></td>
	</tr>
</table>
{/if}

<hr size="2" width="680" />
<table border="border" cellspacing="0" cellpadding="4" cols="1" width="690" bgcolor="#cccccc"  align="center">
  <tr>
    <td bgcolor="#CCCCCC"><table width="100%" border="1" align="center" cellpadding="4" cellspacing="0" cols="1" bgcolor="#999999">
      <tr>
        <td align="center" class="des"><table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td align="center">[ ORDER MARKER LIST ] </td>
              <td width="30">{if $marker}<a href="javascript:down_marker('{$marker}')" value='smpl' style='cursor:pointer'><img src='./images/zip.png' border="0" alt="download MARKER" /></a>{else}<img src='./images/zip2.png' border="0" alt="NO MARKER" />{/if}</td>
            </tr>
        </table></td>
      </tr>
    </table>
      <hr size="2" width="100%" />
      <table width="100%" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#999999">
        <tr>
          <!-- <td width="80" align="center" bgcolor="#0D4368" class="des">Fabric# </td> -->
          <td width="80" align="center" bgcolor="#0D4368" class="des">Fab Type </td>
          <td align="center" bgcolor="#0D4368" class="des">Description</td>
          <td align="center" bgcolor="#0D4368" class="des">Marker # </td>
          <td align="center" bgcolor="#0D4368" class="des">Remark</td>
          <td width="80" align="center" bgcolor="#0D4368" class="des">YY</td>
		  {if $admin_flag}<td width="80" align="center" bgcolor="#0D4368" class="des">Consume</td>{/if}
          <td width="80" align="center" bgcolor="#0D4368" class="des">YY(BOM)</td>
          {if $edit_flag}<td bgcolor="#0D4368" ></td>{/if}
				</tr>
				{section name=SEC loop=$mks}
        <tr bgcolor="#FFFFFF">
          <!-- <td align="left" valign="middle">{$mks[SEC].mat_code}</td> -->
          <td align="center" valign="middle" nowrap="nowrap">
					<a href="javascript:marker_report_view('{$order_num}','{$mks[SEC].id}')" value='smpl' style='cursor:pointer'>{$mks[SEC].fab_t}{if $mks[SEC].combo != 0}{$mks[SEC].combo}{/if}</a>					</td>
          <td align="left" valign="middle">{$mks[SEC].description}</td>
          <td align="left" valign="middle">{$mks[SEC].marker}</td>
          <td align="left" valign="middle">{$mks[SEC].remark}</td>
          <td align="right" valign="middle">
					{if $mks[SEC].averages}
					{$mks[SEC].averages|number_format:"2f"} ( {$mks[SEC].unit} ) 
					{/if}
					</td>
		  {if $admin_flag}<td align="middle" valign="middle">{$mks[SEC].length_total|number_format:"2f"}</td>{/if}
					<td align="right" valign="middle">{$mks[SEC].est_1|number_format:"2f"} ( {$mks[SEC].b_unit} )</td>
					{if $edit_flag}
          <td align="center" valign="middle">
					<a href="javascript:marker_report_add('{$order_num}','{$mks[SEC].id}')" value='smpl' style='cursor:pointer'>
					<img src='./images/edit.gif' border="0" alt="Edit" />
					</a>
					{if $mks[SEC].marker_del}
					<a href="javascript:del_marker('{$mks[SEC].ord_id}','{$mks[SEC].fab_type}','{$mks[SEC].combo}','{$order_num}')" value='smpl' style='cursor:pointer'><img src='./images/icon_delete.gif' border="0" alt="Delete" /></a>
					{/if}
					</td>
					{/if}
				</tr>
				{/section}
				{if !$mks}
        <tr bgcolor="#FFFFFF">
          <td colspan="8" align="center" valign="middle" nowrap="nowrap" class="err">there is no record currently!</td>
        </tr>
				{/if}
      </table>
      <table height="6" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td></td>
        </tr>
      </table>
      <hr size="2" width="100%" /></td>
  </tr>
</table>
<div align="center">
<hr size="2" width="680" />
<input type="button" name="buttons" onclick="javascript:history.back(-1)" value=" &lt;&lt; go back " class="select_e" style="cursor:pointer; width:655px" />
</div>
</body>
</html>
<!--------- footer ---------->
{include file="footer.html"}
