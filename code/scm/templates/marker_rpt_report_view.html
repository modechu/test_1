<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5" />
<title>Marker report</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="./js/pngfix.js"></script>
<script language="javascript" src="./js/open_detial.js"></script>
<Script language="javascript">
function chk(row,col){
	var smt_add = '';
	//if(row='') row = document.getElementsByName('PHP_row');
	//if(col='') col = document.getElementsByName('PHP_col');
	
	if(row && col){
		for( y = 1 ; y <= row ; y++ ){

			var obj=document.getElementsByName('cr['+y+']');
			var len = obj.length;
			var checked = false;

			for (i = 0; i < len; i++)	{
				if (obj[i].checked == true){
					checked = true;
					break;
				}
			}

			if(checked == true){
				for( i = 1 ; i <= col ; i++ ){
					if(document.getElementById('cw['+i+']').value){
						nw = document.getElementById('mh'+y+'_'+i).value - (document.getElementById('cw['+i+']').value * document.getElementById('lv['+y+']').value );
						if( nw < 0 ){
							//alert('¤ӶW¹L¤F¡I');
							document.getElementById('m'+y+'_'+i).style.color = 'red';
							smt_add = 1 ;
						}else{
							document.getElementById('m'+y+'_'+i).style.color = 'black';
						}
						document.getElementById('m'+y+'_'+i).value = nw;
					}else{
						//document.getElementById('m'+y+'_'+i).value = 0 ;
						//document.getElementById('m'+y+'_'+i).style.color = 'black';
						document.getElementById('m'+y+'_'+i).value = document.getElementById('mh'+y+'_'+i).value;
					}
				}
			}else{
				for( i = 1 ; i <= col ; i++ ){
					if(document.getElementById('cw['+i+']').value){
						document.getElementById('m'+y+'_'+i).style.color = 'black';
						document.getElementById('m'+y+'_'+i).value = document.getElementById('mh'+y+'_'+i).value;
					}else{
						//document.getElementById('m'+y+'_'+i).value = 0;
						//document.getElementById('m'+y+'_'+i).style.color = 'black';
					}
				}
			}

			if(smt_add){
				document.getElementById('Smt_add').disabled = true;
				document.getElementById('Smt_add').style.cursor = false;
			}else{
				document.getElementById('Smt_add').disabled = false;
				document.getElementById('Smt_add').style.cursor = 'pointer';
			}
	
		}
	}

}


function chk_no(row,col){
	var smt_add = '';
	
	if(row && col){
		for(var c = 1 ; c <= col ; c++ ){

			var nw=0;
			for(var r = 1 ; r <= row ; r++ ){
			
				var obj=document.getElementsByName('cr['+r+']');
				var len = obj.length;
				var checked = false;
				
				for (var l = 0; l < len; l++)	{
					if (obj[l].checked == true){
						checked = true;
						break;
					}
				}	
			
				if(checked == true){
					if(document.getElementById('cw'+r+'['+c+']').value && document.getElementById('lv['+r+']').value){
						
						nw += ( document.getElementById('cw'+r+'['+c+']').value * document.getElementById('lv['+r+']').value );
					}
				}
			}
			var dd = document.getElementById('m'+c).value = document.getElementById('mh'+c).value - nw;
			if( dd < 0 ){
				//alert('¤ӶW¹L¤F¡I');
				document.getElementById('m'+c).style.color = 'red';
				smt_add = 1 ;
			}else{
				document.getElementById('m'+c).style.color = 'black';
			}
		}

	}

	if(smt_add){
		document.getElementById('Smt_add').disabled = true;
		document.getElementById('Smt_add').style.cursor = false;
	}else{
		document.getElementById('Smt_add').disabled = false;
		document.getElementById('Smt_add').style.cursor = 'pointer';
	}


}


function atc(type){
	var mk = document.getElementById('select_mk').value;
	if(mk == ""){      
		alert("pls select marker number!");
		document.getElementById('select_mk').focus();
	}else{
		if(type == 'append'){
			document.getElementById('PHP_status').value = 'append';
			if(document.getElementById('PHP_new').value == 'yes')
			document.getElementById('PHP_status').value = 'edit';
			
		}else if (type == 'edit'){
			document.getElementById('PHP_status').value = 'edit';
		}
		//alert(document.getElementById('PHP_status').value);
		report_add.submit();
	}
}


function del_marker(id,ord_id,fab,combo,order_num) {

	if ( confirm("Delete this MARKER record?")) {
		location.href="fty_marker.php?PHP_action=marker_ord_del&PHP_order_num="+order_num+"&PHP_id="+id+"&PHP_ord_id="+ord_id+"&PHP_fab_type="+fab+"&PHP_combo="+combo+"&PHP_status=edit";
	} 
}

function go_list(num) {
	location.href="fty_marker.php?PHP_action=marker_rpt_add&PHP_order_num="+num;
}

function Show_ord_wi(id) {
	 var url ='index2.php?PHP_action=wi_view&PHP_ex_order=1&PHP_id='+id+'&PHP_sr=&PHP_dept_code=&PHP_num=&PHP_cust=&PHP_etdstr=&PHP_etdfsh=&PHP_sch_fty=&PHP_un_fhs='; 	
	 var nm = 'Sworking';
	window.open2(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600 top=50, left=100');
}
</script>
{/literal}
</head>
<body topmargin="15">
<br>
<table width="760" border="0" cellspacing="0" cellpadding="0">
	<tr>
    <td align="right"></td>
  </tr>
  <tr>
    <td align="left"><table width="100%" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#999999">
        <tr>
          <td width="88" align="center" bgcolor="#0D4368" class="des">Order #</td>
          <td width="90" align="center" bgcolor="#0D4368" class="des">Fab Type </td>
          <td width="90" align="center" bgcolor="#0D4368" class="des">unit</td>
          <td width="90" align="center" bgcolor="#0D4368" class="des">Width</td>
          <td align="center" bgcolor="#0D4368" class="des">Remark</td>
          <td width="66" align="center" bgcolor="#0D4368" class="des">YY ({$unit}) </td>
        </tr>
        <tr bgcolor="#FFFFFF">
          <td align="center" valign="top"><a href="javascript:Show_ord_wi('{$wi_id}')" value='ord_out' style='cursor:pointer'>{$mk_name}</a></td>
          <td align="center" valign="top">{$fab_type}{if $mk.combo != 0}{$mk.combo}{/if}</td>
          <td align="center" valign="top">{$unit}</td>
          <td align="center" valign="top">{$mk.width} {$unit2}</td>
          <td align="left" valign="top">{$rmk}</td>
          <td align="center" valign="top">{if $averages}<b>{$averages|number_format:"2f"}</b>{/if}</td>
        </tr>
      </table></td>
  </tr>
	<tr>
    <td height="2"></td>
  </tr>
	<tr>
    <td>
			<table width="100%" border="0" cellspacing="1" cellpadding="3" bgcolor="#999999" >
			{$list.title}
			</table>
		</td>
  </tr>
	<tr>
    <td height="2"></td>
  </tr>
  <tr>
    <td>
		{if $new != 'yes'}
		<table width="100%" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#999999">
      <tr>
        <td width="80" align="center" bgcolor="#0D4368" class="des">Mk #</td>
        <td align="center" bgcolor="#0D4368" class="des">Marker Assortment</td>
        <td width="66" align="center" nowrap="nowrap" bgcolor="#0D4368" class="w9" title="Length">Length ({$unit})</td>
        <td width="66" align="center" bgcolor="#0D4368" class="des" title="yard">({$unit})</td>
        <td width="66" align="center" bgcolor="#0D4368" class="des">qty</td>
        <td width="66" align="center" bgcolor="#0D4368" class="des">YY ({$unit}) </td>
        </tr>
      {section name=SEC loop=$mks}
  <tr bgcolor="#FFFFFF">
    <td align="center" valign="top" nowrap="nowrap">{$mks[SEC].mk_name}{$mks[SEC].combo}{$mks[SEC].mk_num}</td>
    <td align="left" valign="top" nowrap="nowrap">{$mks[SEC].assortment}</td>
    <td align="right" valign="top">{$mks[SEC].length|number_format:"2f"}&nbsp;&nbsp;</td>
    <td align="right" valign="top">{if $mks[SEC].clothes}{$mks[SEC].clothes|number_format:"2f"}{/if}&nbsp;&nbsp;</td>
    <td align="right" valign="top">{if $mks[SEC].estimate}{$mks[SEC].estimate|number_format}{/if}&nbsp;&nbsp;</td>
    <td align="right" valign="top">{if $mks[SEC].averages}{$mks[SEC].averages|number_format:"2f"}{/if}&nbsp;&nbsp;</td>
    </tr>
      {/section}
  <tr bgcolor="#FFFFFF">
    <td colspan="6"></td>
    </tr>
  <tr bgcolor="#FFFFFF">
    <td colspan="3" align="right" valign="middle" bgcolor="#EEEEEE">Total : </td>
    <td align="right" valign="middle" bgcolor="#EEEEEE">{if $clothes}{$clothes|number_format:"2f"}{/if}&nbsp;&nbsp;</td>
    <td align="right" valign="middle" bgcolor="#EEEEEE">{if $estimate}{$estimate|number_format}{/if}&nbsp;&nbsp;</td>
    <td align="right" valign="middle" bgcolor="#EEEEEE">{if $averages}{$averages|number_format:"2f"}{/if}&nbsp;&nbsp;</td>
    </tr>
    </table>
		{/if}		</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
</table>
<p>
<input type="button" onclick="go_list('{$PHP_order_num}')" value="  CUTTING REPORT LIST  " class="select_e" style="cursor:pointer; width:220px" />
<input type="button" onclick="window.location='fty_marker.php?PHP_action=marker_rpt_list'" value=" &lt;&lt;  back to list " class="select_e" style="cursor:pointer; width:460px" />
&nbsp;&nbsp;
<a href="{$PHP_SELF}?PHP_action=marker_rpt_pdf&PHP_order_num={$PHP_order_num}&PHP_id={$PHP_id}" style="cursor:pointer"><img src='./images/print9.gif' border="0" alt="print" /></a>
</p>
</body>
</html>
