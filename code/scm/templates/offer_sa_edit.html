<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=big5">
   <title>===:::::::::: SCM -B [ Pre-Sample working sheet ] ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript"
        src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript"
        src="./js/build/connection/connection-min.js"></script>

<script type="text/javascript" src="./js/build/yahoo-dom-event/yahoo-dom-event2.js"></script>
<script type="text/javascript" src="./js/build/animation/animation.js"></script>
<script type="text/javascript" src="./js/build/autocomplete/autocomplete.js"></script>
<link rel="stylesheet" type="text/css" href="./js/build/fonts/fonts-min.css" />
<link rel="stylesheet" type="text/css" href="./js/build/autocomplete/assets/skins/sam/autocomplete.css" />


<!--begin custom header content for this example-->
<style type="text/css">
/* custom styles for multiple stacked instances */
#statesautocomplete,
#statesautocomplete2 {
    width:10em; /* set width here */
    padding-bottom:2em;
}
#statesautocomplete {
    z-index:10; /* z-index needed on top instance for ie & sf absolute inside relative issue */
}
#statesinput,
#statesinput2 {
    _position:absolute; /* abs pos needed for ie quirks */
}
<!--
#Layer1 {
position:absolute;
left:197px;
top:470px;
width:421px;
height:708px;
z-index:1;

}
-->

</style>

<Script language="javascript">
	var transaction;
  var sUrl;
  var addback = {
    success: function(o) {
		document.getElementById("tbl_msg").style.display='block';    
    	var response = o.responseText.split("|");

		msg1.innerText  = response[0]; 
		of_num.innerHTML = "<b>"+response[1]+"</b>";
 		window.document.forms['adding'].elements['PHP_num'].value = response[1];		
 		window.document.forms['adding'].elements['PHP_id'].value = response[2];		
		r=mat_show.insertRow();
		r.insertCell().innerText	= response[3];
		r.insertCell().innerHTML	= response[4];
		r.insertCell().innerHTML	= response[5];
		r.insertCell().innerHTML	= "<P align=right>"+response[6]+"</P>";
		r.insertCell().innerHTML	= "&nbsp;";
		r.insertCell().innerHTML	= "<P align=right>"+response[7]+"</P>";
		r.insertCell().innerHTML	= "&nbsp;";
		r.insertCell().innerHTML	= "<P align=right>"+response[8]+"</P>";
		r.insertCell().innerHTML	= response[9];
	  window.document.forms['adding'].elements['PHP_un_gm_cost'].value = response[10];
	  window.document.forms['adding'].elements['PHP_cost'].value = response[11];
	  document.getElementById("layer1").style.display='none';
    },
    failure: function(o) {
      alert("Error¡GCan't get data");
    }
  };
  var delback = {
    success: function(o) {
    	document.getElementById("tbl_msg").style.display='block';    
    	var response = o.responseText.split("|");
    	var divrep=response[0];
    	msg1.innerText  = divrep; 
	  window.document.forms['adding'].elements['PHP_un_gm_cost'].value = response[1];
	  window.document.forms['adding'].elements['PHP_cost'].value = response[2];
	  document.getElementById("layer1").style.display='none';

    },
    failure: function(o) {
      alert("Error¡GCan't get data");
    }
  }; 
  
   var editback = {
    success: function(o) {
    	document.getElementById("tbl_msg").style.display='block';    
    	var response = o.responseText.split("|");
    	var divrep=response[0];
    	msg1.innerText  = divrep; 
	  window.document.forms['adding'].elements['PHP_un_gm_cost'].value = response[1];
	  window.document.forms['adding'].elements['PHP_cost'].value = response[2];
	  document.getElementById("layer1").style.display='none';

    },
    failure: function(o) {
      alert("Error¡GCan't get data");
    }
  };   
</script>

<Script language="javascript">
var $old ="";
var ii = 0;
function cfm_img() {
		var $old ="";
		$old = document.pic.src;
		document.pic.src = document.adding.PHP_pic.value;
	if ( !confirm ("confirm if the picture is correct?")){
		document.pic.src = $old;
	} else {
		document.adding.PHP_pic_upload.value ="1";
	}
}
function cfm_swatch() {
		var $old ="";
		$old = document.swatch.src;
		document.swatch.src = document.adding.PHP_swatch.value;
	if ( !confirm ("confirm if the picture is correct?")){
		document.swatch.src = $old;
	} else {
		document.adding.PHP_swatch_upload.value ="1";
	}
}
function wait(){
	alert ("It take little longer time, if you have picture uploading !\r\rplease <b>do not</b> click any before the page changed¡C \rthe best way is to format your picture size exact same as system required !  ");
}

function   roundAmount(n)   {   
      var   s   =   ""   +   Math.round(n   *   100)   /   100   
      var   i   =   s.indexOf('.')   
      if   (i   <   0)   return   s   +   ".00"   
      var   t   =   s.substring(0,   i   +   1)   +     
              s.substring(i   +   1,   i   +   3)   
      if   (i   +   2   ==   s.length)   t   +=   "0"   
        
      return   t   
  }   


function fabric(i)
{
	//	var cost = 0;
		var tmp = 0;
		var gm=0;
		var org_cost = 0;
		price = eval("window.document.forms['adding'].elements['PHP_fp'+i].value");
		if (price == '')price = 0;
		if( isNaN(parseFloat(price)) )
		{
			alert("Please input number on U/Price¡I");  
		    return;
		 }
		 
		qty = eval("window.document.forms['adding'].elements['PHP_fq'+i].value");
		if (qty == '')qty = 0;
		if(isNaN(parseFloat(qty)) )
		{
			alert("Please input number on YY/Q'ty¡I");  
		    return;
		 }
		  
		 cost=parseFloat(price)*parseFloat(qty);
		 cost=roundAmount(cost);
		 window.document.forms['adding'].elements['PHP_fc'+i].value = cost;	
}


function add_fab()
{
	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_fp1'].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_fq1'].value");
  var item = window.document.forms['adding'].elements['PHP_fi1'].value;
  var usage = window.document.forms['adding'].elements['PHP_fu1'].value;
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();

	if (price == 0 || price =='' || qty=='' || qty==0 || item=='')
	{
		alert("Please input Item, Price and Qty on fabric");
		return;
	}

	window.document.forms['adding'].elements['PHP_fi1'].value ='';
	window.document.forms['adding'].elements['PHP_fu1'].value ='';
	window.document.forms['adding'].elements['PHP_fp1'].value ='';
	window.document.forms['adding'].elements['PHP_fq1'].value ='';
	window.document.forms['adding'].elements['PHP_fc1'].value ='';

	ii++;
  sUrl = "offer.php?PHP_action=offer_fab_add&PHP_id="+id+"&PHP_yy="+qty+"&PHP_price="+price+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_group=fab&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_num="+num+"&PHP_ii="+ii;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}

function fusible(i)
{
		var tmp = 0;
		var gm=0;
		var org_cost = 0;
		price = eval("window.document.forms['adding'].elements['PHP_fsp'+i].value");
		if (price == '')price = 0;
		if( isNaN(parseFloat(price)) )
		{
			alert("Please input number on U/Price¡I");  
		    return;
		 }
		 
		qty = eval("window.document.forms['adding'].elements['PHP_fsq'+i].value");
		if (qty == '')qty = 0;
		if(isNaN(parseFloat(qty)) )
		{
			alert("Please input number on YY/Q'ty¡I");  
		    return;
		 }
		  
		 cost=parseFloat(price)*parseFloat(qty);
		 cost=roundAmount(cost);
		 window.document.forms['adding'].elements['PHP_fsc'+i].value = cost;	
}

function add_fus()
{
	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_fsp1'].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_fsq1'].value");
  var item = window.document.forms['adding'].elements['PHP_fsi1'].value;
  var usage = window.document.forms['adding'].elements['PHP_fsu1'].value;
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();

	if (price == 0 || price =='' || qty=='' || qty==0 || item=='')
	{
		alert("Please input Item, Price and Qty on fabric");
		return;
	}
	window.document.forms['adding'].elements['PHP_fsi1'].value ='';
	window.document.forms['adding'].elements['PHP_fsu1'].value ='';
	window.document.forms['adding'].elements['PHP_fsp1'].value ='';
	window.document.forms['adding'].elements['PHP_fsq1'].value ='';
	window.document.forms['adding'].elements['PHP_fsc1'].value ='';

	ii++
  sUrl = "offer.php?PHP_action=offer_fab_add&PHP_id="+id+"&PHP_yy="+qty+"&PHP_price="+price+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_group=fus&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_num="+num+"&PHP_ii="+ii;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}

function interline(i)
{
		var tmp = 0;
		price = eval("window.document.forms['adding'].elements['PHP_ip'+i].value");
		if (price == '')price = 0;
		if( isNaN(parseFloat(price)) )
		{
			alert("Please input number on U/Price¡I");  
		    return;
		 }
		 
		qty = eval("window.document.forms['adding'].elements['PHP_iq'+i].value");
		if (qty == '')qty = 0;
		if(isNaN(parseFloat(qty)) )
		{
			alert("Please input number on YY/Q'ty¡I");  
		    return;
		 }
		  
		 cost=parseFloat(price)*parseFloat(qty);
		 cost=roundAmount(cost);
		 window.document.forms['adding'].elements['PHP_ic'+i].value = cost;
}

function add_inter()
{
	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_ip1'].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_iq1'].value");
  var item = window.document.forms['adding'].elements['PHP_ii1'].value;
  var usage = window.document.forms['adding'].elements['PHP_iu1'].value;
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();

	if (price == 0 || price =='' || qty=='' || qty==0 || item=='')
	{
		alert("Please input Item, Price and Qty on fabric");
		return;
	}
	window.document.forms['adding'].elements['PHP_ii1'].value ='';
	window.document.forms['adding'].elements['PHP_iu1'].value ='';
	window.document.forms['adding'].elements['PHP_ip1'].value ='';
	window.document.forms['adding'].elements['PHP_iq1'].value ='';
	window.document.forms['adding'].elements['PHP_ic1'].value ='';

	ii++;
  sUrl = "offer.php?PHP_action=offer_fab_add&PHP_id="+id+"&PHP_yy="+qty+"&PHP_price="+price+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_group=inter&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_num="+num+"&PHP_ii="+ii;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}

function acc(i)
{
		var tmp = 0;
		price = eval("window.document.forms['adding'].elements['PHP_ap'+i].value");
		if (price == '')price = 0;
		if(isNaN(parseFloat(price)))  
		{
			alert("Please input number on U/Price¡I");  
		    return;
		 }
		 
		qty = eval("window.document.forms['adding'].elements['PHP_aq'+i].value");
		if (qty == '')qty = 0;
		if(isNaN(parseFloat(qty)))  
		{
			alert("Please input number on YY/Q'ty¡I");  
		    return;
		 }
		  
		 cost=parseFloat(price)*parseFloat(qty);
		 cost=roundAmount(cost);
		 window.document.forms['adding'].elements['PHP_ac'+i].value = cost;
}

function add_acc()
{
	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_ap1'].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_aq1'].value");
  var item = window.document.forms['adding'].elements['statesinput'].value;
  var usage = window.document.forms['adding'].elements['PHP_au1'].value;
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();

	if (price == 0 || price =='' || qty=='' || qty==0 || item=='')
	{
		alert("Please input Item, Price and Qty on fabric");
		return;
	}
	window.document.forms['adding'].elements['statesinput'].value ='';
	window.document.forms['adding'].elements['PHP_au1'].value ='';
	window.document.forms['adding'].elements['PHP_ap1'].value ='';
	window.document.forms['adding'].elements['PHP_aq1'].value ='';
	window.document.forms['adding'].elements['PHP_ac1'].value ='';

	ii++;
  sUrl = "offer.php?PHP_action=offer_fab_add&PHP_id="+id+"&PHP_yy="+qty+"&PHP_price="+price+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_group=acc&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_num="+num+"&PHP_ii="+ii;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}

function other(i)
{
		var tmp = 0;

		price = eval("window.document.forms['adding'].elements['PHP_op'+i].value");
		if (price == '')price = 0;
		if(isNaN(parseFloat(price)))  
		{
			alert("Please input number on U/Price¡I");  
		    return;
		 }
		 
		qty = eval("window.document.forms['adding'].elements['PHP_oq'+i].value");
		 if (qty == '')qty = 0;
		if(isNaN(parseFloat(qty)))  
		{
			alert("Please input number on YY/Q'ty¡I");  
		    return;
		 }
		 
		 cost=parseFloat(price)*parseFloat(qty);
		 cost=roundAmount(cost);
		 window.document.forms['adding'].elements['PHP_oc'+i].value = cost;
}

function add_other()
{
	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_op1'].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_oq1'].value");
  var item = window.document.forms['adding'].elements['statesinput2'].value;
  var usage = window.document.forms['adding'].elements['PHP_ou1'].value;
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();

	if (price == 0 || price =='' || qty=='' || qty==0 || item=='')
	{
		alert("Please input Item, Price and Qty on fabric");
		return;
	}
	window.document.forms['adding'].elements['statesinput2'].value ='';
	window.document.forms['adding'].elements['PHP_ou1'].value ='';
	window.document.forms['adding'].elements['PHP_op1'].value ='';
	window.document.forms['adding'].elements['PHP_oq1'].value ='1';
	window.document.forms['adding'].elements['PHP_oc1'].value ='';

	ii++;
  sUrl = "offer.php?PHP_action=offer_fab_add&PHP_id="+id+"&PHP_yy="+qty+"&PHP_price="+price+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_group=other&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_num="+num+"&PHP_ii="+ii;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, addback, null);

}

function cm_c(i)
{
		var tmp = 0;
		var gm=0;
		var org_cost = 0;
		gm=count_gm();
//		org_cost=count_cost();
		var old_cm = window.document.forms['adding'].elements['PHP_old_cm'].value;
		var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
		
	//	alert(old_cm);
		s_total = window.document.forms['adding'].elements['PHP_cm'].value;
		
		if (s_total == '')s_total = 0;
		if (old_cm == '')old_cm = 0;		
		if(isNaN(parseFloat(s_total)))  
		{
			alert("Please input number on C.M¡I");  
		    return;
		 }
		 org_cost = parseFloat(total_cost)-(parseFloat(old_cm))+parseFloat(s_total);
		 
		 total=parseFloat(org_cost)/parseFloat(gm);
		 total=roundAmount(total);

		 window.document.forms['adding'].elements['PHP_un_gm_cost'].value = org_cost;
		 window.document.forms['adding'].elements['PHP_old_cm'].value = s_total;
		 window.document.forms['adding'].elements['PHP_cost'].value = total;
}

function gm(i)
{
		var tmp = 0;
		var gm=0;
		gm=count_gm();
		var org_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;

		new_gm = window.document.forms['adding'].elements['PHP_gm'].value;
		if (new_gm == '')new_gm = 0;		
		if(isNaN(parseFloat(new_gm)))  
		{
			alert("Please input percent rate of Mark-Up¡I");  
		    return;
		 }
		 total=parseFloat(org_cost)/parseFloat(gm);
		 total=roundAmount(total);

		 window.document.forms['adding'].elements['PHP_old_gm'].value = new_gm;
		 window.document.forms['adding'].elements['PHP_cost'].value = total;
}

function commission(i)
{
		var tmp = 0;
		var gm=0;
		gm=count_gm();
		var org_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;


		new_comm = window.document.forms['adding'].elements['PHP_comm'].value;
		if (new_comm == '')new_comm = 0;		
		if(isNaN(parseFloat(new_comm)))  
		{
			alert("Please input percent rate of Commission¡I");  
		    return;
		 }
		 total=parseFloat(org_cost)/parseFloat(gm);
		 total=roundAmount(total);

		 window.document.forms['adding'].elements['PHP_old_comm'].value = new_comm;
		 window.document.forms['adding'].elements['PHP_cost'].value = total;
}
function del_det(id,group,item,usage,r)
{
	if ( confirm("This record will forever delete and can't reversion anymore  !\r\rPlease check again\r\rAre you sure delet Material:["+item+"]??")) {
		document.getElementById("layer1").style.display='block';
	  var i=r.parentNode.parentNode.rowIndex;
	  document.getElementById('mat_show').deleteRow(i);	  
		var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
		var	gm=count_gm();
 	  sUrl = "offer.php?PHP_action=offer_mat_del&PHP_id="+id+"&PHP_group="+group+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_cost="+total_cost+"&PHP_gm="+gm;
    transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, delback, null);
	}else{
		return;
	}

}
function count_gm()
{
		var gm=0;
		tmp_gm = window.document.forms['adding'].elements['PHP_gm'].value;
		tmp_comm = window.document.forms['adding'].elements['PHP_comm'].value;
		if (tmp_gm == '')tmp_gm = 0;
		gm=	1-((parseFloat(tmp_gm)+parseFloat(tmp_comm))/100)	
		return gm;		 
}

function qta_c(i)
{
		var tmp = 0;
		var gm=0;
		var org_cost = 0;
		gm=count_gm();
		var old_qta = window.document.forms['adding'].elements['PHP_old_quota'].value;
		var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
		
		s_total = window.document.forms['adding'].elements['PHP_quota'].value;
		
		if (s_total == '')s_total = 0;
		if (old_qta == '')old_qta = 0;		
		if(isNaN(parseFloat(s_total)))  
		{
			alert("Please input number on C.M¡I");  
		    return;
		 }
		 org_cost = parseFloat(total_cost)-(parseFloat(old_qta))+parseFloat(s_total);
		 
		 total=parseFloat(org_cost)/parseFloat(gm);
		 total=roundAmount(total);

		 window.document.forms['adding'].elements['PHP_un_gm_cost'].value = org_cost;
		 window.document.forms['adding'].elements['PHP_old_quota'].value = s_total;
		 window.document.forms['adding'].elements['PHP_cost'].value = total;
}


function edit_det(id,group,item,usage,ii)
{

	document.getElementById("layer1").style.display='block';
	var	price = eval("window.document.forms['adding'].elements['PHP_item_price_'+ii].value");
  var	qty = eval("window.document.forms['adding'].elements['PHP_item_yy_'+ii].value");
  var	sub = eval("window.document.forms['adding'].elements['PHP_item_tal_'+ii].value");
  var id = window.document.forms['adding'].elements['PHP_id'].value;
  var num = window.document.forms['adding'].elements['PHP_num'].value;
	var total_cost = window.document.forms['adding'].elements['PHP_un_gm_cost'].value;
	var	gm=count_gm();
	
	var cost=parseFloat(price)*parseFloat(qty);
	cost=roundAmount(cost);
	window.document.forms['adding'].elements['PHP_item_tal_'+ii].value = cost;
	
  sUrl = "offer.php?PHP_action=offer_item_edit&PHP_id="+id+"&PHP_group="+group+"&PHP_item="+item+"&PHP_usage="+usage+"&PHP_cost="+total_cost+"&PHP_gm="+gm+"&PHP_price="+price+"&PHP_qty="+qty;
  transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, editback, null);


}
</script>


{/literal}

<!--end custom header content for this example-->

</head>

<body class=" yui-skin-sam">
<div id="Layer1" style="display : none"><img src="./images/ajpk.gif" border=0 width=20%></div>

<!--BEGIN SOURCE CODE FOR EXAMPLE =============================== -->
<form method=POST name=adding enctype="multipart/form-data">
<br>
<table cellspacing=1 cellpadding=4 cols=1 width=700 bgcolor=#333333>
	<tr><td class="des" align=center height=28> [ <span class=ylw10><b>APPEND</b></span> new OFFER working sheet form ] </td></tr>
</table>
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=700 id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
   <tr height=30>
    <td class=b10 align=right nowrap><b>DATE :</b></td>
    <td class=snvy align=left><b>{$of.k_date}</b></td>
    <td class=b10 align=right nowrap><b>Buyer :</b></td>
    <td class=snvy align=left width=50><b>{$of.buyer}</b></td>
    <td class=b10 align=right nowrap><b>Merchandiser :</b></td>
    <td class=snvy align=left ><b>{$of.merchan}</b></td>
    <td class=b10 align=right nowrap><b>currency :</b></td>
    <td class=snvy align=left nowrap><b>$ USD</b></td>
  </tr>
   <tr>
    <td class=b10 align=right nowrap><b>SAMPL ref :</b></td>
    <td class=snvy align=left><b>{$of.smpl_select}</b></td>
  </tr>   
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
</table>
<input name="PHP_id" type="hidden" value="{$of.id}">
<input name="PHP_num" type="hidden" value="{$of.num}">
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
 <tr><form method=POST name=add_pre_smpl >
		<input type="hidden" name="PHP_dept_code" value="{$of.dept}">
		<input type="hidden" name="PHP_cust" value="{$of.buyer}">
		<input type="hidden" name="PHP_merchan" value="{$of.merchan_id}">
		<input type="hidden" name="PHP_date" value="{$of.k_date}">
    <td class=snvy align=right nowrap><b>OFFER # :</b></td>
    <td class=bgdy align=left nowrap><div id='of_num'><b>{$of.num}</b></div></td>

    <td class=snvy align=right nowrap><b>Style #: </b></td>
		<td class=b9 align=left>
		<input type='text' name="PHP_style" size=15 value="{$of.style}" class=select></td>
  
    <td class=snvy align=right nowrap><b>FTY : </b></td>
	  <td class=b9 align=left><b>{$of.fty}</b></td>


    <td align=center class=head valign=top rowspan=6>
		<table width=170 border=1 cellspacing=0 cellpadding=1>
		  <tr><td align=center><img src="{$picture}" name="pic" width=170></td></tr>
		  <tr><td align=center valign=top class=head>
			<input name="PHP_pic" type="file" onChange="cfm_img()" value="{$of.pic}" size=14 class=select>
			</td>
			<input type="hidden" name="PHP_pic_upload" value="">
		  </tr>
		</table>
	</td> 


	</tr>
	<tr>
    <td class=snvy align=right nowrap><b>Agent : </b></td>
		<td class=b9 align=left>{$agent_select}</td>

    <td class=snvy align=right nowrap><b>SPT(sec.) :</b></td>
		<td class=b9 align=left><b><input type='text' name="PHP_spt" size=5 value="{$of.spt}" class=select></td>
    <td class=snvy align=right nowrap><b>Style :</b></td>
    <td class=bgdy align=left ><b>{$style_type}</b></td>
 </tr>
 <tr>
    <td class=snvy align=right nowrap valign=top><b>Style Description :</b></td>
    <td class=gry9 align=left colspan=5>
	      <textarea name="PHP_des" rows=2 cols=75 class=select>{$of.des}</textarea></td> 
 </tr>
 <tr>
    <td class=snvy align=right nowrap valign=top><b> Fabrication :</b></td>
    <td class=gry9 align=left colspan=5>
	      <textarea name="PHP_fab" rows=2 cols=75 class=select>{$of.fab}</textarea></td>
 </tr>
 <tr>
    <td class=snvy align=right nowrap valign=top><b> Fab. Consump. :</b></td>
    <td class=gry9 align=left colspan=5><b>
	    <!--  Mark's YY :<input type='text' name="PHP_cons1" size=5 value="{$of.cos.0}" class=select> -->
	    	<input type='hidden' name="PHP_cons1" value="{$of.cos.0}" >
	      OFFER Size :<input type='text' name="PHP_cons2" size=5 value="{$of.cos.1}" class=select>
	      Size Range :<input type='text' name="PHP_cons3" size=5 value="{$of.cos.2}" class=select>
	      </b></td>
 </tr>
 <tr>
    <td class=snvy align=right nowrap valign=top><b> Technical / Eqpmt. <br>Advisements:</b></td>
    <td class=gry9 align=left colspan=5>
	      <textarea name="PHP_tech" rows=2 cols=75 class=select>{$of.tech}</textarea></td>
 </tr>
</table>
<table cellspacing=1 cellpadding=4 cols=1 width=700 bgcolor=#FFFFFF>
 <tr>
	<td class=bgdy align=center colspan=10 nowrap width=33%>--------------------------------------------------------------------------------- 
		<i><b>unit cost :</b></i> ---------------------------------------------------------------------------------</td>
 </tr>
 <tr>

	<td colspan=10 align=center>
	  <table width=650 border=0 cellspacing=0 cellpadding=1>
		  <tr>
		  <td width=150 align=center>&nbsp;</td>
		  <td width=170 align=center><b>Item</b></td>
		  <td width=170 align=center><b>Usage</b></td>
		  <td width=40 align=center><b>U/Price</b></td>
		  <td width=5 align=center>&nbsp;</td>
		  <td width=50 align=center><b>YY/Q'ty</b></td>
		  <td width=5 align=center>&nbsp;</td>
		  <td width=60 align=center><b>Cost</b></td>
		  <td width=40 align=center>&nbsp;</td>
		  </tr>
		  <tr>
		  <td align=right><b>Fabric : </b></td>
		  <td align=left><input name="PHP_fi1" type="text"  value="{$of.fi1}" size=10em  class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_fu1" type="text"  value="{$of.fu1}" size=25 class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_fp1" type="text"  value="{$of.fp1}" size=4 class=select onChange="fabric('1')" style=text-align:center></td>
		  <td align=center>X</td>
		  <td align=center><input name="PHP_fq1" type="text"  value="{$of.fq1}" size=4 class=select onChange="fabric('1')" style=text-align:center></td>
		  <td align=center>=</td>
		  <td align=center><input name="PHP_fc1" type="label" value="0" size=5 readonly style=text-align:right></td>
		  <td align=center><input type="button" value="ADD" width=90% onclick=add_fab()></td>

		  </tr>
		  <tr>
		  <td align=right><b>Fusible : </b></td>
		  <td align=left><input name="PHP_fsi1" type="text"  value="{$of.fsi1}" size=10em class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_fsu1" type="text"  value="{$of.fsu1}" size=25 class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_fsp1" type="text"  value="{$of.fsp1}" size=4 class=select onChange="fusible('1')" style=text-align:center></td>
		  <td align=center>X</td>
		  <td align=center><input name="PHP_fsq1" type="text"  value="{$of.fsq1}" size=4 class=select onChange="fusible('1')" style=text-align:center></td>
		  <td align=center>=</td>
		  <td align=center><input name="PHP_fsc1" type="label" value="0" size=5 readonly style=text-align:right></td>
		  <td align=center><input type="button" value="ADD" width=90% onclick=add_fus()></td>

		  </tr>
		  <tr>
		  <td align=right><b>InterLining : </b></td>
		  <td align=left><input name="PHP_ii1" type="text"  value="{$of.ii1}" size=10em  class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_iu1" type="text"  value="{$of.iu1}" size=25 class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>
		  <td align=center><input name="PHP_ip1" type="text"  value="{$of.ip1}" size=4 class=select onChange="interline('1')" style=text-align:center></td>
		  <td align=center>X</td>
		  <td align=center><input name="PHP_iq1" type="text"  value="{$of.iq1}" size=4 class=select onChange="interline('1')" style=text-align:center></td>
		  <td align=center>=</td>
		  <td align=center><input name="PHP_ic1" type="label" value="0" size=5 readonly style=text-align:right></td>
		  <td align=center><input type="button" value="ADD" width=90% onclick=add_inter()></td>

		  </tr>
		  <tr>
		  <td align=right><b>Trimming : </b></td>
		   <td align=left><div id="statesautocomplete"><input name="statesinput" type="text" class="select" onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')>
		  				<div id="statescontainer"></div></div>
		 <!--<input name="PHP_ai1" type="text"  value="{$of.ai1}" size=22 class=select>-->
		 </td>
		  <td align=center><input name="PHP_au1" type="text"  value="{$of.au1}" size=25 class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>

		  <td align=center><input name="PHP_ap1" type="text"  value="{$of.ap1}" size=4 class=select onChange="acc('1')" style=text-align:center></td>
		  <td align=center>X</td>
		  <td align=center><input name="PHP_aq1" type="text"  value="{$of.aq1}" size=4 class=select onChange="acc('1')" style=text-align:center></td>
		  <td align=center>=</td>
		  <td align=center><input name="PHP_ac1" type="label" value="0" size=5 readonly style=text-align:right></td>
		  <td align=center><input type="button" value="ADD" width=90% onclick=add_acc()></td>
		  </tr>
		  <tr>
		  <td align=right nowrap><b>Other/Treatment : </b></td>
		  <td align=left>
		  	<div id="statesautocomplete2"> 	<input id="statesinput2" type="text" class="select" onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')>
		  			<div id="statescontainer2"></div></div>		  	
		  	<!--<input name="PHP_oi1" type="text"  value="{$of.oi1}" size=22 class=select>-->
		  </td>
		  <td align=center><input name="PHP_ou1" type="text"  value="{$of.ou1}" size=25 class=select onkeyup=value=value.replace(/[^\w\-\u4e00-\u9fa5\.\*\,]/ig,'')></td>

		  <td align=center><input name="PHP_op1" type="text"  value="{$of.op1}" size=4 class=select onChange="other('1')" style=text-align:center></td>
		  <td align=center>X</td>
		  <td align=center><input name="PHP_oq1" type="text"  value="1" size=4 class=select onChange="other('1')" style=text-align:center></td>
		  <td align=center>=</td>
		  <td align=center><input name="PHP_oc1" type="label" value="0" size=5 readonly style=text-align:right></td>
		  <td align=center><input type="button" value="ADD" width=90% onclick=add_other()></td>
		  </tr>		
		  </tr>		
		  <tr height=3 bgcolor=black><td colspan=8></td></tr>
		  <tr>
		  <td align=right><b>C.M. : </b></td>
		  <td align=center colspan=6>------------------------------------------------------------------------------------------></td>
		  <td align=center><input name="PHP_cm" type="text" value="{$of.cm}" size=5 class=select onChange="cm_c('1')" style=text-align:center ></td>
		  <input name="PHP_old_cm" type="hidden" value={$of.cm}>
		  </tr>
		  <td align=right><b>quota charge : </b></td>
		  <td align=center colspan=6>------------------------------------------------------------------------------------------></td>
		  <td align=center><input name="PHP_quota" type="text" value="{$of.quota}" size=5 class=select onChange="qta_c('1')" style=text-align:center ></td>
		  <input name="PHP_old_quota" type="hidden" value={$of.quota}>
		  </tr>		  
 </table></td></tr>
 <tr>
	<td colspan=10 align=center>
	  <table width=650 border=1 cellspacing=0 cellpadding=2  id="mat_show">
		 <tr bgcolor="#eeeeee">
		  <td width=110 align=center>&nbsp;</td>
		  <td width=170 align=center><b>Item</b></td>
		  <td width=170 align=center><b>Usage</b></td>
		  <td width=40 align=center><b>U/Price</b></td>
		  <td width=3 align=center>&nbsp;</td>
		  <td width=40 align=center><b>YY/Q'ty</b></td>
		  <td width=3 align=center>&nbsp;</td>
		  <td width=40 align=center><b>Cost</b></td>
		  <td width=80 align=center>&nbsp;</td>
		 </tr>
		  {section name=USE loop=$of.fab_cat} 
		   {if $of.fab_cat[USE].fp  || $of.fab_cat[USE].fq }
		  <tr>
		  <td align=left>Fabric </td>
		  <td align=left><small>{$of.fab_cat[USE].fi}&nbsp;</small></td>
		  <td align=left><small>{$of.fab_cat[USE].fu}&nbsp;</small></td>
		  <td align=right><input type =text name=PHP_item_price_fa{$of.fab_cat[USE].j} value='{$of.fab_cat[USE].fp}' size=3 class=select></td>
		  <td align=center>&nbsp;</td>
		  <td align=right><input type =text name=PHP_item_yy_fa{$of.fab_cat[USE].j} value='{$of.fab_cat[USE].fq}' size=3 class=select></td>
		  <td align=center>&nbsp;</td>
		  <td align=right><input type =text name=PHP_item_tal_fa{$of.fab_cat[USE].j} value='{$of.fab_cat[USE].fc}' size=3 readonly ></td>
		  <td align=left>
		  	<input type='button' value=update onclick="edit_det({$of.id},'fab','{$of.fab_cat[USE].fi}','{$of.fab_cat[USE].fu}','fa{$of.fab_cat[USE].j}')">
		  	<input type='image'  src='images/del.png'  onclick="del_det({$of.id},'fab','{$of.fab_cat[USE].fi}','{$of.fab_cat[USE].fu}',this)">
		  </td>

		  </tr>
		  {/if}
		  {/section}
		  {section name=USE loop=$of.fus_cat} 
		   {if $of.fus_cat[USE].fsp  || $of.fus_cat[USE].fsq }
		  <tr>
		  	<td align=left>Fusible</td>
		 		<td align=left><small>{$of.fus_cat[USE].fsi}&nbsp;</small></td>
			  <td align=left><small>{$of.fus_cat[USE].fsu}&nbsp;</small></td>
			  <td align=right><input type =text name=PHP_item_price_fu{$of.fus_cat[USE].j} value='{$of.fus_cat[USE].fsp}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_yy_fu{$of.fus_cat[USE].j} value='{$of.fus_cat[USE].fsq}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_tal_fu{$of.fus_cat[USE].j} value='{$of.fus_cat[USE].fsc}'size=3 readonly ></td>
			  <td align=left>
 			  	<input type='button' value=update onclick="edit_det({$of.id},'fus','{$of.fus_cat[USE].fsi}','{$of.fus_cat[USE].fsu}','fu{$of.fus_cat[USE].j}')">
			  	<input type='image' src='images/del.png'  onclick="del_det({$of.id},'fus','{$of.fus_cat[USE].fsi}','{$of.fus_cat[USE].fsu}',this)">
			  </td>
		  </tr>
		  {/if}
		  {/section}
		  {section name=USE loop=$of.inter_cat} 
		   {if $of.inter_cat[USE].ip  || $of.inter_cat[USE].iq }
		  <tr>
		  	<td align=left>InterLining</td>
		 		<td align=left><small>{$of.inter_cat[USE].ii}&nbsp;</small></td>
			  <td align=left><small>{$of.inter_cat[USE].iu}&nbsp;</small></td>
			  <td align=right><input type =text name=PHP_item_price_it{$of.inter_cat[USE].j} value='{$of.inter_cat[USE].ip}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_yy_it{$of.inter_cat[USE].j} value='{$of.inter_cat[USE].iq}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_tal_it{$of.inter_cat[USE].j} value='{$of.inter_cat[USE].ic}' size=3 readonly ></td>
			  <td align=left>
 			  	<input type='button' value=update onclick="edit_det({$of.id},'inter','{$of.inter_cat[USE].ii}','{$of.inter_cat[USE].iu}','it{$of.inter_cat[USE].j}')">			  
			  	<input type='image' src='images/del.png'  onclick="del_det({$of.id},'inter','{$of.inter_cat[USE].ii}','{$of.inter_cat[USE].iu}',this)">
			  </td>
		  </tr>
		  {/if}
		  {/section}
		  {section name=USE loop=$of.acc_cat} 
		   {if $of.acc_cat[USE].ap  || $of.acc_cat[USE].aq }
		  <tr>
		  	<td align=left>Trimming</td>
		  	<td align=left><small>{$of.acc_cat[USE].ai}&nbsp;</small></td>
		  	<td align=left><small>{$of.acc_cat[USE].au}&nbsp;</small></td>
		  	<td align=right><input type =text name=PHP_item_price_tr{$of.acc_cat[USE].j} value='{$of.acc_cat[USE].ap}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_yy_tr{$of.acc_cat[USE].j} value='{$of.acc_cat[USE].aq}' size=3 class=select></td>
		  	<td align=center>&nbsp;</td>
		  	<td align=right><input type =text name=PHP_item_tal_tr{$of.acc_cat[USE].j} value='{$of.acc_cat[USE].ac}' size=3 readonly ></td>
			  <td align=left>
 			  	<input type='button' value=update onclick="edit_det({$of.id},'acc','{$of.acc_cat[USE].ai}','{$of.acc_cat[USE].au}','tr{$of.acc_cat[USE].j}')">			  			  
			  	<input type='image' src='images/del.png'  onclick="del_det({$of.id},'acc','{$of.acc_cat[USE].ai}','{$of.acc_cat[USE].au}',this)">
			  </td>
		  </tr>
		  {/if}
		  {/section}
		  {section name=USE loop=$of.oth_cat} 
		   {if $of.oth_cat[USE].op  || $of.oth_cat[USE].oq }
		  <tr>
	  	<td align=left>Other/Treatment</td>
		  <td align=left><small>{$of.oth_cat[USE].oi}&nbsp;</small></td>
		  <td align=left><small>{$of.oth_cat[USE].ou}&nbsp;</small></td>
		  <td align=right><input type =text name=PHP_item_price_ot{$of.oth_cat[USE].j} value='{$of.oth_cat[USE].op}' size=3 class=select></td>
		  <td align=center>&nbsp;</td>
		  <td align=right><input type =text name=PHP_item_yy_ot{$of.oth_cat[USE].j} value='{$of.oth_cat[USE].oq}' size=3 class=select></td>
		  <td align=center>&nbsp;</td>
		  <td align=right><input type =text name=PHP_item_tal_ot{$of.oth_cat[USE].j} value='{$of.oth_cat[USE].oc}' size=3 readonly ></td>
		  <td align=left>
		  	<input type='button' value=update onclick="edit_det({$of.id},'other','{$of.oth_cat[USE].oi}','{$of.oth_cat[USE].ou}','ot{$of.oth_cat[USE].j}')">			  			  
		  	<input type='image' src='images/del.png'  onclick="del_det({$of.id},'other','{$of.oth_cat[USE].oi}','{$of.oth_cat[USE].ou}',this)">
		  </td>
		  </tr>
		  {/if}
		  {/section}	  	
 </table></td></tr>

 <tr>
	<td colspan=10 align=center>
	  <table width=600 border=0 cellspacing=0 cellpadding=1>

		  <tr>
		  <td align=right><b>Mark-Up : </b></td>
		  <td align=center width=400>------------------------------------------------------------------------------------------></td>
		  <td align=right><input name="PHP_gm" type="text" value="{$of.gm_rate}" size=4 class=select onChange="gm('1')" style=text-align:right >%</td>
		  <input name="PHP_old_gm" type="hidden" value={$of.gm_rate}>
		  </tr>

		  <tr>
		  <td align=right><b>Commission : </b></td>
		  <td align=center>------------------------------------------------------------------------------------------></td>
		  <td align=right><input name="PHP_comm" type="text" value="{$of.comm}" size=4 class=select onChange="commission('1')" style=text-align:right >%</td>
		  <input name="PHP_old_comm" type="hidden" value={$of.comm}>
		  </tr>


		  <tr>
		  <td align=right><b>Total Cost : </b></td>
		  <td align=center>------------------------------------------------------------------------------------------></td>
		  <td align=right><input name="PHP_cost" type="label" value="{$of.tt_cost}" size=5 readonly style=text-align:right></td>
		  	<input name="PHP_un_gm_cost" type="hidden" value="{$of.un_gm_cost}">
		  </tr>		

		  <tr>
		  <td align=right><b>Offer Price : </b></td>
		  <td align=center>------------------------------------------------------------------------------------------></td>
		  <td align=right><input name="PHP_deal" type="text" value="{$of.deal}" size=5 class=select_yellow style=text-align:right></td>
		  </tr>
		</table>
	</td>
 </tr>
</table>

<br>
<table border=0 cellspacing=0 cellpadding=2 width=700 bgcolor=#ffffff align=center>
  <tr>
  <td colspan=7>
	<input type="hidden" name="PHP_action" value="do_offer_edit">
		<input type="hidden" name="PHP_back_str" value="{$back_str}">
<!--	<input type="hidden" name="PHP_back_str" value="{$back_str}">  -->
	<input type=submit value="[ CFM to Update above OFFER work-sheet ]" class=select_e style="cursor:pointer; width=100%" onClick=this.width=0;></form>
  </tr>



</table>
{literal}
<!-- In-memory JS array begins-->
<script type="text/javascript">
YAHOO.example.statesArray = [
    "Label",
    "Button",
    "Zipper",
    "Hang-tag",
    "Snap"    
];

YAHOO.example.areacodesArray = [   
    ["embroidery",""],
    ["screen print",""],
    ["garment wash",""],
];
</script>
<!-- In-memory JS array ends-->


<script type="text/javascript">
YAHOO.example.ACJSArray = new function() {
    // Instantiate first JS Array DataSource
    this.oACDS = new YAHOO.widget.DS_JSArray(YAHOO.example.statesArray);

    // Instantiate first AutoComplete
    this.oAutoComp = new YAHOO.widget.AutoComplete('statesinput','statescontainer', this.oACDS);
   

    this.oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
    this.oAutoComp.typeAhead = true;
    this.oAutoComp.useShadow = true;
    this.oAutoComp.minQueryLength = 0;
    this.oAutoComp.textboxFocusEvent.subscribe(function(){
        var sInputValue = YAHOO.util.Dom.get('statesinput').value;
        if(sInputValue.length === 0) {
            var oSelf = this;
            setTimeout(function(){oSelf.sendQuery(sInputValue);},0);
        }
    });

    // Instantiate second JS Array DataSource
    this.oACDS2 = new YAHOO.widget.DS_JSArray(YAHOO.example.areacodesArray);

    // Instantiate second AutoComplete
    this.oAutoComp2 = new YAHOO.widget.AutoComplete('statesinput2','statescontainer2', this.oACDS2);
    this.oAutoComp2.prehighlightClassName = "yui-ac-prehighlight";
    this.oAutoComp2.typeAhead = true;
    this.oAutoComp2.useShadow = true;
    this.oAutoComp2.minQueryLength = 0;
    this.oAutoComp2.textboxFocusEvent.subscribe(function(){
        var sInputValue = YAHOO.util.Dom.get('statesinput2').value;
        if(sInputValue.length === 0) {
            var oSelf = this;        
            setTimeout(function(){oSelf.sendQuery(sInputValue);},0);
        }
    });


};
</script>
{/literal}
<!--END SOURCE CODE FOR EXAMPLE =============================== -->

</body>
</html>
