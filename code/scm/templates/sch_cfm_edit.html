<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM SYSTEM ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<style type="text/css">

<!--
#l1 {
background: #696968;
opacity:0.8;
filter: alpha(opacity=95);
position:absolute;

height:300;
width:500;
z-index: 1000;

}

.l2{ 
    position: relative;
    }

-->

</style>

<script type="text/javascript"
        src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript"
        src="./js/build/connection/connection-min.js"></script>
<script language="javascript" src="./js/col.js"></script>


<Script language="javascript">
function add_check(actions)
{
	window.document.forms['sch_add'].elements['PHP_action'].value = actions;
}

function chg_month(chg)
{
	location.href="schedule.php?PHP_action=chg_month&PHP_chg="+chg+"&PHP_action_to=cfm_sch_edit";
}

function edit_schedule(line_id,id,ord_num,style,qty,des)
{
	//ev =  window.event.clientY;
//	document.getElementById("l1").style.display='block';
	document.getElementById("l1").style.visibility = "visible";
	document.getElementById("l1").style.left = document.body.scrollLeft  + 80 + 'px';
	document.getElementById("l1").style.top =  document.body.scrollTop  + 180 + 'px';
	
	window.document.forms['line_edit'].elements['PHP_ord_num'].value = ord_num;
	window.document.forms['line_edit'].elements['PHP_line_id'].value = line_id;
	window.document.forms['line_edit'].elements['PHP_id'].value = id;
	window.document.forms['line_edit'].elements['ord_style'].value = style;
	window.document.forms['line_edit'].elements['ord_qty'].value = qty;
	window.document.forms['line_edit'].elements['PHP_des'].value = des;
}

function close_frame()
{
	document.getElementById("l1").style.visibility = "hidden";
}

function edit_chg(actions)
{
	window.document.forms['line_edit'].elements['PHP_action'].value = actions;
}

function del_schedule(id,ord_num,line)
{
	if ( confirm("are you sure DELETE [ "+ord_num+" ] schedule on Line [ "+line+" ] ?")) {
		location.href="schedule.php?PHP_action=sch_del&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_line="+line;
	} 
}

function cfm_schedule(line_id,id,ord_num)
{
		location.href="schedule.php?PHP_action=do_cfm_sch&PHP_id="+id+"&PHP_ord_num="+ord_num+"&PHP_line="+line_id;
 
}

function sch_ord_show(num)
{
	 var url ="schedule.php?PHP_action=sch_ord_view&PHP_ord_num="+num;
	 var nm = 'schedule_ord';
 	 window.open(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=700 top=50, left=100');
}

function get_edit_ets(fty,r){
	var line = r.value;
	sUrl="schedule.php?PHP_action=get_ets_ajx&PHP_fty="+fty+"&PHP_line="+line;
	transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, editback, null);	
}
var editback = {
	success: function(o) {
		var response = o.responseText;    	
//		alert(document.getElementById("ets_eidt"));
		document.getElementById("ets_eidt").innerHTML = response; 
	},
	failure: function(o) {
		alert("Error：Can't get data");
	}
};

function small_show(fty,yy,mm)
{
	var url ="schedule.php?PHP_action=schedule_view_small&SCH_fty="+fty+"&SCH_yy="+yy+"&SCH_mm="+mm;
  var nm = 'schedule_small';
	window.open(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=1000,height=700 top=50, left=100');

}

function ord_line(line,date,fty) {
	 var url ="monitor.php?PHP_action=saw_line_pic&PHP_line="+line+"&PHP_date="+date+"&PHP_fty="+fty;
	 var nm = 'line';
	window.open(url,nm,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600 top=50, left=100');
}
</script>
{/literal}
</head>
<body >

<div id=l1 style="position:absolute; z-index:1; visibility:hidden;">
<form method=POST name=line_edit>

	<table width="500" height="100%" bordercolor="#696968" id="l2" >
		<tr>
			<td align=right>
				<a href="javascript:close_frame()" style='cursor:pointer'>
				<img src='./images/del.gif' border=0 ALT="CLOSE"></a>
			</td>
		</tr>
		<tr><td align="center" valign="middle">
	<table border=0 cellspacing=0 cellpadding=2 width=400 align=center valign="middle" bgcolor=#333333>
		<tr>
			<td class=snvy align=left colspan=4>&nbsp;	 </td>
		</tr>	
	  <tr height=28 >
	   <td class=ylw10 align=center colspan=4><b>&nbsp;SCHEDULE EDIT&nbsp;</b></td>
	  </tr>
	  <tr>
	   <td class=gry9 align=left colspan=4>	   	
	    <b> ORDER# : </b> <input type=text name="PHP_ord_num" size=10 value="" readonly >&nbsp;&nbsp;
	    <b> STYLE : </b> <input type=text name="ord_style" size=5 value="" readonly >&nbsp;&nbsp;
	    <b> Q'TY : </b> <input type=text name="ord_qty" size=7 value="" readonly >	&nbsp;&nbsp;
	   </td>	    
	  </tr>
	  <tr>
	   <td class=gry9 align=left colspan=4>	   		   
	  	<div id='ets_eidt'><b> ETS : </b>----</div>
	   </td>	    
	  </tr>	  
	  <tr>
	   <td class=gry9 align=left colspan=4>	   		   
	    <b> DES : </b><input type=text name="PHP_des" size=55 value="" class=select>
	   </td>	    
	  </tr>	 
		<tr>
			<td class=snvy align=left colspan=3><hr SIZE=2 WIDTH=99%>	 </td>
		</tr>	
	  <tr height=28>
	   <td class=gry9 align=right width=100>	   	
	    <b> Change to :  &nbsp;</b>
	   </td>	  	
	   <td class=gry9 align=left colspan=2>	   	
	     {$line_select}	
	   </td>
	   <td class=gry9 align=center>       
	     <input type=submit value="OK" class=select_e style="cursor:pointer; width=90%;" onclick=edit_chg('cfm_sch_line_change') >
	   </td>	    
	  </tr>	 
	  
	  <tr height=28>
	  <td class=gry9 align=right width=100>	   	
	    <b> Share to :  &nbsp;	</b>
	   </td>	
	   <td class=gry9 align=left width=100>	   	
	     {$line_sp}
	   </td>
			<td class=gry9 align=left width=150>
				Q'TY : <input type=text name="PHP_sp_qty" size=5 class=select value=""> 
			</td>	   
	   <td class=gry9 align=center>       
	     <input type=submit value="OK" class=select_e style="cursor:pointer; width=90%;" onclick=edit_chg('cfm_sch_line_spare') >
	   </td>	    
	  </tr>	
	  
	  <tr height=28>
	  <td class=gry9 align=right width=100>	   	
	    <b> DELETE :  &nbsp;	</b>
	   </td>	
			<td class=gry9 align=left colspan=2>
				Q'TY : <input type=text name="PHP_del_qty" size=5 class=select value=""> 
			</td>	   
	   <td class=gry9 align=center>       
	     <input type=submit value="OK" class=select_e style="cursor:pointer; width=90%;" onclick=edit_chg('cfm_sch_del') >
	   </td>	    
	  </tr>	  
	   	 
		<tr>
			<td class=snvy align=left colspan=4>&nbsp;	 </td>
		</tr>		   
	  <input type="hidden" name="PHP_action" value=""> 
	  <input type="hidden" name="PHP_line_id" value="">	
	  <input type="hidden" name="PHP_id" value="">	
	   </form>
	</table>
</td></tr></table>

</div>


<br>


<table cellspacing=1 cellpadding=4 cols=1 width=840 bgcolor=#003300>
	<tr>
		<td class="ylw10" align=left width=120 height=28><b>FTY : {$fty}</b> </td>
		<td class="ylw10" align=center width=600 height=28><b>Schedule APPEND</b> </td>
		<td class="ylw10" align=right width=120 height=28><input type=button value="aerial view" class=select_e style="cursor:pointer; width=70%"  onclick=small_show('{$fty}','{$yy}','{$mm}')></td>		
	</tr>
</table>
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=840 id='tbl_msg' {if $msg_YES} style="display : block" {else}style="display : none"{/if}>
	<tr bgcolor=#ffffff> 
		<td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
		<td class=bgdy><div id='msg1'>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</div></td>
	</tr>
</table>

<hr SIZE=2 WIDTH=820>
<table border="1" cellspacing=0 cellpadding=2 width=830>	
	<tr >
		<td align="center" bgcolor=#FE00B9>&nbsp;</td>		
		<td class=snvy align="left"> : 無樣本,主料,副料</td>
		<td align="center" bgcolor=#FF6F43>&nbsp;</td>		
		<td class=snvy align="left"> : 無樣本,主料(或副料)</td>
		<td align="center" bgcolor=#FF63E0>&nbsp;</td>		
		<td class=snvy align="left"> : 無主料,副料</td>
		<td align="center" bgcolor=#FFC5F3>&nbsp;</td>		
		<td class=snvy align="left"> : 無主料或副料</td>
	</tr>		
  <tr>
		<td align="center" bgcolor=#D7D7FF>&nbsp;</td>		
		<td class=snvy align="left"> : ORDER FINISHED</td>
		<td align="center" bgcolor=#FD1838>&nbsp;</td>		
		<td class=snvy align="left"> : 排產ETF超過出口日</td>
		<td align="center" bgcolor=#D0FDCD>&nbsp;</td>		
		<td class=snvy align="left"> : 生產中</td>
		<td align="center" bgcolor=#F8FF84>&nbsp;</td>		
		<td class=snvy align="left"> : 訂單與生產線不同style</td>		
	</tr>	
</table>
<hr SIZE=2 WIDTH=820>

<table border="1" cellspacing=0 cellpadding=2 width=840 id="mat_table">	
	<tr bgcolor="#003333" height=28>
		<td class=back align="center" colspan=5><input type=button value="<< Pre. Month" class=select_e style="cursor:pointer; width=95%"  onclick=chg_month('-1')></td>
		<td class=back align="center" colspan={$span}><b>{$yy}-{$mm}</b></td>
		<td class=back align="center" colspan=6><input type=button value="Next Month >>" class=select_e style="cursor:pointer; width=95%"  onclick=chg_month(1)></td>	
	</tr>
	<tr bgcolor="#003333" height=28>
		<td width="28" class=back align="center"><b>LN.</b></td>
		{section name=SEC loop=$days} 
		<td width="28" class=back align="center"><b>{$days[SEC]}</b></td>
		{/section}
	</tr>
	{section name=SEC loop=$ln_rec} 
	<tr height=30>
		<td width="28" class=snvy align="center">
			<a href="javascript:ord_line('{$ln_rec[SEC].line}','{$today}','{$fty}')" value='order' style='cursor:pointer'>
				<b>{$ln_rec[SEC].line}</b><BR>{if $ln_rec[SEC].style == 'top'}(T){/if}{if $ln_rec[SEC].style == 'btm.'}(B){/if}
			</a>		
		</td>
		{section name=DET loop=$ln_rec[SEC].sch_rec} 
		<td class=snvy align="center" colspan={$ln_rec[SEC].sch_rec[DET].day_range} bgcolor="{$ln_rec[SEC].sch_rec[DET].flag_color}"}>
			
			{if $ln_rec[SEC].sch_rec[DET].flag > 0 && $ln_rec[SEC].sch_rec[DET].flag <> 4}
				<a href="javascript:edit_schedule({$ln_rec[SEC].sch_rec[DET].line_id},{$ln_rec[SEC].sch_rec[DET].id},'{$ln_rec[SEC].sch_rec[DET].ord_num}','{$ln_rec[SEC].sch_rec[DET].style}','{$ln_rec[SEC].sch_rec[DET].qty}','{$ln_rec[SEC].sch_rec[DET].des}')" style='cursor:pointer'>
	  		<img src='./images/Add.gif' align=right border=0 ALT="EDIT"></a>
				<!--
				<a href="javascript:del_schedule({$ln_rec[SEC].sch_rec[DET].id},'{$ln_rec[SEC].sch_rec[DET].ord_num}','{$ln_rec[SEC].line}')" style='cursor:pointer'>
				<img src='./images/del.gif' align=right border=0 ALT="DEL"></a>				
				-->
			{/if}
			<BR><BR>
			{if $ln_rec[SEC].sch_rec[DET].ord_num}
				<a href="javascript:sch_ord_show('{$ln_rec[SEC].sch_rec[DET].ord_num}')" style='cursor:pointer'>
	  		{$ln_rec[SEC].sch_rec[DET].ord_num}</a>({$ln_rec[SEC].sch_rec[DET].style})&nbsp;
				<BR><small>({$ln_rec[SEC].sch_rec[DET].etd})</small>
			{/if}

		</td>
		{/section}
	</tr>	

	{/section}

	{section name=SEC loop=$con_rec} 
	<tr height=30>
		<td width="28" class=snvy align="center"><b>{$con_rec[SEC].line}</b></td>
		{section name=DET loop=$con_rec[SEC].sch_rec} 
		<td class=snvy align="center" colspan={$con_rec[SEC].sch_rec[DET].day_range} bgcolor="{$con_rec[SEC].sch_rec[DET].flag_color}"}>
		
			{if $con_rec[SEC].sch_rec[DET].flag > 0 && $con_rec[SEC].sch_rec[DET].flag <> 4}
				<!--
				<a href="javascript:edit_schedule({$ln_rec[SEC].sch_rec[DET].line_id},{$ln_rec[SEC].sch_rec[DET].id},'{$ln_rec[SEC].sch_rec[DET].ord_num}')" style='cursor:pointer'>
	  		<img src='./images/Add.gif' align=right border=0 ALT="EDIT"></a>
				-->
				<a href="javascript:del_schedule({$con_rec[SEC].sch_rec[DET].id},'{$con_rec[SEC].sch_rec[DET].ord_num}','{$con_rec[SEC].line}')" style='cursor:pointer'>
				<img src='./images/del.gif' align=right border=0 ALT="DEL"></a>				
				
			{/if}
			<BR><BR>
			{if $con_rec[SEC].sch_rec[DET].ord_num}
			<a href="javascript:sch_ord_show('{$con_rec[SEC].sch_rec[DET].ord_num}')" style='cursor:pointer'>
			{$con_rec[SEC].sch_rec[DET].ord_num}</a>
			({$con_rec[SEC].sch_rec[DET].style})&nbsp;&nbsp;
			<BR><small>({$con_rec[SEC].sch_rec[DET].etd})</small>
			{/if}

		</td>
		{/section}
	</tr>	

	{/section}	
</table>
<!--
<hr SIZE=2 WIDTH=690>
<form METHOD="POST" name="sch_view" action="{$PHP_SELF}">	
<table border=0 cellspacing=0 cellpadding=0 cols=2 width=840>
	<tr>
		<td width=450>
			<input type=submit value="[ Submit above records ]" class=select_e style="cursor:pointer; width=99%"  >
		</td>
	</tr>
</table>
<input type=hidden name="PHP_action" value="schedule_view">
</form>

-->
<!--------- footer ---------->
{include file="footer.html"}