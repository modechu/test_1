<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=big5">
   <title>===:::::::::: SCM 樣本輔助系統 [ 製造令 資料 ] ::::::::::===</title>
   <link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script type="text/javascript" src="js/open_detial.js"></script>
<script language="JavaScript"><!--
function cfm_add(wi_id,mat_id,num_colors,mat) {
	var qty = new Array();
	var ck = '';
	var color = '';
	var T1 = '';
	var T2 = '';

	for (i=0; i<num_colors; i++){
	 if (mat == "lots"){
		T1 = "window.document.forms.edit.PHP_bom_qty"+mat_id+"_"+i+".checked";
		T2 = "window.document.forms.edit.PHP_bom_qty"+mat_id+"_"+i+".value";
	  }else{
	  	T1 = "window.document.forms.acc_edit.PHP_bom_qty"+mat_id+"_"+i+".checked";
		T2 = "window.document.forms.acc_edit.PHP_bom_qty"+mat_id+"_"+i+".value";	  
	  }

			  if (eval(T1)){
					ck = '1';
					qty[i] = eval(T2);
			  } else {
					qty[i]='';
			  }
	}
	if (ck == ''){
			alert("Please choice allocation of this materiel [colorway]!\r\rIf there is no colorway or q'ty data，\rPlease update this data on [W I] first !");
			return;
	}
	if (mat == "lots"){
		color = eval("window.document.forms.edit.PHP_lots_color_"+mat_id+".value");
	} else {
		color = eval("window.document.forms.acc_edit.PHP_acc_color_"+mat_id+".value");
	}
	location.href="index2.php?PHP_action=do_bom_add&PHP_mat="+mat+"&PHP_mat_use_id="+mat_id+"&PHP_color="+color+"&PHP_qty="+qty+"&PHP_wi_id="+{/literal}{$wi.id}+"{$back_str2}"{literal};

 
 }

function cfm_del(bom_id,wi_id,mat_code,mat) {
	if ( confirm("Deleting record will permanent deteleted；Can't reversion anymore !\r\rPlease check again \r\rAre you sure delete this record :["+mat_code+"]??")) {
	location.href="index2.php?PHP_action=do_bom_del&PHP_bom_id="+bom_id+"&PHP_id="+wi_id+"&mat_code="+mat_code+"&PHP_mat="+mat+"{/literal}{$back_str2}"{literal};
	} 
 }
function check_con(est,r)
{
	if(r.value == 0)
	{
		alert("Can not inupt 0");
		r.value = est;
	}
}
-->
</script>
{/literal}

</head>

<body>

<br><form method=POST name=bom_com_add>
<table cellspacing=1 cellpadding=4 cols=2 width=700 bgcolor=#2E5E73>
	<tr><td class="des" align=center height=28 width=340>[ <b><span class=ylw10> EDIT </span>BOM for Order</b> - <b>{$wi.wi_num}</b> ]</td>
	<td class="ylw10" align=center height=28 width=140>{if $wi.status == 2}<b>[ {literal}SUBMIT{/literal} ]{elseif $wi.status == 1}[{literal}UN SUBMIT{/literal} ]{/if}</span></b></td>
	<td class="des" align=center height=28 width=140>Version :<span class=ylw10><b>{$wi.bom_rev}</span></b></td>
	</tr>
</table>
{if $msg_YES}
     <table border=1 cellpadding=4 cellspacing=0 cols=1 width=700>
      <tr bgcolor=#ffffff> 
        <td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
        <td class=bgdy>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</td>
      </tr>
     </table>
{/if}
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
    <td class=snvy align=right nowrap>Customer :</td>
    <td class=bgdy align=left><b>&nbsp;{$smpl.cust_iname}</b></td>
    <td class=snvy align=right nowrap>Department :</td>
    <td class=bgdy align=left><b>&nbsp;{$wi.dept}</b></td>
    <td class=snvy align=right nowrap><b>ETD :</b></td>
    <td class=bgdy align=left><b>&nbsp;{$wi.etd}</b></td>
  </tr>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
</table>
<table border cellspacing=0 cellpadding=3 width=700 bgcolor=#ffffff align=center>
  <tr bgcolor="#003333" height=24> 
	<td nowrap width=100 align=center class=back><b>Picture</b></td>
	<td nowrap width=100 align=center class=back><b>Order #</b></td>
	<td nowrap width=100 align=center class=back><b>style</b></td>
	<td nowrap width=150 align=center class=back><b>SIZE RANGE</b></td>
	<td nowrap width=200 align=center class=back><b>Q'ty / Unit</b></td>
  </tr>
  <tr bgcolor=#DDDDDD height=24>
	<td class=g10 align=center rowspan=2>&nbsp;
		<a href="{$wi.pic_url}" target=_black><img src="{$wi.pic_url}" name="pic" border=0 width=90></a></td>
	<td class=grn9 align=center><b>&nbsp;{$smpl.order_num}</b></td>
    <td class=grn9 align=center><b>&nbsp;{$smpl.style}</b></td>
    <td class=grn9 align=center><b>&nbsp;{$smpl.size_scale}</b></td>
    <td class=grn9 align=center><b><span class=bgdy9><b>{$total}</b></span>&nbsp;pc</b></td>
  </tr>
  <tr>
	<td colspan=5 >
		<table border cellspacing=0 cellpadding=2 width=470 bgcolor=#ffffff align=center>
			{section name=USE loop=$show_breakdown}
				{$show_breakdown[USE]}
			{/section}
			{if $size_ttl}
			<TR>
				<td class=grn9 align=center bgcolor=#DDDDDD colspan=2><b>&nbsp;G-TTL</b></td>
			{section name=USE loop=$size_ttl}
				<td class=b9 align=center bgcolor=#DDDDDD>&nbsp;<b><i>{$size_ttl[USE]|NUMBER_FORMAT}</b></td>
			{/section}
			  <td class=b9 align=right bgcolor=#DDDDDD>&nbsp;<b><i>{$g_ttl|NUMBER_FORMAT}</b></td>
			<TR>
			{/if}
		</table>
	</td>
  </tr>
</table>
<!-------------  BOM table ------------->
<!-------------  主料 ------------->
<hr size=2 width=700 align=center>
<!-------------  material range ------------->
    <table width=700 border=0 cellspacing=1 cellpadding=2>
     <tr bgcolor=#333333 height=28>
	  <td width=90 class=ylw9 align=center><b>Fabirc #</b></td>
	  <td width=150 class=ylw9 align=center><b>Fabric Name</b></td>
	  <td width=170 class=ylw9 align=center><b>Placement</b></td>
	  <td width=70 class=ylw9 align=center><b>consump.</b></td>
	  <td width=50 class=ylw9 align=center><b>Unit</b></td>
	  <td width=70 class=ylw9 align=center><b>Remark</b></td>
	  <td width=70 class=ylw9 align=center><b>Purchase</b></td>
     </tr>

	{if $lots_NONE}  
	  <tr>
		<td colspan=6 align=center class=bgdy9><br>No Fabric data!<br><br>
		<input type="hidden" name="PHP_lots_est" value="">
	  </tr>
	{/if}

	{section name=USE loop=$lots_use} 
     <tr bgcolor=#eeeeee height=28>
	  <td class=snvy align=center nowrap>{$lots_use[USE].lots_code}&nbsp;</td>
	  <td class=snvy >{$lots_use[USE].lots_name}&nbsp;</td>
	  <td class=snvy >{$lots_use[USE].use_for}&nbsp;</td>
	  <td class=snvy align=center>{$lots_use[USE].est_1}</td>
	  <td class=snvy align=center>{$lots_use[USE].unit}&nbsp;</td>
	  <td class=snvy align=center>{$lots_use[USE].use_method}&nbsp;</td>
	  <td class=snvy align=center>&nbsp;</td>
	 </tr>
	{/section} 
	 
<!------------------------------------------------>
<!-------------  accessories range ------------->
  <tr bgcolor=#333333 height=28>
	  <td width=90 class=ylw9 align=center><b>Accessory #</b></td>
	  <td width=150 class=ylw9 align=center><b>ACC. Name</b></td>
	  <td width=170 class=ylw9 align=center><b>Placement</b></td>
	  <td width=70 class=ylw9 align=center><b>consump.</b></td>
	  <td width=50 class=ylw9 align=center><b>Unit</b></td>
	  <td width=70 class=ylw9 align=center><b>Remark</b></td>
	  <td width=70 class=ylw9 align=center><b>Purchase</b></td>
   </tr>

	{if $acc_NONE}  
	  <tr>
		<td colspan=6 align=center class=bgdy9><br>No Accessory data!<br><br>
		<input type="hidden" name="PHP_acc_est" value="">
	  </tr>
	{/if}

	{section name=USE loop=$acc_use} 
  <tr {if $acc_use[USE].i is odd}bgcolor=#E7E7E7{else}bgcolor='#D2F3D4'{/if} height=28>
	  <td class=snvy align=center nowrap><a href="javascript:Show_acc('{$acc_use[USE].acc_code}')" value='ord_out' style='cursor:pointer'>{$acc_use[USE].acc_code}&nbsp;</a></td>
	  <td class=snvy >{$acc_use[USE].acc_name}&nbsp;</td>
	  <td class=snvy >{$acc_use[USE].use_for}&nbsp;</td>
	  <td class=snvy align=center><input type='text' name="PHP_acc_est[{$acc_use[USE].id}]" size=3 class=select value="{$acc_use[USE].est_1}" onchange="check_con('{$acc_use[USE].est_1}',this);" {if $acc_use[USE].ap_mark} readonly {/if}></td>
	  <td class=snvy align=center>{$acc_use[USE].unit}&nbsp;</td>
	  <td class=snvy align=center>{$acc_use[USE].use_method}&nbsp;</td>
	  <td class=snvy align=center>{$acc_use[USE].ap_mark}&nbsp;</td>
	 </tr>
	<tr {if $acc_use[USE].i is odd}bgcolor=#E7E7E7{else}bgcolor='#D2F3D4'{/if} height=28>
	 <td colspan="7" nowrap bgcolor="{php}echo $bg;{/php}" class=snvy>
	 {if $acc_use[USE].specify}Construction : {$acc_use[USE].specify}&nbsp;{/if}</td>
	</tr>	 
	{/section} 
    </table>

<table border=0 cellspacing=0 cellpadding=2 width=690 bgcolor=#ffffff align=center>
  <tr>
    <td colspan=8 class=frnt align=center><hr size=2 width=98%></td>
  </tr>
  <tr>
	<td>
{if $back_str}
		<input type=button onClick="window.location.href='{$PHP_SELF}?PHP_action=bom_search_wi{$back_str}'" value=" << go back " class=select_e style="cursor:pointer; width=99%">
{else}&nbsp;
{/if}
	</td>
	
<td>
	<input type="hidden" name="PHP_action" value="do_bom_con_edit">
	<input type="hidden" name="PHP_back_str" value="{$back_str}">
	<input type="hidden" name="PHP_back_str2" value="{$back_str2}">
	<input type="hidden" name="PHP_wi_id" value="{$wi.id}">
	<input type="hidden" name="PHP_revise" value="{$wi.revise}">
	<input type=submit value="[ Update above data ]" class=select_e style="cursor:pointer; width=90%">
</td>


<td>
{if $back_str}
	<input type=button onClick="window.location.href='{$PHP_SELF}?PHP_action=bom_view&PHP_id={$wi.id}{$back_str2}'" value=" BOM VIEW" class=select_e style="cursor:pointer; width=99%">
{else}&nbsp;
{/if}
	</td>
  </tr>

</table>
</form>

<!--------- footer ---------->
{include file="footer.html"}
