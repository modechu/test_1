<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>===:::::::::: SCM -B [ ORDER RECORD ] ::::::::::===</title>
<link rel=stylesheet type="text/css" href="./bom.css">
{literal}
<script language="javascript" src="./js/col.js"></script>
<script type="text/javascript" src="./js/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript" src="./js/build/connection/connection-min.js"></script>
<Script language="javascript">
var $old ="";
var transaction;
var sUrl;

function cfm_img() {

    var $old ="";
    $old = document.pic.src;
    document.pic.src = document.adding.PHP_pic.value;

	if ( !confirm ("confirm if the picture is correct?")){
		document.pic.src = $old;
	} else {
		document.adding.PHP_pic_upload.value ="1";
	}

}

function wait(){
    alert ("如果您有傳圖上主機時時，將會花上一段時間!!\r\r請在等待[視窗自動更新]前,不要再按任何按扭。 \r最佳的方法，請將您的圖檔盡可能設定與系統要求相同大小    \r\r因為系統接受圖檔後，會自動將圖再format成固定大小 !  ");
}

function search_ord(cust,dept){
	var gofile ='exception.php?PHP_action=order_search&PHP_cust='+cust+'&PHP_dept='+dept;
	style=window.open(gofile,'styleord','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=650, top=100, left=150');
}

function writeToOrdList(order,style,ie,qty,saw_qty) {
	var ord_rec = window.document.forms['adding'].elements['PHP_order'].value;
	ord_rec = ord_rec+order+",";
	window.document.forms['adding'].elements['PHP_order'].value = ord_rec;
    // sUrl="exception.php?PHP_action=ord_chk_ajax&PHP_order="+order;
    // transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, callback, null);	
}

var callback = {
	success: function(o) {
		var response = o.responseText;    	
		if(response == 0)
		{
			alert("This Order# is exist. Please Check again!!");
			window.document.forms['adding'].elements['PHP_order'].value ='';
		}
	},
	failure: function(o) {
		alert("Error：Can't get data");
	}
};

function search_po(cust,dept){
	var gofile ='exception.php?PHP_action=po_search&PHP_cust='+cust+'&PHP_dept='+dept;
	style=window.open(gofile,'styleord','toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=700,height=650, top=100, left=150');
}

function writeToPOList(po_num, ap_num) {
	window.document.forms['adding'].elements['PHP_po'].value = po_num;	
}

function del_ord(){
    window.document.forms['adding'].elements['PHP_order'].value = '';
}

</script>
{/literal}
</head>
<body>
<form method=POST name=adding enctype="multipart/form-data" action=exception.php>
<br>
<table cellspacing=1 cellpadding=4 cols=1 width=700 bgcolor=#333333>
	<tr><td class="des" align=center height=28> [ <span class=ylw10><b>APPEND</b></span> Exceptional ] </td></tr>
</table>
{if $msg_YES}
<table border=1 cellpadding=4 cellspacing=0 cols=1 width=700>
    <tr bgcolor=#ffffff> 
        <td width=90 class=gry10 align=center><img src="images/alert.gif" border=0></td>
        <td class=b9>{section name=SEC_MSG loop=$msg} {$msg[SEC_MSG]}<br>{/section}</td>
    </tr>
</table>
{/if}
<br>
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
    <tr>	    
        <td class=frnt align=right><b>客戶 :</b></td>
        <td class=b9 align=left><b>{$cust_id}</b></td> 

        <td class=snvy align=right nowrap><b>部門 :</b></td>			
        <td class=b9 align=left><b>{$dept_id}</b></td>
 	  
        <td class=frnt align=right><b>報告日期 : {$date}</b></td>
    
        <input type="hidden" name="PHP_cust" value="{$cust_id}">
		<input type="hidden" name="PHP_dept" value="{$dept_id}">
    </tr>

    <tr>	
        <td class=snvy align=right nowrap><b>訂單編號 :</b></td>
        <td class=b9 align=left  colspan=4>
    	<input type='text' name="PHP_order" size=50 class=select value="{$exc.ord_num}" readonly >
	  	<img src="./images/icoSearch.gif" alt="Order" onClick="search_ord('{$cust_id}','{$dept_id}');" style="cursor:pointer" width=15  >        
	  	<img src="./images/del.gif" alt="Order" onClick="del_ord();" style="cursor:pointer" width=15  >	       
        </td>
    </tr>	
    <tr>	
        <td class=snvy align=right nowrap><b>採購單編號:</b></td>
        <td class=b9 align=left  colspan=4>
    	<input type='text' name="PHP_po" size=20 class=select value="{$exc.po_num}" readonly >
	  	<img src="./images/icoSearch.gif" alt="Order" onClick="search_po('{$cust_id}','{$dept_id}');" style="cursor:pointer" width=15  >        
        </td>
 	</tr>	 	
<!-- 	
    <tr>	
        <td class=snvy align=right nowrap><b>異常來源:</b></td>
        <td class=b9 align=left  colspan=4>
        <b>&nbsp;<input type=radio name="PHP_exc_from" value="1">組織內需求所造成&nbsp;
        &nbsp;<input type=radio name="PHP_exc_from" value="2">組織外要求所造成</b></td>
        </td>
    </tr>	      
-->
</table>
<table border=0 cellspacing=0 cellpadding=1 width=700 bgcolor=#FFFFFF>
    <tr bgcolor=#eeeeee height=28>
        <td class=bgdy align=center nowrap colspan=5><b>異常狀態</b></td>
    </tr>
	<tr>
        <td class=snvy align=left nowrap><b>1.</b><input type='checkbox' name="PHP_state[0]" value="1">&nbsp;&nbsp;己上SCM系統取消/刪減訂單</td>
        <td class=b9 align=left><b>原訂單數量:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[0]" size=8 value="" class=select> </td>
        <td class=b9 align=left><b>取消/刪減數量:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[0]" size=8 value="" class=select> </td>
    </tr>
    <tr>
        <td class=snvy align=left nowrap><b>2.</b><input type='checkbox' name="PHP_state[1]" value="2">&nbsp;&nbsp;訂單幣別更新</td>
        <td class=b9 align=left><b>原幣別:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[1]" size=8 value="" class=select> </td>
        <td class=b9 align=left><b>修改後幣別:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[1]" size=8 value="" class=select> </td>
    </tr>
    <tr>
        <td class=snvy align=left nowrap><b>3.</b><input type='checkbox' name="PHP_state[2]" value="3">&nbsp;&nbsp;訂單單價變更</td>
        <td class=b9 align=left><b>原單價:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[2]" size=8 value="" class=select> </td>
        <td class=b9 align=left><b>修改後單價:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[2]" size=8 value="" class=select> </td>
    </tr>
    <tr>
        <td class=snvy align=left nowrap><b>4.</b><input type='checkbox' name="PHP_state[3]" value="4">&nbsp;&nbsp;海運改空運</td>
        <td class=b9 align=left><b>海運費:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[3]" size=8 value="" class=select> </td>
        <td class=b9 align=left><b>空運費:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[3]" size=8 value="" class=select> </td>
    </tr>
    <tr>
        <td class=snvy align=left nowrap><b>5.</b><input type='checkbox' name="PHP_state[4]" value="5">&nbsp;&nbsp;逾期貨款或短付貨款</td>
        <td class=b9 align=left><b>原訂單貨款:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[4]" size=8 value="" class=select> </td>
        <td class=b9 align=left><b>逾期/短付貨款:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[4]" size=8 value="" class=select> </td>
    </tr>  
    <tr>
        <td class=snvy align=left nowrap><b>6.</b><input type='checkbox' name="PHP_state[5]" value="6" {if $rec.bom_qty > 0} checked{/if}>&nbsp;&nbsp;物料超量採購</td>
        <td class=b9 align=left><b>原物料預估需求金額:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[5]" size=8 value="{$rec.bom_amount}" class=select> </td>
        <td class=b9 align=left><b>採購金額:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_new[5]" size=8 value="{$rec.po_amount}" class=select> </td>
    </tr> 
    {if $rec.dear}
    <tr>
        <td class=snvy align=left nowrap><b>7.</b><input type='checkbox' name="PHP_state[6]" value="7" {if $rec.dear} checked{/if}>&nbsp;&nbsp;採購單刪除</td>
        <td class=b9 align=left><b>採購金額:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[6]" size=8 value="{$rec.dear}" class=select> </td>
        <td class=b9 align=left><b>&nbsp;</b></td>
        <td class=b9 align=left><b>&nbsp;</b><input type='hidden' name="PHP_new[6]"  value="" > </td>
    </tr> 
    {/if}
    <tr>
        <td class=snvy align=left nowrap><b>8.</b><input type='checkbox' name="PHP_state[8]" value="9" {if $ord_shift} checked{/if}>&nbsp;&nbsp;訂單移轉</td>
        <td class=b9 align=left><b>物料轉出成本:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[8]" size=8 value="{$rec.shift}" class=select> </td>
        <td class=b9 align=left><b>&nbsp;</b></td>
        <td class=b9 align=left><b>&nbsp;</b><input type='hidden' name="PHP_new[8]"  value="" > </td>
    </tr>
    {if $ord_del}		
    <tr>
        <td class=snvy align=left nowrap><b>9.</b><input type='checkbox' name="PHP_state[9]" value="10" {if $ord_del} checked{/if}>&nbsp;&nbsp;訂單刪除</td>
        <td class=b9 align=left><b>訂單數量:</b></td>
        <td class=b9 align=left><b><input type='text' name="PHP_org[9]" size=8 value="{$rec.qty}" class=select> </td>
        <td class=b9 align=left><b>&nbsp;</b></td>
        <td class=b9 align=left><b>&nbsp;</b><input type='hidden' name="PHP_new[9]"  value="" > </td>
    </tr>
    {/if}
    <tr>
        <td class=snvy align=left nowrap colspan=5>
        <b>99.</b><input type='checkbox' name="PHP_state[99]" value="99">
        &nbsp;&nbsp;其他:<input type='text' name="PHP_state_name" size=30 value="" class=select>
        <input type='hidden' name="PHP_new[99]" value="" >
        <input type='hidden' name="PHP_org[99]" value="" >
        </td>
    </tr>
    <tr>
        <td colspan=5 class=frnt align=center><hr size=2 width=98%></td>
    </tr>
</table>  

<table border=0 cellspacing=2 cellpadding=2 width=700 bgcolor=#FFFFFF>
    <tr height=28>
        <td bgcolor=#eeeeee class=bgdy align=center nowrap><b>發生原因及預估損失</b></td>
        <td bgcolor=#eeeeee class=bgdy align=center nowrap><b>會辦單位</b></td>
    </tr>
    <tr>
        <td class=frnt align=center rowspan=7> 
        {if $rec.sys_reason}
   		<textarea rows=7 cols=120 name="PHP_sys_des" readonly >{$rec.sys_reason}</textarea><BR>
        {else}
   		<input type="hidden" name="PHP_sys_des" value="">
        {/if}
        <textarea rows=7 cols=120 name="PHP_exc_des">{$rec.reason}</textarea>
    </td>
    </tr>   
    <tr>
        <td>&nbsp;&nbsp;<input type="checkbox" name="PHP_team[0]" value="1"> 立元廠</td>
    </tr>
    <tr>
        <td>&nbsp;&nbsp;<input type="checkbox" name="PHP_team[1]" value="2"> 湖嘉廠</td>
    </tr>
    <tr>
        <td>&nbsp;&nbsp;<input type="checkbox" name="PHP_team[2]" value="4"> 嘉菲廠</td>
    </tr>
    <tr>	
        <td>&nbsp;&nbsp;<input type="checkbox" name="PHP_team[3]" value="8" disabled><!-- {if $no_pm == 1} checked onclick="return false;" {/if} --> 生產企劃室</td>
    </tr>
    <tr>
        <td>&nbsp;&nbsp;<input type="checkbox" name="PHP_team[4]" value="16"> 採購</td>
    </tr>
    <tr>
        <td  colspan=2 class=frnt align=center><hr size=2 width=98%></td>
    </tr> 
</table>
<table border=0 cellspacing=0 cellpadding=2 width=690 bgcolor=#ffffff align=center>
    <tr>
        <td colspan=7>
        <input type="hidden" name="PHP_action" value="do_exc_add">
        <input type="hidden" name="PHP_back_str" value="{$back_str}">
        <input type="hidden" name="PHP_ap_num" value="{$ap_num}">
        <input type="hidden" name="PHP_ord_shift" value="{$ord_shift}">
        <input type="hidden" name="PHP_exc_action" value="{$exc.action}">
        <input type=submit value="[ 新增異常狀態報告 ]" class=select_e style="cursor:pointer; width=100%" onClick=this.width=0;></form>
    </tr>
</table>
<!--------- footer ---------->
{include file="footer.html"}